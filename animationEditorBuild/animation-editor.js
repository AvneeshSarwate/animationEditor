var AnimationEditorComponent=(function(vr){"use strict";function yr(n){const e=Object.create(null);for(const t of n.split(","))e[t]=1;return t=>t in e}const Ee={},es=[],wt=()=>{},to=()=>!1,di=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),br=n=>n.startsWith("onUpdate:"),Ge=Object.assign,wr=(n,e)=>{const t=n.indexOf(e);t>-1&&n.splice(t,1)},Vd=Object.prototype.hasOwnProperty,ke=(n,e)=>Vd.call(n,e),de=Array.isArray,ts=n=>hi(n)==="[object Map]",no=n=>hi(n)==="[object Set]",pe=n=>typeof n=="function",Fe=n=>typeof n=="string",on=n=>typeof n=="symbol",Le=n=>n!==null&&typeof n=="object",so=n=>(Le(n)||pe(n))&&pe(n.then)&&pe(n.catch),io=Object.prototype.toString,hi=n=>io.call(n),jd=n=>hi(n).slice(8,-1),ui=n=>hi(n)==="[object Object]",xr=n=>Fe(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,bs=yr(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),fi=n=>{const e=Object.create(null);return(t=>e[t]||(e[t]=n(t)))},zd=/-\w/g,xt=fi(n=>n.replace(zd,e=>e.slice(1).toUpperCase())),Yd=/\B([A-Z])/g,pt=fi(n=>n.replace(Yd,"-$1").toLowerCase()),ro=fi(n=>n.charAt(0).toUpperCase()+n.slice(1)),Sr=fi(n=>n?`on${ro(n)}`:""),ln=(n,e)=>!Object.is(n,e),pi=(n,...e)=>{for(let t=0;t<n.length;t++)n[t](...e)},ao=(n,e,t,s=!1)=>{Object.defineProperty(n,e,{configurable:!0,enumerable:!1,writable:s,value:t})},kr=n=>{const e=parseFloat(n);return isNaN(e)?n:e},Cr=n=>{const e=Fe(n)?Number(n):NaN;return isNaN(e)?n:e};let oo;const gi=()=>oo||(oo=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Pn(n){if(de(n)){const e={};for(let t=0;t<n.length;t++){const s=n[t],i=Fe(s)?qd(s):Pn(s);if(i)for(const r in i)e[r]=i[r]}return e}else if(Fe(n)||Le(n))return n}const Xd=/;(?![^(]*\))/g,Kd=/:([^]+)/,Zd=/\/\*[^]*?\*\//g;function qd(n){const e={};return n.replace(Zd,"").split(Xd).forEach(t=>{if(t){const s=t.split(Kd);s.length>1&&(e[s[0].trim()]=s[1].trim())}}),e}function Mn(n){let e="";if(Fe(n))e=n;else if(de(n))for(let t=0;t<n.length;t++){const s=Mn(n[t]);s&&(e+=s+" ")}else if(Le(n))for(const t in n)n[t]&&(e+=t+" ");return e.trim()}const Jd=yr("itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly");function lo(n){return!!n||n===""}const co=n=>!!(n&&n.__v_isRef===!0),St=n=>Fe(n)?n:n==null?"":de(n)||Le(n)&&(n.toString===io||!pe(n.toString))?co(n)?St(n.value):JSON.stringify(n,ho,2):String(n),ho=(n,e)=>co(e)?ho(n,e.value):ts(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[s,i],r)=>(t[Tr(s,r)+" =>"]=i,t),{})}:no(e)?{[`Set(${e.size})`]:[...e.values()].map(t=>Tr(t))}:on(e)?Tr(e):Le(e)&&!de(e)&&!ui(e)?String(e):e,Tr=(n,e="")=>{var t;return on(n)?`Symbol(${(t=n.description)!=null?t:e})`:n};function Qd(n){return n==null?"initial":typeof n=="string"?n===""?" ":n:String(n)}let nt;class eh{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=nt,!e&&nt&&(this.index=(nt.scopes||(nt.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){const t=nt;try{return nt=this,e()}finally{nt=t}}}on(){++this._on===1&&(this.prevScope=nt,nt=this)}off(){this._on>0&&--this._on===0&&(nt=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let t,s;for(t=0,s=this.effects.length;t<s;t++)this.effects[t].stop();for(this.effects.length=0,t=0,s=this.cleanups.length;t<s;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,s=this.scopes.length;t<s;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0}}}function th(){return nt}let Ie;const Er=new WeakSet;class uo{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,nt&&nt.active&&nt.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Er.has(this)&&(Er.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||po(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,yo(this),go(this);const e=Ie,t=kt;Ie=this,kt=!0;try{return this.fn()}finally{mo(this),Ie=e,kt=t,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)Pr(e);this.deps=this.depsTail=void 0,yo(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Er.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Ir(this)&&this.run()}get dirty(){return Ir(this)}}let fo=0,ws,xs;function po(n,e=!1){if(n.flags|=8,e){n.next=xs,xs=n;return}n.next=ws,ws=n}function Ar(){fo++}function Rr(){if(--fo>0)return;if(xs){let e=xs;for(xs=void 0;e;){const t=e.next;e.next=void 0,e.flags&=-9,e=t}}let n;for(;ws;){let e=ws;for(ws=void 0;e;){const t=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(s){n||(n=s)}e=t}}if(n)throw n}function go(n){for(let e=n.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function mo(n){let e,t=n.depsTail,s=t;for(;s;){const i=s.prevDep;s.version===-1?(s===t&&(t=i),Pr(s),nh(s)):e=s,s.dep.activeLink=s.prevActiveLink,s.prevActiveLink=void 0,s=i}n.deps=e,n.depsTail=t}function Ir(n){for(let e=n.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(_o(e.dep.computed)||e.dep.version!==e.version))return!0;return!!n._dirty}function _o(n){if(n.flags&4&&!(n.flags&16)||(n.flags&=-17,n.globalVersion===Ss)||(n.globalVersion=Ss,!n.isSSR&&n.flags&128&&(!n.deps&&!n._dirty||!Ir(n))))return;n.flags|=2;const e=n.dep,t=Ie,s=kt;Ie=n,kt=!0;try{go(n);const i=n.fn(n._value);(e.version===0||ln(i,n._value))&&(n.flags|=128,n._value=i,e.version++)}catch(i){throw e.version++,i}finally{Ie=t,kt=s,mo(n),n.flags&=-3}}function Pr(n,e=!1){const{dep:t,prevSub:s,nextSub:i}=n;if(s&&(s.nextSub=i,n.prevSub=void 0),i&&(i.prevSub=s,n.nextSub=void 0),t.subs===n&&(t.subs=s,!s&&t.computed)){t.computed.flags&=-5;for(let r=t.computed.deps;r;r=r.nextDep)Pr(r,!0)}!e&&!--t.sc&&t.map&&t.map.delete(t.key)}function nh(n){const{prevDep:e,nextDep:t}=n;e&&(e.nextDep=t,n.prevDep=void 0),t&&(t.prevDep=e,n.nextDep=void 0)}let kt=!0;const vo=[];function At(){vo.push(kt),kt=!1}function Rt(){const n=vo.pop();kt=n===void 0?!0:n}function yo(n){const{cleanup:e}=n;if(n.cleanup=void 0,e){const t=Ie;Ie=void 0;try{e()}finally{Ie=t}}}let Ss=0;class sh{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Mr{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!Ie||!kt||Ie===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==Ie)t=this.activeLink=new sh(Ie,this),Ie.deps?(t.prevDep=Ie.depsTail,Ie.depsTail.nextDep=t,Ie.depsTail=t):Ie.deps=Ie.depsTail=t,bo(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){const s=t.nextDep;s.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=s),t.prevDep=Ie.depsTail,t.nextDep=void 0,Ie.depsTail.nextDep=t,Ie.depsTail=t,Ie.deps===t&&(Ie.deps=s)}return t}trigger(e){this.version++,Ss++,this.notify(e)}notify(e){Ar();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{Rr()}}}function bo(n){if(n.dep.sc++,n.sub.flags&4){const e=n.dep.computed;if(e&&!n.dep.subs){e.flags|=20;for(let s=e.deps;s;s=s.nextDep)bo(s)}const t=n.dep.subs;t!==n&&(n.prevSub=t,t&&(t.nextSub=n)),n.dep.subs=n}}const Or=new WeakMap,On=Symbol(""),Nr=Symbol(""),ks=Symbol("");function Ze(n,e,t){if(kt&&Ie){let s=Or.get(n);s||Or.set(n,s=new Map);let i=s.get(t);i||(s.set(t,i=new Mr),i.map=s,i.key=t),i.track()}}function Ut(n,e,t,s,i,r){const a=Or.get(n);if(!a){Ss++;return}const o=l=>{l&&l.trigger()};if(Ar(),e==="clear")a.forEach(o);else{const l=de(n),c=l&&xr(t);if(l&&t==="length"){const d=Number(s);a.forEach((h,u)=>{(u==="length"||u===ks||!on(u)&&u>=d)&&o(h)})}else switch((t!==void 0||a.has(void 0))&&o(a.get(t)),c&&o(a.get(ks)),e){case"add":l?c&&o(a.get("length")):(o(a.get(On)),ts(n)&&o(a.get(Nr)));break;case"delete":l||(o(a.get(On)),ts(n)&&o(a.get(Nr)));break;case"set":ts(n)&&o(a.get(On));break}}Rr()}function ns(n){const e=xe(n);return e===n?e:(Ze(e,"iterate",ks),gt(n)?e:e.map(Ct))}function mi(n){return Ze(n=xe(n),"iterate",ks),n}function cn(n,e){return jt(n)?Nn(n)?ss(Ct(e)):ss(e):Ct(e)}const ih={__proto__:null,[Symbol.iterator](){return Lr(this,Symbol.iterator,n=>cn(this,n))},concat(...n){return ns(this).concat(...n.map(e=>de(e)?ns(e):e))},entries(){return Lr(this,"entries",n=>(n[1]=cn(this,n[1]),n))},every(n,e){return Vt(this,"every",n,e,void 0,arguments)},filter(n,e){return Vt(this,"filter",n,e,t=>t.map(s=>cn(this,s)),arguments)},find(n,e){return Vt(this,"find",n,e,t=>cn(this,t),arguments)},findIndex(n,e){return Vt(this,"findIndex",n,e,void 0,arguments)},findLast(n,e){return Vt(this,"findLast",n,e,t=>cn(this,t),arguments)},findLastIndex(n,e){return Vt(this,"findLastIndex",n,e,void 0,arguments)},forEach(n,e){return Vt(this,"forEach",n,e,void 0,arguments)},includes(...n){return Dr(this,"includes",n)},indexOf(...n){return Dr(this,"indexOf",n)},join(n){return ns(this).join(n)},lastIndexOf(...n){return Dr(this,"lastIndexOf",n)},map(n,e){return Vt(this,"map",n,e,void 0,arguments)},pop(){return Cs(this,"pop")},push(...n){return Cs(this,"push",n)},reduce(n,...e){return wo(this,"reduce",n,e)},reduceRight(n,...e){return wo(this,"reduceRight",n,e)},shift(){return Cs(this,"shift")},some(n,e){return Vt(this,"some",n,e,void 0,arguments)},splice(...n){return Cs(this,"splice",n)},toReversed(){return ns(this).toReversed()},toSorted(n){return ns(this).toSorted(n)},toSpliced(...n){return ns(this).toSpliced(...n)},unshift(...n){return Cs(this,"unshift",n)},values(){return Lr(this,"values",n=>cn(this,n))}};function Lr(n,e,t){const s=mi(n),i=s[e]();return s!==n&&!gt(n)&&(i._next=i.next,i.next=()=>{const r=i._next();return r.done||(r.value=t(r.value)),r}),i}const rh=Array.prototype;function Vt(n,e,t,s,i,r){const a=mi(n),o=a!==n&&!gt(n),l=a[e];if(l!==rh[e]){const h=l.apply(n,r);return o?Ct(h):h}let c=t;a!==n&&(o?c=function(h,u){return t.call(this,cn(n,h),u,n)}:t.length>2&&(c=function(h,u){return t.call(this,h,u,n)}));const d=l.call(a,c,s);return o&&i?i(d):d}function wo(n,e,t,s){const i=mi(n);let r=t;return i!==n&&(gt(n)?t.length>3&&(r=function(a,o,l){return t.call(this,a,o,l,n)}):r=function(a,o,l){return t.call(this,a,cn(n,o),l,n)}),i[e](r,...s)}function Dr(n,e,t){const s=xe(n);Ze(s,"iterate",ks);const i=s[e](...t);return(i===-1||i===!1)&&Br(t[0])?(t[0]=xe(t[0]),s[e](...t)):i}function Cs(n,e,t=[]){At(),Ar();const s=xe(n)[e].apply(n,t);return Rr(),Rt(),s}const ah=yr("__proto__,__v_isRef,__isVue"),xo=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(on));function oh(n){on(n)||(n=String(n));const e=xe(this);return Ze(e,"has",n),e.hasOwnProperty(n)}class So{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,s){if(t==="__v_skip")return e.__v_skip;const i=this._isReadonly,r=this._isShallow;if(t==="__v_isReactive")return!i;if(t==="__v_isReadonly")return i;if(t==="__v_isShallow")return r;if(t==="__v_raw")return s===(i?r?Ro:Ao:r?Eo:To).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(s)?e:void 0;const a=de(e);if(!i){let l;if(a&&(l=ih[t]))return l;if(t==="hasOwnProperty")return oh}const o=Reflect.get(e,t,Ke(e)?e:s);if((on(t)?xo.has(t):ah(t))||(i||Ze(e,"get",t),r))return o;if(Ke(o)){const l=a&&xr(t)?o:o.value;return i&&Le(l)?Fr(l):l}return Le(o)?i?Fr(o):bi(o):o}}class ko extends So{constructor(e=!1){super(!1,e)}set(e,t,s,i){let r=e[t];const a=de(e)&&xr(t);if(!this._isShallow){const c=jt(r);if(!gt(s)&&!jt(s)&&(r=xe(r),s=xe(s)),!a&&Ke(r)&&!Ke(s))return c||(r.value=s),!0}const o=a?Number(t)<e.length:ke(e,t),l=Reflect.set(e,t,s,Ke(e)?e:i);return e===xe(i)&&(o?ln(s,r)&&Ut(e,"set",t,s):Ut(e,"add",t,s)),l}deleteProperty(e,t){const s=ke(e,t);e[t];const i=Reflect.deleteProperty(e,t);return i&&s&&Ut(e,"delete",t,void 0),i}has(e,t){const s=Reflect.has(e,t);return(!on(t)||!xo.has(t))&&Ze(e,"has",t),s}ownKeys(e){return Ze(e,"iterate",de(e)?"length":On),Reflect.ownKeys(e)}}class Co extends So{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const lh=new ko,ch=new Co,dh=new ko(!0),hh=new Co(!0),Gr=n=>n,_i=n=>Reflect.getPrototypeOf(n);function uh(n,e,t){return function(...s){const i=this.__v_raw,r=xe(i),a=ts(r),o=n==="entries"||n===Symbol.iterator&&a,l=n==="keys"&&a,c=i[n](...s),d=t?Gr:e?ss:Ct;return!e&&Ze(r,"iterate",l?Nr:On),{next(){const{value:h,done:u}=c.next();return u?{value:h,done:u}:{value:o?[d(h[0]),d(h[1])]:d(h),done:u}},[Symbol.iterator](){return this}}}}function vi(n){return function(...e){return n==="delete"?!1:n==="clear"?void 0:this}}function fh(n,e){const t={get(i){const r=this.__v_raw,a=xe(r),o=xe(i);n||(ln(i,o)&&Ze(a,"get",i),Ze(a,"get",o));const{has:l}=_i(a),c=e?Gr:n?ss:Ct;if(l.call(a,i))return c(r.get(i));if(l.call(a,o))return c(r.get(o));r!==a&&r.get(i)},get size(){const i=this.__v_raw;return!n&&Ze(xe(i),"iterate",On),i.size},has(i){const r=this.__v_raw,a=xe(r),o=xe(i);return n||(ln(i,o)&&Ze(a,"has",i),Ze(a,"has",o)),i===o?r.has(i):r.has(i)||r.has(o)},forEach(i,r){const a=this,o=a.__v_raw,l=xe(o),c=e?Gr:n?ss:Ct;return!n&&Ze(l,"iterate",On),o.forEach((d,h)=>i.call(r,c(d),c(h),a))}};return Ge(t,n?{add:vi("add"),set:vi("set"),delete:vi("delete"),clear:vi("clear")}:{add(i){!e&&!gt(i)&&!jt(i)&&(i=xe(i));const r=xe(this);return _i(r).has.call(r,i)||(r.add(i),Ut(r,"add",i,i)),this},set(i,r){!e&&!gt(r)&&!jt(r)&&(r=xe(r));const a=xe(this),{has:o,get:l}=_i(a);let c=o.call(a,i);c||(i=xe(i),c=o.call(a,i));const d=l.call(a,i);return a.set(i,r),c?ln(r,d)&&Ut(a,"set",i,r):Ut(a,"add",i,r),this},delete(i){const r=xe(this),{has:a,get:o}=_i(r);let l=a.call(r,i);l||(i=xe(i),l=a.call(r,i)),o&&o.call(r,i);const c=r.delete(i);return l&&Ut(r,"delete",i,void 0),c},clear(){const i=xe(this),r=i.size!==0,a=i.clear();return r&&Ut(i,"clear",void 0,void 0),a}}),["keys","values","entries",Symbol.iterator].forEach(i=>{t[i]=uh(i,n,e)}),t}function yi(n,e){const t=fh(n,e);return(s,i,r)=>i==="__v_isReactive"?!n:i==="__v_isReadonly"?n:i==="__v_raw"?s:Reflect.get(ke(t,i)&&i in s?t:s,i,r)}const ph={get:yi(!1,!1)},gh={get:yi(!1,!0)},mh={get:yi(!0,!1)},_h={get:yi(!0,!0)},To=new WeakMap,Eo=new WeakMap,Ao=new WeakMap,Ro=new WeakMap;function vh(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function yh(n){return n.__v_skip||!Object.isExtensible(n)?0:vh(jd(n))}function bi(n){return jt(n)?n:wi(n,!1,lh,ph,To)}function bh(n){return wi(n,!1,dh,gh,Eo)}function Fr(n){return wi(n,!0,ch,mh,Ao)}function lm(n){return wi(n,!0,hh,_h,Ro)}function wi(n,e,t,s,i){if(!Le(n)||n.__v_raw&&!(e&&n.__v_isReactive))return n;const r=yh(n);if(r===0)return n;const a=i.get(n);if(a)return a;const o=new Proxy(n,r===2?s:t);return i.set(n,o),o}function Nn(n){return jt(n)?Nn(n.__v_raw):!!(n&&n.__v_isReactive)}function jt(n){return!!(n&&n.__v_isReadonly)}function gt(n){return!!(n&&n.__v_isShallow)}function Br(n){return n?!!n.__v_raw:!1}function xe(n){const e=n&&n.__v_raw;return e?xe(e):n}function wh(n){return!ke(n,"__v_skip")&&Object.isExtensible(n)&&ao(n,"__v_skip",!0),n}const Ct=n=>Le(n)?bi(n):n,ss=n=>Le(n)?Fr(n):n;function Ke(n){return n?n.__v_isRef===!0:!1}function me(n){return Io(n,!1)}function xh(n){return Io(n,!0)}function Io(n,e){return Ke(n)?n:new Sh(n,e)}class Sh{constructor(e,t){this.dep=new Mr,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?e:xe(e),this._value=t?e:Ct(e),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(e){const t=this._rawValue,s=this.__v_isShallow||gt(e)||jt(e);e=s?e:xe(e),ln(e,t)&&(this._rawValue=e,this._value=s?e:Ct(e),this.dep.trigger())}}function _e(n){return Ke(n)?n.value:n}const kh={get:(n,e,t)=>e==="__v_raw"?n:_e(Reflect.get(n,e,t)),set:(n,e,t,s)=>{const i=n[e];return Ke(i)&&!Ke(t)?(i.value=t,!0):Reflect.set(n,e,t,s)}};function Po(n){return Nn(n)?n:new Proxy(n,kh)}class Ch{constructor(e,t,s){this.fn=e,this.setter=t,this._value=void 0,this.dep=new Mr(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Ss-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=s}notify(){if(this.flags|=16,!(this.flags&8)&&Ie!==this)return po(this,!0),!0}get value(){const e=this.dep.track();return _o(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function Th(n,e,t=!1){let s,i;return pe(n)?s=n:(s=n.get,i=n.set),new Ch(s,i,t)}const xi={},Si=new WeakMap;let Ln;function Eh(n,e=!1,t=Ln){if(t){let s=Si.get(t);s||Si.set(t,s=[]),s.push(n)}}function Ah(n,e,t=Ee){const{immediate:s,deep:i,once:r,scheduler:a,augmentJob:o,call:l}=t,c=_=>i?_:gt(_)||i===!1||i===0?zt(_,1):zt(_);let d,h,u,f,p=!1,m=!1;if(Ke(n)?(h=()=>n.value,p=gt(n)):Nn(n)?(h=()=>c(n),p=!0):de(n)?(m=!0,p=n.some(_=>Nn(_)||gt(_)),h=()=>n.map(_=>{if(Ke(_))return _.value;if(Nn(_))return c(_);if(pe(_))return l?l(_,2):_()})):pe(n)?e?h=l?()=>l(n,2):n:h=()=>{if(u){At();try{u()}finally{Rt()}}const _=Ln;Ln=d;try{return l?l(n,3,[f]):n(f)}finally{Ln=_}}:h=wt,e&&i){const _=h,C=i===!0?1/0:i;h=()=>zt(_(),C)}const v=th(),S=()=>{d.stop(),v&&v.active&&wr(v.effects,d)};if(r&&e){const _=e;e=(...C)=>{_(...C),S()}}let k=m?new Array(n.length).fill(xi):xi;const b=_=>{if(!(!(d.flags&1)||!d.dirty&&!_))if(e){const C=d.run();if(i||p||(m?C.some((A,L)=>ln(A,k[L])):ln(C,k))){u&&u();const A=Ln;Ln=d;try{const L=[C,k===xi?void 0:m&&k[0]===xi?[]:k,f];k=C,l?l(e,3,L):e(...L)}finally{Ln=A}}}else d.run()};return o&&o(b),d=new uo(h),d.scheduler=a?()=>a(b,!1):b,f=_=>Eh(_,!1,d),u=d.onStop=()=>{const _=Si.get(d);if(_){if(l)l(_,4);else for(const C of _)C();Si.delete(d)}},e?s?b(!0):k=d.run():a?a(b.bind(null,!0),!0):d.run(),S.pause=d.pause.bind(d),S.resume=d.resume.bind(d),S.stop=S,S}function zt(n,e=1/0,t){if(e<=0||!Le(n)||n.__v_skip||(t=t||new Map,(t.get(n)||0)>=e))return n;if(t.set(n,e),e--,Ke(n))zt(n.value,e,t);else if(de(n))for(let s=0;s<n.length;s++)zt(n[s],e,t);else if(no(n)||ts(n))n.forEach(s=>{zt(s,e,t)});else if(ui(n)){for(const s in n)zt(n[s],e,t);for(const s of Object.getOwnPropertySymbols(n))Object.prototype.propertyIsEnumerable.call(n,s)&&zt(n[s],e,t)}return n}const Ts=[];let Hr=!1;function cm(n,...e){if(Hr)return;Hr=!0,At();const t=Ts.length?Ts[Ts.length-1].component:null,s=t&&t.appContext.config.warnHandler,i=Rh();if(s)is(s,t,11,[n+e.map(r=>{var a,o;return(o=(a=r.toString)==null?void 0:a.call(r))!=null?o:JSON.stringify(r)}).join(""),t&&t.proxy,i.map(({vnode:r})=>`at <${Nl(t,r.type)}>`).join(`
`),i]);else{const r=[`[Vue warn]: ${n}`,...e];i.length&&r.push(`
`,...Ih(i)),console.warn(...r)}Rt(),Hr=!1}function Rh(){let n=Ts[Ts.length-1];if(!n)return[];const e=[];for(;n;){const t=e[0];t&&t.vnode===n?t.recurseCount++:e.push({vnode:n,recurseCount:0});const s=n.component&&n.component.parent;n=s&&s.vnode}return e}function Ih(n){const e=[];return n.forEach((t,s)=>{e.push(...s===0?[]:[`
`],...Ph(t))}),e}function Ph({vnode:n,recurseCount:e}){const t=e>0?`... (${e} recursive calls)`:"",s=n.component?n.component.parent==null:!1,i=` at <${Nl(n.component,n.type,s)}`,r=">"+t;return n.props?[i,...Mh(n.props),r]:[i+r]}function Mh(n){const e=[],t=Object.keys(n);return t.slice(0,3).forEach(s=>{e.push(...Mo(s,n[s]))}),t.length>3&&e.push(" ..."),e}function Mo(n,e,t){return Fe(e)?(e=JSON.stringify(e),t?e:[`${n}=${e}`]):typeof e=="number"||typeof e=="boolean"||e==null?t?e:[`${n}=${e}`]:Ke(e)?(e=Mo(n,xe(e.value),!0),t?e:[`${n}=Ref<`,e,">"]):pe(e)?[`${n}=fn${e.name?`<${e.name}>`:""}`]:(e=xe(e),t?e:[`${n}=`,e])}function is(n,e,t,s){try{return s?n(...s):n()}catch(i){ki(i,e,t)}}function Tt(n,e,t,s){if(pe(n)){const i=is(n,e,t,s);return i&&so(i)&&i.catch(r=>{ki(r,e,t)}),i}if(de(n)){const i=[];for(let r=0;r<n.length;r++)i.push(Tt(n[r],e,t,s));return i}}function ki(n,e,t,s=!0){const i=e?e.vnode:null,{errorHandler:r,throwUnhandledErrorInProduction:a}=e&&e.appContext.config||Ee;if(e){let o=e.parent;const l=e.proxy,c=`https://vuejs.org/error-reference/#runtime-${t}`;for(;o;){const d=o.ec;if(d){for(let h=0;h<d.length;h++)if(d[h](n,l,c)===!1)return}o=o.parent}if(r){At(),is(r,null,10,[n,l,c]),Rt();return}}Oh(n,t,i,s,a)}function Oh(n,e,t,s=!0,i=!1){if(i)throw n;console.error(n)}const qe=[];let It=-1;const rs=[];let dn=null,as=0;const Oo=Promise.resolve();let Ci=null;function No(n){const e=Ci||Oo;return n?e.then(this?n.bind(this):n):e}function Nh(n){let e=It+1,t=qe.length;for(;e<t;){const s=e+t>>>1,i=qe[s],r=Es(i);r<n||r===n&&i.flags&2?e=s+1:t=s}return e}function $r(n){if(!(n.flags&1)){const e=Es(n),t=qe[qe.length-1];!t||!(n.flags&2)&&e>=Es(t)?qe.push(n):qe.splice(Nh(e),0,n),n.flags|=1,Lo()}}function Lo(){Ci||(Ci=Oo.then(Bo))}function Do(n){de(n)?rs.push(...n):dn&&n.id===-1?dn.splice(as+1,0,n):n.flags&1||(rs.push(n),n.flags|=1),Lo()}function Go(n,e,t=It+1){for(;t<qe.length;t++){const s=qe[t];if(s&&s.flags&2){if(n&&s.id!==n.uid)continue;qe.splice(t,1),t--,s.flags&4&&(s.flags&=-2),s(),s.flags&4||(s.flags&=-2)}}}function Fo(n){if(rs.length){const e=[...new Set(rs)].sort((t,s)=>Es(t)-Es(s));if(rs.length=0,dn){dn.push(...e);return}for(dn=e,as=0;as<dn.length;as++){const t=dn[as];t.flags&4&&(t.flags&=-2),t.flags&8||t(),t.flags&=-2}dn=null,as=0}}const Es=n=>n.id==null?n.flags&2?-1:1/0:n.id;function Bo(n){try{for(It=0;It<qe.length;It++){const e=qe[It];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),is(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;It<qe.length;It++){const e=qe[It];e&&(e.flags&=-2)}It=-1,qe.length=0,Fo(),Ci=null,(qe.length||rs.length)&&Bo()}}let mt=null,Ho=null;function Ti(n){const e=mt;return mt=n,Ho=n&&n.type.__scopeId||null,e}function $o(n,e=mt,t){if(!e||n._n)return n;const s=(...i)=>{s._d&&Tl(-1);const r=Ti(e);let a;try{a=n(...i)}finally{Ti(r),s._d&&Tl(1)}return a};return s._n=!0,s._c=!0,s._d=!0,s}function Lh(n,e){if(mt===null)return n;const t=Fi(mt),s=n.dirs||(n.dirs=[]);for(let i=0;i<e.length;i++){let[r,a,o,l=Ee]=e[i];r&&(pe(r)&&(r={mounted:r,updated:r}),r.deep&&zt(a),s.push({dir:r,instance:t,value:a,oldValue:void 0,arg:o,modifiers:l}))}return n}function Dn(n,e,t,s){const i=n.dirs,r=e&&e.dirs;for(let a=0;a<i.length;a++){const o=i[a];r&&(o.oldValue=r[a].value);let l=o.dir[s];l&&(At(),Tt(l,t,8,[n.el,o,n,e]),Rt())}}const Wo=Symbol("_vte"),Dh=n=>n.__isTeleport,As=n=>n&&(n.disabled||n.disabled===""),Uo=n=>n&&(n.defer||n.defer===""),Vo=n=>typeof SVGElement<"u"&&n instanceof SVGElement,jo=n=>typeof MathMLElement=="function"&&n instanceof MathMLElement,Wr=(n,e)=>{const t=n&&n.to;return Fe(t)?e?e(t):null:t},zo={name:"Teleport",__isTeleport:!0,process(n,e,t,s,i,r,a,o,l,c){const{mc:d,pc:h,pbc:u,o:{insert:f,querySelector:p,createText:m,createComment:v}}=c,S=As(e.props);let{shapeFlag:k,children:b,dynamicChildren:_}=e;if(n==null){const C=e.el=m(""),A=e.anchor=m("");f(C,t,s),f(A,t,s);const L=(I,W)=>{k&16&&d(b,I,W,i,r,a,o,l)},O=()=>{const I=e.target=Wr(e.props,p),W=Yo(I,e,m,f);I&&(a!=="svg"&&Vo(I)?a="svg":a!=="mathml"&&jo(I)&&(a="mathml"),i&&i.isCE&&(i.ce._teleportTargets||(i.ce._teleportTargets=new Set)).add(I),S||(L(I,W),Ai(e,!1)))};S&&(L(t,A),Ai(e,!0)),Uo(e.props)?(e.el.__isMounted=!1,et(()=>{O(),delete e.el.__isMounted},r)):O()}else{if(Uo(e.props)&&n.el.__isMounted===!1){et(()=>{zo.process(n,e,t,s,i,r,a,o,l,c)},r);return}e.el=n.el,e.targetStart=n.targetStart;const C=e.anchor=n.anchor,A=e.target=n.target,L=e.targetAnchor=n.targetAnchor,O=As(n.props),I=O?t:A,W=O?C:L;if(a==="svg"||Vo(A)?a="svg":(a==="mathml"||jo(A))&&(a="mathml"),_?(u(n.dynamicChildren,_,I,i,r,a,o),Jr(n,e,!0)):l||h(n,e,I,W,i,r,a,o,!1),S)O?e.props&&n.props&&e.props.to!==n.props.to&&(e.props.to=n.props.to):Ei(e,t,C,c,1);else if((e.props&&e.props.to)!==(n.props&&n.props.to)){const K=e.target=Wr(e.props,p);K&&Ei(e,K,null,c,0)}else O&&Ei(e,A,L,c,1);Ai(e,S)}},remove(n,e,t,{um:s,o:{remove:i}},r){const{shapeFlag:a,children:o,anchor:l,targetStart:c,targetAnchor:d,target:h,props:u}=n;if(h&&(i(c),i(d)),r&&i(l),a&16){const f=r||!As(u);for(let p=0;p<o.length;p++){const m=o[p];s(m,e,t,f,!!m.dynamicChildren)}}},move:Ei,hydrate:Gh};function Ei(n,e,t,{o:{insert:s},m:i},r=2){r===0&&s(n.targetAnchor,e,t);const{el:a,anchor:o,shapeFlag:l,children:c,props:d}=n,h=r===2;if(h&&s(a,e,t),(!h||As(d))&&l&16)for(let u=0;u<c.length;u++)i(c[u],e,t,2);h&&s(o,e,t)}function Gh(n,e,t,s,i,r,{o:{nextSibling:a,parentNode:o,querySelector:l,insert:c,createText:d}},h){function u(m,v,S,k){v.anchor=h(a(m),v,o(m),t,s,i,r),v.targetStart=S,v.targetAnchor=k}const f=e.target=Wr(e.props,l),p=As(e.props);if(f){const m=f._lpa||f.firstChild;if(e.shapeFlag&16)if(p)u(n,e,m,m&&a(m));else{e.anchor=a(n);let v=m;for(;v;){if(v&&v.nodeType===8){if(v.data==="teleport start anchor")e.targetStart=v;else if(v.data==="teleport anchor"){e.targetAnchor=v,f._lpa=e.targetAnchor&&a(e.targetAnchor);break}}v=a(v)}e.targetAnchor||Yo(f,e,d,c),h(m&&a(m),e,f,t,s,i,r)}Ai(e,p)}else p&&e.shapeFlag&16&&u(n,e,n,a(n));return e.anchor&&a(e.anchor)}const Fh=zo;function Ai(n,e){const t=n.ctx;if(t&&t.ut){let s,i;for(e?(s=n.el,i=n.anchor):(s=n.targetStart,i=n.targetAnchor);s&&s!==i;)s.nodeType===1&&s.setAttribute("data-v-owner",t.uid),s=s.nextSibling;t.ut()}}function Yo(n,e,t,s){const i=e.targetStart=t(""),r=e.targetAnchor=t("");return i[Wo]=r,n&&(s(i,n),s(r,n)),r}const Gn=Symbol("_leaveCb"),Ri=Symbol("_enterCb");function Bh(){const n={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Pt(()=>{n.isMounted=!0}),tl(()=>{n.isUnmounting=!0}),n}const _t=[Function,Array],Hh={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:_t,onEnter:_t,onAfterEnter:_t,onEnterCancelled:_t,onBeforeLeave:_t,onLeave:_t,onAfterLeave:_t,onLeaveCancelled:_t,onBeforeAppear:_t,onAppear:_t,onAfterAppear:_t,onAppearCancelled:_t};function $h(n,e){const{leavingVNodes:t}=n;let s=t.get(e.type);return s||(s=Object.create(null),t.set(e.type,s)),s}function Ur(n,e,t,s,i){const{appear:r,mode:a,persisted:o=!1,onBeforeEnter:l,onEnter:c,onAfterEnter:d,onEnterCancelled:h,onBeforeLeave:u,onLeave:f,onAfterLeave:p,onLeaveCancelled:m,onBeforeAppear:v,onAppear:S,onAfterAppear:k,onAppearCancelled:b}=e,_=String(n.key),C=$h(t,n),A=(I,W)=>{I&&Tt(I,s,9,W)},L=(I,W)=>{const K=W[1];A(I,W),de(I)?I.every(g=>g.length<=1)&&K():I.length<=1&&K()},O={mode:a,persisted:o,beforeEnter(I){let W=l;if(!t.isMounted)if(r)W=v||l;else return;I[Gn]&&I[Gn](!0);const K=C[_];K&&ls(n,K)&&K.el[Gn]&&K.el[Gn](),A(W,[I])},enter(I){let W=c,K=d,g=h;if(!t.isMounted)if(r)W=S||c,K=k||d,g=b||h;else return;let w=!1;const R=I[Ri]=P=>{w||(w=!0,P?A(g,[I]):A(K,[I]),O.delayedLeave&&O.delayedLeave(),I[Ri]=void 0)};W?L(W,[I,R]):R()},leave(I,W){const K=String(n.key);if(I[Ri]&&I[Ri](!0),t.isUnmounting)return W();A(u,[I]);let g=!1;const w=I[Gn]=R=>{g||(g=!0,W(),R?A(m,[I]):A(p,[I]),I[Gn]=void 0,C[K]===n&&delete C[K])};C[K]=n,f?L(f,[I,w]):w()},clone(I){return Ur(I,e,t,s)}};return O}function Rs(n,e){n.shapeFlag&6&&n.component?(n.transition=e,Rs(n.component.subTree,e)):n.shapeFlag&128?(n.ssContent.transition=e.clone(n.ssContent),n.ssFallback.transition=e.clone(n.ssFallback)):n.transition=e}function Xo(n,e=!1,t){let s=[],i=0;for(let r=0;r<n.length;r++){let a=n[r];const o=t==null?a.key:String(t)+String(a.key!=null?a.key:r);a.type===He?(a.patchFlag&128&&i++,s=s.concat(Xo(a.children,e,o))):(e||a.type!==Kt)&&s.push(o!=null?Bn(a,{key:o}):a)}if(i>1)for(let r=0;r<s.length;r++)s[r].patchFlag=-2;return s}function st(n,e){return pe(n)?Ge({name:n.name},e,{setup:n}):n}function Ko(n){n.ids=[n.ids[0]+n.ids[2]+++"-",0,0]}const Ii=new WeakMap;function Is(n,e,t,s,i=!1){if(de(n)){n.forEach((p,m)=>Is(p,e&&(de(e)?e[m]:e),t,s,i));return}if(Ps(s)&&!i){s.shapeFlag&512&&s.type.__asyncResolved&&s.component.subTree.component&&Is(n,e,t,s.component.subTree);return}const r=s.shapeFlag&4?Fi(s.component):s.el,a=i?null:r,{i:o,r:l}=n,c=e&&e.r,d=o.refs===Ee?o.refs={}:o.refs,h=o.setupState,u=xe(h),f=h===Ee?to:p=>ke(u,p);if(c!=null&&c!==l){if(Zo(e),Fe(c))d[c]=null,f(c)&&(h[c]=null);else if(Ke(c)){c.value=null;const p=e;p.k&&(d[p.k]=null)}}if(pe(l))is(l,o,12,[a,d]);else{const p=Fe(l),m=Ke(l);if(p||m){const v=()=>{if(n.f){const S=p?f(l)?h[l]:d[l]:l.value;if(i)de(S)&&wr(S,r);else if(de(S))S.includes(r)||S.push(r);else if(p)d[l]=[r],f(l)&&(h[l]=d[l]);else{const k=[r];l.value=k,n.k&&(d[n.k]=k)}}else p?(d[l]=a,f(l)&&(h[l]=a)):m&&(l.value=a,n.k&&(d[n.k]=a))};if(a){const S=()=>{v(),Ii.delete(n)};S.id=-1,Ii.set(n,S),et(S,t)}else Zo(n),v()}}}function Zo(n){const e=Ii.get(n);e&&(e.flags|=8,Ii.delete(n))}gi().requestIdleCallback,gi().cancelIdleCallback;const Ps=n=>!!n.type.__asyncLoader,qo=n=>n.type.__isKeepAlive;function Wh(n,e){Jo(n,"a",e)}function Uh(n,e){Jo(n,"da",e)}function Jo(n,e,t=tt){const s=n.__wdc||(n.__wdc=()=>{let i=t;for(;i;){if(i.isDeactivated)return;i=i.parent}return n()});if(Pi(e,s,t),t){let i=t.parent;for(;i&&i.parent;)qo(i.parent.vnode)&&Vh(s,e,t,i),i=i.parent}}function Vh(n,e,t,s){const i=Pi(e,n,s,!0);Xt(()=>{wr(s[e],i)},t)}function Pi(n,e,t=tt,s=!1){if(t){const i=t[n]||(t[n]=[]),r=e.__weh||(e.__weh=(...a)=>{At();const o=Ds(t),l=Tt(e,t,n,a);return o(),Rt(),l});return s?i.unshift(r):i.push(r),r}}const Yt=n=>(e,t=tt)=>{(!Gs||n==="sp")&&Pi(n,(...s)=>e(...s),t)},jh=Yt("bm"),Pt=Yt("m"),Qo=Yt("bu"),el=Yt("u"),tl=Yt("bum"),Xt=Yt("um"),zh=Yt("sp"),Yh=Yt("rtg"),Xh=Yt("rtc");function Kh(n,e=tt){Pi("ec",n,e)}const Zh=Symbol.for("v-ndc");function hn(n,e,t,s){let i;const r=t,a=de(n);if(a||Fe(n)){const o=a&&Nn(n);let l=!1,c=!1;o&&(l=!gt(n),c=jt(n),n=mi(n)),i=new Array(n.length);for(let d=0,h=n.length;d<h;d++)i[d]=e(l?c?ss(Ct(n[d])):Ct(n[d]):n[d],d,void 0,r)}else if(typeof n=="number"){i=new Array(n);for(let o=0;o<n;o++)i[o]=e(o+1,o,void 0,r)}else if(Le(n))if(n[Symbol.iterator])i=Array.from(n,(o,l)=>e(o,l,void 0,r));else{const o=Object.keys(n);i=new Array(o.length);for(let l=0,c=o.length;l<c;l++){const d=o[l];i[l]=e(n[d],d,l,r)}}else i=[];return i}const Vr=n=>n?Pl(n)?Fi(n):Vr(n.parent):null,Ms=Ge(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>Vr(n.parent),$root:n=>Vr(n.root),$host:n=>n.ce,$emit:n=>n.emit,$options:n=>rl(n),$forceUpdate:n=>n.f||(n.f=()=>{$r(n.update)}),$nextTick:n=>n.n||(n.n=No.bind(n.proxy)),$watch:n=>ou.bind(n)}),jr=(n,e)=>n!==Ee&&!n.__isScriptSetup&&ke(n,e),qh={get({_:n},e){if(e==="__v_skip")return!0;const{ctx:t,setupState:s,data:i,props:r,accessCache:a,type:o,appContext:l}=n;if(e[0]!=="$"){const u=a[e];if(u!==void 0)switch(u){case 1:return s[e];case 2:return i[e];case 4:return t[e];case 3:return r[e]}else{if(jr(s,e))return a[e]=1,s[e];if(i!==Ee&&ke(i,e))return a[e]=2,i[e];if(ke(r,e))return a[e]=3,r[e];if(t!==Ee&&ke(t,e))return a[e]=4,t[e];zr&&(a[e]=0)}}const c=Ms[e];let d,h;if(c)return e==="$attrs"&&Ze(n.attrs,"get",""),c(n);if((d=o.__cssModules)&&(d=d[e]))return d;if(t!==Ee&&ke(t,e))return a[e]=4,t[e];if(h=l.config.globalProperties,ke(h,e))return h[e]},set({_:n},e,t){const{data:s,setupState:i,ctx:r}=n;return jr(i,e)?(i[e]=t,!0):s!==Ee&&ke(s,e)?(s[e]=t,!0):ke(n.props,e)||e[0]==="$"&&e.slice(1)in n?!1:(r[e]=t,!0)},has({_:{data:n,setupState:e,accessCache:t,ctx:s,appContext:i,props:r,type:a}},o){let l;return!!(t[o]||n!==Ee&&o[0]!=="$"&&ke(n,o)||jr(e,o)||ke(r,o)||ke(s,o)||ke(Ms,o)||ke(i.config.globalProperties,o)||(l=a.__cssModules)&&l[o])},defineProperty(n,e,t){return t.get!=null?n._.accessCache[e]=0:ke(t,"value")&&this.set(n,e,t.value,null),Reflect.defineProperty(n,e,t)}};function nl(n){return de(n)?n.reduce((e,t)=>(e[t]=null,e),{}):n}let zr=!0;function Jh(n){const e=rl(n),t=n.proxy,s=n.ctx;zr=!1,e.beforeCreate&&sl(e.beforeCreate,n,"bc");const{data:i,computed:r,methods:a,watch:o,provide:l,inject:c,created:d,beforeMount:h,mounted:u,beforeUpdate:f,updated:p,activated:m,deactivated:v,beforeDestroy:S,beforeUnmount:k,destroyed:b,unmounted:_,render:C,renderTracked:A,renderTriggered:L,errorCaptured:O,serverPrefetch:I,expose:W,inheritAttrs:K,components:g,directives:w,filters:R}=e;if(c&&Qh(c,s,null),a)for(const D in a){const G=a[D];pe(G)&&(s[D]=G.bind(t))}if(i){const D=i.call(t,t);Le(D)&&(n.data=bi(D))}if(zr=!0,r)for(const D in r){const G=r[D],J=pe(G)?G.bind(t,t):pe(G.get)?G.get.bind(t,t):wt,ae=!pe(G)&&pe(G.set)?G.set.bind(t):wt,ne=Pe({get:J,set:ae});Object.defineProperty(s,D,{enumerable:!0,configurable:!0,get:()=>ne.value,set:ie=>ne.value=ie})}if(o)for(const D in o)il(o[D],s,t,D);if(l){const D=pe(l)?l.call(t):l;Reflect.ownKeys(D).forEach(G=>{un(G,D[G])})}d&&sl(d,n,"c");function M(D,G){de(G)?G.forEach(J=>D(J.bind(t))):G&&D(G.bind(t))}if(M(jh,h),M(Pt,u),M(Qo,f),M(el,p),M(Wh,m),M(Uh,v),M(Kh,O),M(Xh,A),M(Yh,L),M(tl,k),M(Xt,_),M(zh,I),de(W))if(W.length){const D=n.exposed||(n.exposed={});W.forEach(G=>{Object.defineProperty(D,G,{get:()=>t[G],set:J=>t[G]=J,enumerable:!0})})}else n.exposed||(n.exposed={});C&&n.render===wt&&(n.render=C),K!=null&&(n.inheritAttrs=K),g&&(n.components=g),w&&(n.directives=w),I&&Ko(n)}function Qh(n,e,t=wt){de(n)&&(n=Yr(n));for(const s in n){const i=n[s];let r;Le(i)?"default"in i?r=Mt(i.from||s,i.default,!0):r=Mt(i.from||s):r=Mt(i),Ke(r)?Object.defineProperty(e,s,{enumerable:!0,configurable:!0,get:()=>r.value,set:a=>r.value=a}):e[s]=r}}function sl(n,e,t){Tt(de(n)?n.map(s=>s.bind(e.proxy)):n.bind(e.proxy),e,t)}function il(n,e,t,s){let i=s.includes(".")?dl(t,s):()=>t[s];if(Fe(n)){const r=e[n];pe(r)&&Qe(i,r)}else if(pe(n))Qe(i,n.bind(t));else if(Le(n))if(de(n))n.forEach(r=>il(r,e,t,s));else{const r=pe(n.handler)?n.handler.bind(t):e[n.handler];pe(r)&&Qe(i,r,n)}}function rl(n){const e=n.type,{mixins:t,extends:s}=e,{mixins:i,optionsCache:r,config:{optionMergeStrategies:a}}=n.appContext,o=r.get(e);let l;return o?l=o:!i.length&&!t&&!s?l=e:(l={},i.length&&i.forEach(c=>Mi(l,c,a,!0)),Mi(l,e,a)),Le(e)&&r.set(e,l),l}function Mi(n,e,t,s=!1){const{mixins:i,extends:r}=e;r&&Mi(n,r,t,!0),i&&i.forEach(a=>Mi(n,a,t,!0));for(const a in e)if(!(s&&a==="expose")){const o=eu[a]||t&&t[a];n[a]=o?o(n[a],e[a]):e[a]}return n}const eu={data:al,props:ol,emits:ol,methods:Os,computed:Os,beforeCreate:Je,created:Je,beforeMount:Je,mounted:Je,beforeUpdate:Je,updated:Je,beforeDestroy:Je,beforeUnmount:Je,destroyed:Je,unmounted:Je,activated:Je,deactivated:Je,errorCaptured:Je,serverPrefetch:Je,components:Os,directives:Os,watch:nu,provide:al,inject:tu};function al(n,e){return e?n?function(){return Ge(pe(n)?n.call(this,this):n,pe(e)?e.call(this,this):e)}:e:n}function tu(n,e){return Os(Yr(n),Yr(e))}function Yr(n){if(de(n)){const e={};for(let t=0;t<n.length;t++)e[n[t]]=n[t];return e}return n}function Je(n,e){return n?[...new Set([].concat(n,e))]:e}function Os(n,e){return n?Ge(Object.create(null),n,e):e}function ol(n,e){return n?de(n)&&de(e)?[...new Set([...n,...e])]:Ge(Object.create(null),nl(n),nl(e??{})):e}function nu(n,e){if(!n)return e;if(!e)return n;const t=Ge(Object.create(null),n);for(const s in e)t[s]=Je(n[s],e[s]);return t}function ll(){return{app:null,config:{isNativeTag:to,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let su=0;function iu(n,e){return function(s,i=null){pe(s)||(s=Ge({},s)),i!=null&&!Le(i)&&(i=null);const r=ll(),a=new WeakSet,o=[];let l=!1;const c=r.app={_uid:su++,_component:s,_props:i,_container:null,_context:r,_instance:null,version:Wu,get config(){return r.config},set config(d){},use(d,...h){return a.has(d)||(d&&pe(d.install)?(a.add(d),d.install(c,...h)):pe(d)&&(a.add(d),d(c,...h))),c},mixin(d){return r.mixins.includes(d)||r.mixins.push(d),c},component(d,h){return h?(r.components[d]=h,c):r.components[d]},directive(d,h){return h?(r.directives[d]=h,c):r.directives[d]},mount(d,h,u){if(!l){const f=c._ceVNode||We(s,i);return f.appContext=r,u===!0?u="svg":u===!1&&(u=void 0),n(f,d,u),l=!0,c._container=d,d.__vue_app__=c,Fi(f.component)}},onUnmount(d){o.push(d)},unmount(){l&&(Tt(o,c._instance,16),n(null,c._container),delete c._container.__vue_app__)},provide(d,h){return r.provides[d]=h,c},runWithContext(d){const h=os;os=c;try{return d()}finally{os=h}}};return c}}let os=null;function un(n,e){if(tt){let t=tt.provides;const s=tt.parent&&tt.parent.provides;s===t&&(t=tt.provides=Object.create(s)),t[n]=e}}function Mt(n,e,t=!1){const s=ea();if(s||os){let i=os?os._context.provides:s?s.parent==null||s.ce?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:void 0;if(i&&n in i)return i[n];if(arguments.length>1)return t&&pe(e)?e.call(s&&s.proxy):e}}const ru=Symbol.for("v-scx"),au=()=>Mt(ru);function Qe(n,e,t){return cl(n,e,t)}function cl(n,e,t=Ee){const{immediate:s,deep:i,flush:r,once:a}=t,o=Ge({},t),l=e&&s||!e&&r!=="post";let c;if(Gs){if(r==="sync"){const f=au();c=f.__watcherHandles||(f.__watcherHandles=[])}else if(!l){const f=()=>{};return f.stop=wt,f.resume=wt,f.pause=wt,f}}const d=tt;o.call=(f,p,m)=>Tt(f,d,p,m);let h=!1;r==="post"?o.scheduler=f=>{et(f,d&&d.suspense)}:r!=="sync"&&(h=!0,o.scheduler=(f,p)=>{p?f():$r(f)}),o.augmentJob=f=>{e&&(f.flags|=4),h&&(f.flags|=2,d&&(f.id=d.uid,f.i=d))};const u=Ah(n,e,o);return Gs&&(c?c.push(u):l&&u()),u}function ou(n,e,t){const s=this.proxy,i=Fe(n)?n.includes(".")?dl(s,n):()=>s[n]:n.bind(s,s);let r;pe(e)?r=e:(r=e.handler,t=e);const a=Ds(this),o=cl(i,r.bind(s),t);return a(),o}function dl(n,e){const t=e.split(".");return()=>{let s=n;for(let i=0;i<t.length&&s;i++)s=s[t[i]];return s}}const lu=(n,e)=>e==="modelValue"||e==="model-value"?n.modelModifiers:n[`${e}Modifiers`]||n[`${xt(e)}Modifiers`]||n[`${pt(e)}Modifiers`];function cu(n,e,...t){if(n.isUnmounted)return;const s=n.vnode.props||Ee;let i=t;const r=e.startsWith("update:"),a=r&&lu(s,e.slice(7));a&&(a.trim&&(i=t.map(d=>Fe(d)?d.trim():d)),a.number&&(i=t.map(kr)));let o,l=s[o=Sr(e)]||s[o=Sr(xt(e))];!l&&r&&(l=s[o=Sr(pt(e))]),l&&Tt(l,n,6,i);const c=s[o+"Once"];if(c){if(!n.emitted)n.emitted={};else if(n.emitted[o])return;n.emitted[o]=!0,Tt(c,n,6,i)}}const du=new WeakMap;function hl(n,e,t=!1){const s=t?du:e.emitsCache,i=s.get(n);if(i!==void 0)return i;const r=n.emits;let a={},o=!1;if(!pe(n)){const l=c=>{const d=hl(c,e,!0);d&&(o=!0,Ge(a,d))};!t&&e.mixins.length&&e.mixins.forEach(l),n.extends&&l(n.extends),n.mixins&&n.mixins.forEach(l)}return!r&&!o?(Le(n)&&s.set(n,null),null):(de(r)?r.forEach(l=>a[l]=null):Ge(a,r),Le(n)&&s.set(n,a),a)}function Oi(n,e){return!n||!di(e)?!1:(e=e.slice(2).replace(/Once$/,""),ke(n,e[0].toLowerCase()+e.slice(1))||ke(n,pt(e))||ke(n,e))}function dm(){}function ul(n){const{type:e,vnode:t,proxy:s,withProxy:i,propsOptions:[r],slots:a,attrs:o,emit:l,render:c,renderCache:d,props:h,data:u,setupState:f,ctx:p,inheritAttrs:m}=n,v=Ti(n);let S,k;try{if(t.shapeFlag&4){const _=i||s,C=_;S=Ot(c.call(C,_,d,h,f,u,p)),k=o}else{const _=e;S=Ot(_.length>1?_(h,{attrs:o,slots:a,emit:l}):_(h,null)),k=e.props?o:hu(o)}}catch(_){Ns.length=0,ki(_,n,1),S=We(Kt)}let b=S;if(k&&m!==!1){const _=Object.keys(k),{shapeFlag:C}=b;_.length&&C&7&&(r&&_.some(br)&&(k=uu(k,r)),b=Bn(b,k,!1,!0))}return t.dirs&&(b=Bn(b,null,!1,!0),b.dirs=b.dirs?b.dirs.concat(t.dirs):t.dirs),t.transition&&Rs(b,t.transition),S=b,Ti(v),S}const hu=n=>{let e;for(const t in n)(t==="class"||t==="style"||di(t))&&((e||(e={}))[t]=n[t]);return e},uu=(n,e)=>{const t={};for(const s in n)(!br(s)||!(s.slice(9)in e))&&(t[s]=n[s]);return t};function fu(n,e,t){const{props:s,children:i,component:r}=n,{props:a,children:o,patchFlag:l}=e,c=r.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&l>=0){if(l&1024)return!0;if(l&16)return s?fl(s,a,c):!!a;if(l&8){const d=e.dynamicProps;for(let h=0;h<d.length;h++){const u=d[h];if(a[u]!==s[u]&&!Oi(c,u))return!0}}}else return(i||o)&&(!o||!o.$stable)?!0:s===a?!1:s?a?fl(s,a,c):!0:!!a;return!1}function fl(n,e,t){const s=Object.keys(e);if(s.length!==Object.keys(n).length)return!0;for(let i=0;i<s.length;i++){const r=s[i];if(e[r]!==n[r]&&!Oi(t,r))return!0}return!1}function pu({vnode:n,parent:e},t){for(;e;){const s=e.subTree;if(s.suspense&&s.suspense.activeBranch===n&&(s.el=n.el),s===n)(n=e.vnode).el=t,e=e.parent;else break}}const pl={},gl=()=>Object.create(pl),ml=n=>Object.getPrototypeOf(n)===pl;function gu(n,e,t,s=!1){const i={},r=gl();n.propsDefaults=Object.create(null),_l(n,e,i,r);for(const a in n.propsOptions[0])a in i||(i[a]=void 0);t?n.props=s?i:bh(i):n.type.props?n.props=i:n.props=r,n.attrs=r}function mu(n,e,t,s){const{props:i,attrs:r,vnode:{patchFlag:a}}=n,o=xe(i),[l]=n.propsOptions;let c=!1;if((s||a>0)&&!(a&16)){if(a&8){const d=n.vnode.dynamicProps;for(let h=0;h<d.length;h++){let u=d[h];if(Oi(n.emitsOptions,u))continue;const f=e[u];if(l)if(ke(r,u))f!==r[u]&&(r[u]=f,c=!0);else{const p=xt(u);i[p]=Xr(l,o,p,f,n,!1)}else f!==r[u]&&(r[u]=f,c=!0)}}}else{_l(n,e,i,r)&&(c=!0);let d;for(const h in o)(!e||!ke(e,h)&&((d=pt(h))===h||!ke(e,d)))&&(l?t&&(t[h]!==void 0||t[d]!==void 0)&&(i[h]=Xr(l,o,h,void 0,n,!0)):delete i[h]);if(r!==o)for(const h in r)(!e||!ke(e,h))&&(delete r[h],c=!0)}c&&Ut(n.attrs,"set","")}function _l(n,e,t,s){const[i,r]=n.propsOptions;let a=!1,o;if(e)for(let l in e){if(bs(l))continue;const c=e[l];let d;i&&ke(i,d=xt(l))?!r||!r.includes(d)?t[d]=c:(o||(o={}))[d]=c:Oi(n.emitsOptions,l)||(!(l in s)||c!==s[l])&&(s[l]=c,a=!0)}if(r){const l=xe(t),c=o||Ee;for(let d=0;d<r.length;d++){const h=r[d];t[h]=Xr(i,l,h,c[h],n,!ke(c,h))}}return a}function Xr(n,e,t,s,i,r){const a=n[t];if(a!=null){const o=ke(a,"default");if(o&&s===void 0){const l=a.default;if(a.type!==Function&&!a.skipFactory&&pe(l)){const{propsDefaults:c}=i;if(t in c)s=c[t];else{const d=Ds(i);s=c[t]=l.call(null,e),d()}}else s=l;i.ce&&i.ce._setProp(t,s)}a[0]&&(r&&!o?s=!1:a[1]&&(s===""||s===pt(t))&&(s=!0))}return s}const _u=new WeakMap;function vl(n,e,t=!1){const s=t?_u:e.propsCache,i=s.get(n);if(i)return i;const r=n.props,a={},o=[];let l=!1;if(!pe(n)){const d=h=>{l=!0;const[u,f]=vl(h,e,!0);Ge(a,u),f&&o.push(...f)};!t&&e.mixins.length&&e.mixins.forEach(d),n.extends&&d(n.extends),n.mixins&&n.mixins.forEach(d)}if(!r&&!l)return Le(n)&&s.set(n,es),es;if(de(r))for(let d=0;d<r.length;d++){const h=xt(r[d]);yl(h)&&(a[h]=Ee)}else if(r)for(const d in r){const h=xt(d);if(yl(h)){const u=r[d],f=a[h]=de(u)||pe(u)?{type:u}:Ge({},u),p=f.type;let m=!1,v=!0;if(de(p))for(let S=0;S<p.length;++S){const k=p[S],b=pe(k)&&k.name;if(b==="Boolean"){m=!0;break}else b==="String"&&(v=!1)}else m=pe(p)&&p.name==="Boolean";f[0]=m,f[1]=v,(m||ke(f,"default"))&&o.push(h)}}const c=[a,o];return Le(n)&&s.set(n,c),c}function yl(n){return n[0]!=="$"&&!bs(n)}const Kr=n=>n==="_"||n==="_ctx"||n==="$stable",Zr=n=>de(n)?n.map(Ot):[Ot(n)],vu=(n,e,t)=>{if(e._n)return e;const s=$o((...i)=>Zr(e(...i)),t);return s._c=!1,s},bl=(n,e,t)=>{const s=n._ctx;for(const i in n){if(Kr(i))continue;const r=n[i];if(pe(r))e[i]=vu(i,r,s);else if(r!=null){const a=Zr(r);e[i]=()=>a}}},wl=(n,e)=>{const t=Zr(e);n.slots.default=()=>t},xl=(n,e,t)=>{for(const s in e)(t||!Kr(s))&&(n[s]=e[s])},yu=(n,e,t)=>{const s=n.slots=gl();if(n.vnode.shapeFlag&32){const i=e._;i?(xl(s,e,t),t&&ao(s,"_",i,!0)):bl(e,s)}else e&&wl(n,e)},bu=(n,e,t)=>{const{vnode:s,slots:i}=n;let r=!0,a=Ee;if(s.shapeFlag&32){const o=e._;o?t&&o===1?r=!1:xl(i,e,t):(r=!e.$stable,bl(e,i)),a=e}else e&&(wl(n,e),a={default:1});if(r)for(const o in i)!Kr(o)&&a[o]==null&&delete i[o]},et=Cu;function wu(n){return xu(n)}function xu(n,e){const t=gi();t.__VUE__=!0;const{insert:s,remove:i,patchProp:r,createElement:a,createText:o,createComment:l,setText:c,setElementText:d,parentNode:h,nextSibling:u,setScopeId:f=wt,insertStaticContent:p}=n,m=(x,T,N,V=null,F=null,H=null,Q=void 0,q=null,Z=!!T.dynamicChildren)=>{if(x===T)return;x&&!ls(x,T)&&(V=an(x),ie(x,F,H,!0),x=null),T.patchFlag===-2&&(Z=!1,T.dynamicChildren=null);const{type:$,ref:ce,shapeFlag:te}=T;switch($){case Ni:v(x,T,N,V);break;case Kt:S(x,T,N,V);break;case Li:x==null&&k(T,N,V,Q);break;case He:g(x,T,N,V,F,H,Q,q,Z);break;default:te&1?C(x,T,N,V,F,H,Q,q,Z):te&6?w(x,T,N,V,F,H,Q,q,Z):(te&64||te&128)&&$.process(x,T,N,V,F,H,Q,q,Z,li)}ce!=null&&F?Is(ce,x&&x.ref,H,T||x,!T):ce==null&&x&&x.ref!=null&&Is(x.ref,null,H,x,!0)},v=(x,T,N,V)=>{if(x==null)s(T.el=o(T.children),N,V);else{const F=T.el=x.el;T.children!==x.children&&c(F,T.children)}},S=(x,T,N,V)=>{x==null?s(T.el=l(T.children||""),N,V):T.el=x.el},k=(x,T,N,V)=>{[x.el,x.anchor]=p(x.children,T,N,V,x.el,x.anchor)},b=({el:x,anchor:T},N,V)=>{let F;for(;x&&x!==T;)F=u(x),s(x,N,V),x=F;s(T,N,V)},_=({el:x,anchor:T})=>{let N;for(;x&&x!==T;)N=u(x),i(x),x=N;i(T)},C=(x,T,N,V,F,H,Q,q,Z)=>{if(T.type==="svg"?Q="svg":T.type==="math"&&(Q="mathml"),x==null)A(T,N,V,F,H,Q,q,Z);else{const $=x.el&&x.el._isVueCE?x.el:null;try{$&&$._beginPatch(),I(x,T,F,H,Q,q,Z)}finally{$&&$._endPatch()}}},A=(x,T,N,V,F,H,Q,q)=>{let Z,$;const{props:ce,shapeFlag:te,transition:oe,dirs:fe}=x;if(Z=x.el=a(x.type,H,ce&&ce.is,ce),te&8?d(Z,x.children):te&16&&O(x.children,Z,null,V,F,qr(x,H),Q,q),fe&&Dn(x,null,V,"created"),L(Z,x,x.scopeId,Q,V),ce){for(const Ne in ce)Ne!=="value"&&!bs(Ne)&&r(Z,Ne,null,ce[Ne],H,V);"value"in ce&&r(Z,"value",null,ce.value,H),($=ce.onVnodeBeforeMount)&&Nt($,V,x)}fe&&Dn(x,null,V,"beforeMount");const we=Su(F,oe);we&&oe.beforeEnter(Z),s(Z,T,N),(($=ce&&ce.onVnodeMounted)||we||fe)&&et(()=>{$&&Nt($,V,x),we&&oe.enter(Z),fe&&Dn(x,null,V,"mounted")},F)},L=(x,T,N,V,F)=>{if(N&&f(x,N),V)for(let H=0;H<V.length;H++)f(x,V[H]);if(F){let H=F.subTree;if(T===H||Cl(H.type)&&(H.ssContent===T||H.ssFallback===T)){const Q=F.vnode;L(x,Q,Q.scopeId,Q.slotScopeIds,F.parent)}}},O=(x,T,N,V,F,H,Q,q,Z=0)=>{for(let $=Z;$<x.length;$++){const ce=x[$]=q?pn(x[$]):Ot(x[$]);m(null,ce,T,N,V,F,H,Q,q)}},I=(x,T,N,V,F,H,Q)=>{const q=T.el=x.el;let{patchFlag:Z,dynamicChildren:$,dirs:ce}=T;Z|=x.patchFlag&16;const te=x.props||Ee,oe=T.props||Ee;let fe;if(N&&Fn(N,!1),(fe=oe.onVnodeBeforeUpdate)&&Nt(fe,N,T,x),ce&&Dn(T,x,N,"beforeUpdate"),N&&Fn(N,!0),(te.innerHTML&&oe.innerHTML==null||te.textContent&&oe.textContent==null)&&d(q,""),$?W(x.dynamicChildren,$,q,N,V,qr(T,F),H):Q||G(x,T,q,null,N,V,qr(T,F),H,!1),Z>0){if(Z&16)K(q,te,oe,N,F);else if(Z&2&&te.class!==oe.class&&r(q,"class",null,oe.class,F),Z&4&&r(q,"style",te.style,oe.style,F),Z&8){const we=T.dynamicProps;for(let Ne=0;Ne<we.length;Ne++){const Te=we[Ne],rt=te[Te],at=oe[Te];(at!==rt||Te==="value")&&r(q,Te,rt,at,F,N)}}Z&1&&x.children!==T.children&&d(q,T.children)}else!Q&&$==null&&K(q,te,oe,N,F);((fe=oe.onVnodeUpdated)||ce)&&et(()=>{fe&&Nt(fe,N,T,x),ce&&Dn(T,x,N,"updated")},V)},W=(x,T,N,V,F,H,Q)=>{for(let q=0;q<T.length;q++){const Z=x[q],$=T[q],ce=Z.el&&(Z.type===He||!ls(Z,$)||Z.shapeFlag&198)?h(Z.el):N;m(Z,$,ce,null,V,F,H,Q,!0)}},K=(x,T,N,V,F)=>{if(T!==N){if(T!==Ee)for(const H in T)!bs(H)&&!(H in N)&&r(x,H,T[H],null,F,V);for(const H in N){if(bs(H))continue;const Q=N[H],q=T[H];Q!==q&&H!=="value"&&r(x,H,q,Q,F,V)}"value"in N&&r(x,"value",T.value,N.value,F)}},g=(x,T,N,V,F,H,Q,q,Z)=>{const $=T.el=x?x.el:o(""),ce=T.anchor=x?x.anchor:o("");let{patchFlag:te,dynamicChildren:oe,slotScopeIds:fe}=T;fe&&(q=q?q.concat(fe):fe),x==null?(s($,N,V),s(ce,N,V),O(T.children||[],N,ce,F,H,Q,q,Z)):te>0&&te&64&&oe&&x.dynamicChildren?(W(x.dynamicChildren,oe,N,F,H,Q,q),(T.key!=null||F&&T===F.subTree)&&Jr(x,T,!0)):G(x,T,N,ce,F,H,Q,q,Z)},w=(x,T,N,V,F,H,Q,q,Z)=>{T.slotScopeIds=q,x==null?T.shapeFlag&512?F.ctx.activate(T,N,V,Q,Z):R(T,N,V,F,H,Q,Z):P(x,T,Z)},R=(x,T,N,V,F,H,Q)=>{const q=x.component=Ou(x,V,F);if(qo(x)&&(q.ctx.renderer=li),Nu(q,!1,Q),q.asyncDep){if(F&&F.registerDep(q,M,Q),!x.el){const Z=q.subTree=We(Kt);S(null,Z,T,N),x.placeholder=Z.el}}else M(q,x,T,N,F,H,Q)},P=(x,T,N)=>{const V=T.component=x.component;if(fu(x,T,N))if(V.asyncDep&&!V.asyncResolved){D(V,T,N);return}else V.next=T,V.update();else T.el=x.el,V.vnode=T},M=(x,T,N,V,F,H,Q)=>{const q=()=>{if(x.isMounted){let{next:te,bu:oe,u:fe,parent:we,vnode:Ne}=x;{const $t=Sl(x);if($t){te&&(te.el=Ne.el,D(x,te,Q)),$t.asyncDep.then(()=>{x.isUnmounted||q()});return}}let Te=te,rt;Fn(x,!1),te?(te.el=Ne.el,D(x,te,Q)):te=Ne,oe&&pi(oe),(rt=te.props&&te.props.onVnodeBeforeUpdate)&&Nt(rt,we,te,Ne),Fn(x,!0);const at=ul(x),Ht=x.subTree;x.subTree=at,m(Ht,at,h(Ht.el),an(Ht),x,F,H),te.el=at.el,Te===null&&pu(x,at.el),fe&&et(fe,F),(rt=te.props&&te.props.onVnodeUpdated)&&et(()=>Nt(rt,we,te,Ne),F)}else{let te;const{el:oe,props:fe}=T,{bm:we,m:Ne,parent:Te,root:rt,type:at}=x,Ht=Ps(T);Fn(x,!1),we&&pi(we),!Ht&&(te=fe&&fe.onVnodeBeforeMount)&&Nt(te,Te,T),Fn(x,!0);{rt.ce&&rt.ce._def.shadowRoot!==!1&&rt.ce._injectChildStyle(at);const $t=x.subTree=ul(x);m(null,$t,N,V,x,F,H),T.el=$t.el}if(Ne&&et(Ne,F),!Ht&&(te=fe&&fe.onVnodeMounted)){const $t=T;et(()=>Nt(te,Te,$t),F)}(T.shapeFlag&256||Te&&Ps(Te.vnode)&&Te.vnode.shapeFlag&256)&&x.a&&et(x.a,F),x.isMounted=!0,T=N=V=null}};x.scope.on();const Z=x.effect=new uo(q);x.scope.off();const $=x.update=Z.run.bind(Z),ce=x.job=Z.runIfDirty.bind(Z);ce.i=x,ce.id=x.uid,Z.scheduler=()=>$r(ce),Fn(x,!0),$()},D=(x,T,N)=>{T.component=x;const V=x.vnode.props;x.vnode=T,x.next=null,mu(x,T.props,V,N),bu(x,T.children,N),At(),Go(x),Rt()},G=(x,T,N,V,F,H,Q,q,Z=!1)=>{const $=x&&x.children,ce=x?x.shapeFlag:0,te=T.children,{patchFlag:oe,shapeFlag:fe}=T;if(oe>0){if(oe&128){ae($,te,N,V,F,H,Q,q,Z);return}else if(oe&256){J($,te,N,V,F,H,Q,q,Z);return}}fe&8?(ce&16&&Bt($,F,H),te!==$&&d(N,te)):ce&16?fe&16?ae($,te,N,V,F,H,Q,q,Z):Bt($,F,H,!0):(ce&8&&d(N,""),fe&16&&O(te,N,V,F,H,Q,q,Z))},J=(x,T,N,V,F,H,Q,q,Z)=>{x=x||es,T=T||es;const $=x.length,ce=T.length,te=Math.min($,ce);let oe;for(oe=0;oe<te;oe++){const fe=T[oe]=Z?pn(T[oe]):Ot(T[oe]);m(x[oe],fe,N,null,F,H,Q,q,Z)}$>ce?Bt(x,F,H,!0,!1,te):O(T,N,V,F,H,Q,q,Z,te)},ae=(x,T,N,V,F,H,Q,q,Z)=>{let $=0;const ce=T.length;let te=x.length-1,oe=ce-1;for(;$<=te&&$<=oe;){const fe=x[$],we=T[$]=Z?pn(T[$]):Ot(T[$]);if(ls(fe,we))m(fe,we,N,null,F,H,Q,q,Z);else break;$++}for(;$<=te&&$<=oe;){const fe=x[te],we=T[oe]=Z?pn(T[oe]):Ot(T[oe]);if(ls(fe,we))m(fe,we,N,null,F,H,Q,q,Z);else break;te--,oe--}if($>te){if($<=oe){const fe=oe+1,we=fe<ce?T[fe].el:V;for(;$<=oe;)m(null,T[$]=Z?pn(T[$]):Ot(T[$]),N,we,F,H,Q,q,Z),$++}}else if($>oe)for(;$<=te;)ie(x[$],F,H,!0),$++;else{const fe=$,we=$,Ne=new Map;for($=we;$<=oe;$++){const ft=T[$]=Z?pn(T[$]):Ot(T[$]);ft.key!=null&&Ne.set(ft.key,$)}let Te,rt=0;const at=oe-we+1;let Ht=!1,$t=0;const ci=new Array(at);for($=0;$<at;$++)ci[$]=0;for($=fe;$<=te;$++){const ft=x[$];if(rt>=at){ie(ft,F,H,!0);continue}let Wt;if(ft.key!=null)Wt=Ne.get(ft.key);else for(Te=we;Te<=oe;Te++)if(ci[Te-we]===0&&ls(ft,T[Te])){Wt=Te;break}Wt===void 0?ie(ft,F,H,!0):(ci[Wt-we]=$+1,Wt>=$t?$t=Wt:Ht=!0,m(ft,T[Wt],N,null,F,H,Q,q,Z),rt++)}const $d=Ht?ku(ci):es;for(Te=$d.length-1,$=at-1;$>=0;$--){const ft=we+$,Wt=T[ft],Wd=T[ft+1],Ud=ft+1<ce?Wd.el||Wd.placeholder:V;ci[$]===0?m(null,Wt,N,Ud,F,H,Q,q,Z):Ht&&(Te<0||$!==$d[Te]?ne(Wt,N,Ud,2):Te--)}}},ne=(x,T,N,V,F=null)=>{const{el:H,type:Q,transition:q,children:Z,shapeFlag:$}=x;if($&6){ne(x.component.subTree,T,N,V);return}if($&128){x.suspense.move(T,N,V);return}if($&64){Q.move(x,T,N,li);return}if(Q===He){s(H,T,N);for(let te=0;te<Z.length;te++)ne(Z[te],T,N,V);s(x.anchor,T,N);return}if(Q===Li){b(x,T,N);return}if(V!==2&&$&1&&q)if(V===0)q.beforeEnter(H),s(H,T,N),et(()=>q.enter(H),F);else{const{leave:te,delayLeave:oe,afterLeave:fe}=q,we=()=>{x.ctx.isUnmounted?i(H):s(H,T,N)},Ne=()=>{H._isLeaving&&H[Gn](!0),te(H,()=>{we(),fe&&fe()})};oe?oe(H,we,Ne):Ne()}else s(H,T,N)},ie=(x,T,N,V=!1,F=!1)=>{const{type:H,props:Q,ref:q,children:Z,dynamicChildren:$,shapeFlag:ce,patchFlag:te,dirs:oe,cacheIndex:fe}=x;if(te===-2&&(F=!1),q!=null&&(At(),Is(q,null,N,x,!0),Rt()),fe!=null&&(T.renderCache[fe]=void 0),ce&256){T.ctx.deactivate(x);return}const we=ce&1&&oe,Ne=!Ps(x);let Te;if(Ne&&(Te=Q&&Q.onVnodeBeforeUnmount)&&Nt(Te,T,x),ce&6)In(x.component,N,V);else{if(ce&128){x.suspense.unmount(N,V);return}we&&Dn(x,null,T,"beforeUnmount"),ce&64?x.type.remove(x,T,N,li,V):$&&!$.hasOnce&&(H!==He||te>0&&te&64)?Bt($,T,N,!1,!0):(H===He&&te&384||!F&&ce&16)&&Bt(Z,T,N),V&&Re(x)}(Ne&&(Te=Q&&Q.onVnodeUnmounted)||we)&&et(()=>{Te&&Nt(Te,T,x),we&&Dn(x,null,T,"unmounted")},N)},Re=x=>{const{type:T,el:N,anchor:V,transition:F}=x;if(T===He){Qn(N,V);return}if(T===Li){_(x);return}const H=()=>{i(N),F&&!F.persisted&&F.afterLeave&&F.afterLeave()};if(x.shapeFlag&1&&F&&!F.persisted){const{leave:Q,delayLeave:q}=F,Z=()=>Q(N,H);q?q(x.el,H,Z):Z()}else H()},Qn=(x,T)=>{let N;for(;x!==T;)N=u(x),i(x),x=N;i(T)},In=(x,T,N)=>{const{bum:V,scope:F,job:H,subTree:Q,um:q,m:Z,a:$}=x;kl(Z),kl($),V&&pi(V),F.stop(),H&&(H.flags|=8,ie(Q,x,T,N)),q&&et(q,T),et(()=>{x.isUnmounted=!0},T)},Bt=(x,T,N,V=!1,F=!1,H=0)=>{for(let Q=H;Q<x.length;Q++)ie(x[Q],T,N,V,F)},an=x=>{if(x.shapeFlag&6)return an(x.component.subTree);if(x.shapeFlag&128)return x.suspense.next();const T=u(x.anchor||x.el),N=T&&T[Wo];return N?u(N):T};let Xe=!1;const _r=(x,T,N)=>{x==null?T._vnode&&ie(T._vnode,null,null,!0):m(T._vnode||null,x,T,null,null,null,N),T._vnode=x,Xe||(Xe=!0,Go(),Fo(),Xe=!1)},li={p:m,um:ie,m:ne,r:Re,mt:R,mc:O,pc:G,pbc:W,n:an,o:n};return{render:_r,hydrate:void 0,createApp:iu(_r)}}function qr({type:n,props:e},t){return t==="svg"&&n==="foreignObject"||t==="mathml"&&n==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:t}function Fn({effect:n,job:e},t){t?(n.flags|=32,e.flags|=4):(n.flags&=-33,e.flags&=-5)}function Su(n,e){return(!n||n&&!n.pendingBranch)&&e&&!e.persisted}function Jr(n,e,t=!1){const s=n.children,i=e.children;if(de(s)&&de(i))for(let r=0;r<s.length;r++){const a=s[r];let o=i[r];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=i[r]=pn(i[r]),o.el=a.el),!t&&o.patchFlag!==-2&&Jr(a,o)),o.type===Ni&&o.patchFlag!==-1&&(o.el=a.el),o.type===Kt&&!o.el&&(o.el=a.el)}}function ku(n){const e=n.slice(),t=[0];let s,i,r,a,o;const l=n.length;for(s=0;s<l;s++){const c=n[s];if(c!==0){if(i=t[t.length-1],n[i]<c){e[s]=i,t.push(s);continue}for(r=0,a=t.length-1;r<a;)o=r+a>>1,n[t[o]]<c?r=o+1:a=o;c<n[t[r]]&&(r>0&&(e[s]=t[r-1]),t[r]=s)}}for(r=t.length,a=t[r-1];r-- >0;)t[r]=a,a=e[a];return t}function Sl(n){const e=n.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:Sl(e)}function kl(n){if(n)for(let e=0;e<n.length;e++)n[e].flags|=8}const Cl=n=>n.__isSuspense;function Cu(n,e){e&&e.pendingBranch?de(n)?e.effects.push(...n):e.effects.push(n):Do(n)}const He=Symbol.for("v-fgt"),Ni=Symbol.for("v-txt"),Kt=Symbol.for("v-cmt"),Li=Symbol.for("v-stc"),Ns=[];let ot=null;function le(n=!1){Ns.push(ot=n?null:[])}function Tu(){Ns.pop(),ot=Ns[Ns.length-1]||null}let Ls=1;function Tl(n,e=!1){Ls+=n,n<0&&ot&&e&&(ot.hasOnce=!0)}function El(n){return n.dynamicChildren=Ls>0?ot||es:null,Tu(),Ls>0&&ot&&ot.push(n),n}function ge(n,e,t,s,i,r){return El(U(n,e,t,s,i,r,!0))}function fn(n,e,t,s,i){return El(We(n,e,t,s,i,!0))}function Al(n){return n?n.__v_isVNode===!0:!1}function ls(n,e){return n.type===e.type&&n.key===e.key}const Rl=({key:n})=>n??null,Di=({ref:n,ref_key:e,ref_for:t})=>(typeof n=="number"&&(n=""+n),n!=null?Fe(n)||Ke(n)||pe(n)?{i:mt,r:n,k:e,f:!!t}:n:null);function U(n,e=null,t=null,s=0,i=null,r=n===He?0:1,a=!1,o=!1){const l={__v_isVNode:!0,__v_skip:!0,type:n,props:e,key:e&&Rl(e),ref:e&&Di(e),scopeId:Ho,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:s,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:mt};return o?(Qr(l,t),r&128&&n.normalize(l)):t&&(l.shapeFlag|=Fe(t)?8:16),Ls>0&&!a&&ot&&(l.patchFlag>0||r&6)&&l.patchFlag!==32&&ot.push(l),l}const We=Eu;function Eu(n,e=null,t=null,s=0,i=null,r=!1){if((!n||n===Zh)&&(n=Kt),Al(n)){const o=Bn(n,e,!0);return t&&Qr(o,t),Ls>0&&!r&&ot&&(o.shapeFlag&6?ot[ot.indexOf(n)]=o:ot.push(o)),o.patchFlag=-2,o}if($u(n)&&(n=n.__vccOpts),e){e=Au(e);let{class:o,style:l}=e;o&&!Fe(o)&&(e.class=Mn(o)),Le(l)&&(Br(l)&&!de(l)&&(l=Ge({},l)),e.style=Pn(l))}const a=Fe(n)?1:Cl(n)?128:Dh(n)?64:Le(n)?4:pe(n)?2:0;return U(n,e,t,s,i,a,r,!0)}function Au(n){return n?Br(n)||ml(n)?Ge({},n):n:null}function Bn(n,e,t=!1,s=!1){const{props:i,ref:r,patchFlag:a,children:o,transition:l}=n,c=e?Iu(i||{},e):i,d={__v_isVNode:!0,__v_skip:!0,type:n.type,props:c,key:c&&Rl(c),ref:e&&e.ref?t&&r?de(r)?r.concat(Di(e)):[r,Di(e)]:Di(e):r,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:o,target:n.target,targetStart:n.targetStart,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:e&&n.type!==He?a===-1?16:a|16:a,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:l,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&Bn(n.ssContent),ssFallback:n.ssFallback&&Bn(n.ssFallback),placeholder:n.placeholder,el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce};return l&&s&&Rs(d,l.clone(d)),d}function Ru(n=" ",e=0){return We(Ni,null,n,e)}function Ue(n="",e=!1){return e?(le(),fn(Kt,null,n)):We(Kt,null,n)}function Ot(n){return n==null||typeof n=="boolean"?We(Kt):de(n)?We(He,null,n.slice()):Al(n)?pn(n):We(Ni,null,String(n))}function pn(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:Bn(n)}function Qr(n,e){let t=0;const{shapeFlag:s}=n;if(e==null)e=null;else if(de(e))t=16;else if(typeof e=="object")if(s&65){const i=e.default;i&&(i._c&&(i._d=!1),Qr(n,i()),i._c&&(i._d=!0));return}else{t=32;const i=e._;!i&&!ml(e)?e._ctx=mt:i===3&&mt&&(mt.slots._===1?e._=1:(e._=2,n.patchFlag|=1024))}else pe(e)?(e={default:e,_ctx:mt},t=32):(e=String(e),s&64?(t=16,e=[Ru(e)]):t=8);n.children=e,n.shapeFlag|=t}function Iu(...n){const e={};for(let t=0;t<n.length;t++){const s=n[t];for(const i in s)if(i==="class")e.class!==s.class&&(e.class=Mn([e.class,s.class]));else if(i==="style")e.style=Pn([e.style,s.style]);else if(di(i)){const r=e[i],a=s[i];a&&r!==a&&!(de(r)&&r.includes(a))&&(e[i]=r?[].concat(r,a):a)}else i!==""&&(e[i]=s[i])}return e}function Nt(n,e,t,s=null){Tt(n,e,7,[t,s])}const Pu=ll();let Mu=0;function Ou(n,e,t){const s=n.type,i=(e?e.appContext:n.appContext)||Pu,r={uid:Mu++,vnode:n,type:s,parent:e,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new eh(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(i.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:vl(s,i),emitsOptions:hl(s,i),emit:null,emitted:null,propsDefaults:Ee,inheritAttrs:s.inheritAttrs,ctx:Ee,data:Ee,props:Ee,attrs:Ee,slots:Ee,refs:Ee,setupState:Ee,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=e?e.root:r,r.emit=cu.bind(null,r),n.ce&&n.ce(r),r}let tt=null;const ea=()=>tt||mt;let Gi,ta;{const n=gi(),e=(t,s)=>{let i;return(i=n[t])||(i=n[t]=[]),i.push(s),r=>{i.length>1?i.forEach(a=>a(r)):i[0](r)}};Gi=e("__VUE_INSTANCE_SETTERS__",t=>tt=t),ta=e("__VUE_SSR_SETTERS__",t=>Gs=t)}const Ds=n=>{const e=tt;return Gi(n),n.scope.on(),()=>{n.scope.off(),Gi(e)}},Il=()=>{tt&&tt.scope.off(),Gi(null)};function Pl(n){return n.vnode.shapeFlag&4}let Gs=!1;function Nu(n,e=!1,t=!1){e&&ta(e);const{props:s,children:i}=n.vnode,r=Pl(n);gu(n,s,r,e),yu(n,i,t||e);const a=r?Lu(n,e):void 0;return e&&ta(!1),a}function Lu(n,e){const t=n.type;n.accessCache=Object.create(null),n.proxy=new Proxy(n.ctx,qh);const{setup:s}=t;if(s){At();const i=n.setupContext=s.length>1?Gu(n):null,r=Ds(n),a=is(s,n,0,[n.props,i]),o=so(a);if(Rt(),r(),(o||n.sp)&&!Ps(n)&&Ko(n),o){if(a.then(Il,Il),e)return a.then(l=>{Ml(n,l)}).catch(l=>{ki(l,n,0)});n.asyncDep=a}else Ml(n,a)}else Ol(n)}function Ml(n,e,t){pe(e)?n.type.__ssrInlineRender?n.ssrRender=e:n.render=e:Le(e)&&(n.setupState=Po(e)),Ol(n)}function Ol(n,e,t){const s=n.type;n.render||(n.render=s.render||wt);{const i=Ds(n);At();try{Jh(n)}finally{Rt(),i()}}}const Du={get(n,e){return Ze(n,"get",""),n[e]}};function Gu(n){const e=t=>{n.exposed=t||{}};return{attrs:new Proxy(n.attrs,Du),slots:n.slots,emit:n.emit,expose:e}}function Fi(n){return n.exposed?n.exposeProxy||(n.exposeProxy=new Proxy(Po(wh(n.exposed)),{get(e,t){if(t in e)return e[t];if(t in Ms)return Ms[t](n)},has(e,t){return t in e||t in Ms}})):n.proxy}const Fu=/(?:^|[-_])\w/g,Bu=n=>n.replace(Fu,e=>e.toUpperCase()).replace(/[-_]/g,"");function Hu(n,e=!0){return pe(n)?n.displayName||n.name:n.name||e&&n.__name}function Nl(n,e,t=!1){let s=Hu(e);if(!s&&e.__file){const i=e.__file.match(/([^/\\]+)\.\w+$/);i&&(s=i[1])}if(!s&&n){const i=r=>{for(const a in r)if(r[a]===e)return a};s=i(n.components)||n.parent&&i(n.parent.type.components)||i(n.appContext.components)}return s?Bu(s):t?"App":"Anonymous"}function $u(n){return pe(n)&&"__vccOpts"in n}const Pe=(n,e)=>Th(n,e,Gs),Wu="3.5.25";let na;const Ll=typeof window<"u"&&window.trustedTypes;if(Ll)try{na=Ll.createPolicy("vue",{createHTML:n=>n})}catch{}const Dl=na?n=>na.createHTML(n):n=>n,Uu="http://www.w3.org/2000/svg",Vu="http://www.w3.org/1998/Math/MathML",Zt=typeof document<"u"?document:null,Gl=Zt&&Zt.createElement("template"),ju={insert:(n,e,t)=>{e.insertBefore(n,t||null)},remove:n=>{const e=n.parentNode;e&&e.removeChild(n)},createElement:(n,e,t,s)=>{const i=e==="svg"?Zt.createElementNS(Uu,n):e==="mathml"?Zt.createElementNS(Vu,n):t?Zt.createElement(n,{is:t}):Zt.createElement(n);return n==="select"&&s&&s.multiple!=null&&i.setAttribute("multiple",s.multiple),i},createText:n=>Zt.createTextNode(n),createComment:n=>Zt.createComment(n),setText:(n,e)=>{n.nodeValue=e},setElementText:(n,e)=>{n.textContent=e},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>Zt.querySelector(n),setScopeId(n,e){n.setAttribute(e,"")},insertStaticContent(n,e,t,s,i,r){const a=t?t.previousSibling:e.lastChild;if(i&&(i===r||i.nextSibling))for(;e.insertBefore(i.cloneNode(!0),t),!(i===r||!(i=i.nextSibling)););else{Gl.innerHTML=Dl(s==="svg"?`<svg>${n}</svg>`:s==="mathml"?`<math>${n}</math>`:n);const o=Gl.content;if(s==="svg"||s==="mathml"){const l=o.firstChild;for(;l.firstChild;)o.appendChild(l.firstChild);o.removeChild(l)}e.insertBefore(o,t)}return[a?a.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}},gn="transition",Fs="animation",cs=Symbol("_vtc"),Fl={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},zu=Ge({},Hh,Fl),Hn=(n,e=[])=>{de(n)?n.forEach(t=>t(...e)):n&&n(...e)},Bl=n=>n?de(n)?n.some(e=>e.length>1):n.length>1:!1;function Yu(n){const e={};for(const g in n)g in Fl||(e[g]=n[g]);if(n.css===!1)return e;const{name:t="v",type:s,duration:i,enterFromClass:r=`${t}-enter-from`,enterActiveClass:a=`${t}-enter-active`,enterToClass:o=`${t}-enter-to`,appearFromClass:l=r,appearActiveClass:c=a,appearToClass:d=o,leaveFromClass:h=`${t}-leave-from`,leaveActiveClass:u=`${t}-leave-active`,leaveToClass:f=`${t}-leave-to`}=n,p=Xu(i),m=p&&p[0],v=p&&p[1],{onBeforeEnter:S,onEnter:k,onEnterCancelled:b,onLeave:_,onLeaveCancelled:C,onBeforeAppear:A=S,onAppear:L=k,onAppearCancelled:O=b}=e,I=(g,w,R,P)=>{g._enterCancelled=P,mn(g,w?d:o),mn(g,w?c:a),R&&R()},W=(g,w)=>{g._isLeaving=!1,mn(g,h),mn(g,f),mn(g,u),w&&w()},K=g=>(w,R)=>{const P=g?L:k,M=()=>I(w,g,R);Hn(P,[w,M]),Hl(()=>{mn(w,g?l:r),Lt(w,g?d:o),Bl(P)||$l(w,s,m,M)})};return Ge(e,{onBeforeEnter(g){Hn(S,[g]),Lt(g,r),Lt(g,a)},onBeforeAppear(g){Hn(A,[g]),Lt(g,l),Lt(g,c)},onEnter:K(!1),onAppear:K(!0),onLeave(g,w){g._isLeaving=!0;const R=()=>W(g,w);Lt(g,h),g._enterCancelled?(Lt(g,u),ia(g)):(ia(g),Lt(g,u)),Hl(()=>{g._isLeaving&&(mn(g,h),Lt(g,f),Bl(_)||$l(g,s,v,R))}),Hn(_,[g,R])},onEnterCancelled(g){I(g,!1,void 0,!0),Hn(b,[g])},onAppearCancelled(g){I(g,!0,void 0,!0),Hn(O,[g])},onLeaveCancelled(g){W(g),Hn(C,[g])}})}function Xu(n){if(n==null)return null;if(Le(n))return[sa(n.enter),sa(n.leave)];{const e=sa(n);return[e,e]}}function sa(n){return Cr(n)}function Lt(n,e){e.split(/\s+/).forEach(t=>t&&n.classList.add(t)),(n[cs]||(n[cs]=new Set)).add(e)}function mn(n,e){e.split(/\s+/).forEach(s=>s&&n.classList.remove(s));const t=n[cs];t&&(t.delete(e),t.size||(n[cs]=void 0))}function Hl(n){requestAnimationFrame(()=>{requestAnimationFrame(n)})}let Ku=0;function $l(n,e,t,s){const i=n._endId=++Ku,r=()=>{i===n._endId&&s()};if(t!=null)return setTimeout(r,t);const{type:a,timeout:o,propCount:l}=Wl(n,e);if(!a)return s();const c=a+"end";let d=0;const h=()=>{n.removeEventListener(c,u),r()},u=f=>{f.target===n&&++d>=l&&h()};setTimeout(()=>{d<l&&h()},o+1),n.addEventListener(c,u)}function Wl(n,e){const t=window.getComputedStyle(n),s=p=>(t[p]||"").split(", "),i=s(`${gn}Delay`),r=s(`${gn}Duration`),a=Ul(i,r),o=s(`${Fs}Delay`),l=s(`${Fs}Duration`),c=Ul(o,l);let d=null,h=0,u=0;e===gn?a>0&&(d=gn,h=a,u=r.length):e===Fs?c>0&&(d=Fs,h=c,u=l.length):(h=Math.max(a,c),d=h>0?a>c?gn:Fs:null,u=d?d===gn?r.length:l.length:0);const f=d===gn&&/\b(?:transform|all)(?:,|$)/.test(s(`${gn}Property`).toString());return{type:d,timeout:h,propCount:u,hasTransform:f}}function Ul(n,e){for(;n.length<e.length;)n=n.concat(n);return Math.max(...e.map((t,s)=>Vl(t)+Vl(n[s])))}function Vl(n){return n==="auto"?0:Number(n.slice(0,-1).replace(",","."))*1e3}function ia(n){return(n?n.ownerDocument:document).body.offsetHeight}function Zu(n,e,t){const s=n[cs];s&&(e=(e?[e,...s]:[...s]).join(" ")),e==null?n.removeAttribute("class"):t?n.setAttribute("class",e):n.className=e}const jl=Symbol("_vod"),qu=Symbol("_vsh"),zl=Symbol("");function Dt(n){const e=ea();if(!e)return;const t=e.ut=(i=n(e.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${e.uid}"]`)).forEach(r=>Bi(r,i))},s=()=>{const i=n(e.proxy);e.ce?Bi(e.ce,i):ra(e.subTree,i),t(i)};Qo(()=>{Do(s)}),Pt(()=>{Qe(s,wt,{flush:"post"});const i=new MutationObserver(s);i.observe(e.subTree.el.parentNode,{childList:!0}),Xt(()=>i.disconnect())})}function ra(n,e){if(n.shapeFlag&128){const t=n.suspense;n=t.activeBranch,t.pendingBranch&&!t.isHydrating&&t.effects.push(()=>{ra(t.activeBranch,e)})}for(;n.component;)n=n.component.subTree;if(n.shapeFlag&1&&n.el)Bi(n.el,e);else if(n.type===He)n.children.forEach(t=>ra(t,e));else if(n.type===Li){let{el:t,anchor:s}=n;for(;t&&(Bi(t,e),t!==s);)t=t.nextSibling}}function Bi(n,e){if(n.nodeType===1){const t=n.style;let s="";for(const i in e){const r=Qd(e[i]);t.setProperty(`--${i}`,r),s+=`--${i}: ${r};`}t[zl]=s}}const Ju=/(?:^|;)\s*display\s*:/;function Qu(n,e,t){const s=n.style,i=Fe(t);let r=!1;if(t&&!i){if(e)if(Fe(e))for(const a of e.split(";")){const o=a.slice(0,a.indexOf(":")).trim();t[o]==null&&Hi(s,o,"")}else for(const a in e)t[a]==null&&Hi(s,a,"");for(const a in t)a==="display"&&(r=!0),Hi(s,a,t[a])}else if(i){if(e!==t){const a=s[zl];a&&(t+=";"+a),s.cssText=t,r=Ju.test(t)}}else e&&n.removeAttribute("style");jl in n&&(n[jl]=r?s.display:"",n[qu]&&(s.display="none"))}const Yl=/\s*!important$/;function Hi(n,e,t){if(de(t))t.forEach(s=>Hi(n,e,s));else if(t==null&&(t=""),e.startsWith("--"))n.setProperty(e,t);else{const s=ef(n,e);Yl.test(t)?n.setProperty(pt(s),t.replace(Yl,""),"important"):n[s]=t}}const Xl=["Webkit","Moz","ms"],aa={};function ef(n,e){const t=aa[e];if(t)return t;let s=xt(e);if(s!=="filter"&&s in n)return aa[e]=s;s=ro(s);for(let i=0;i<Xl.length;i++){const r=Xl[i]+s;if(r in n)return aa[e]=r}return e}const Kl="http://www.w3.org/1999/xlink";function Zl(n,e,t,s,i,r=Jd(e)){s&&e.startsWith("xlink:")?t==null?n.removeAttributeNS(Kl,e.slice(6,e.length)):n.setAttributeNS(Kl,e,t):t==null||r&&!lo(t)?n.removeAttribute(e):n.setAttribute(e,r?"":on(t)?String(t):t)}function ql(n,e,t,s,i){if(e==="innerHTML"||e==="textContent"){t!=null&&(n[e]=e==="innerHTML"?Dl(t):t);return}const r=n.tagName;if(e==="value"&&r!=="PROGRESS"&&!r.includes("-")){const o=r==="OPTION"?n.getAttribute("value")||"":n.value,l=t==null?n.type==="checkbox"?"on":"":String(t);(o!==l||!("_value"in n))&&(n.value=l),t==null&&n.removeAttribute(e),n._value=t;return}let a=!1;if(t===""||t==null){const o=typeof n[e];o==="boolean"?t=lo(t):t==null&&o==="string"?(t="",a=!0):o==="number"&&(t=0,a=!0)}try{n[e]=t}catch{}a&&n.removeAttribute(i||e)}function ds(n,e,t,s){n.addEventListener(e,t,s)}function tf(n,e,t,s){n.removeEventListener(e,t,s)}const Jl=Symbol("_vei");function nf(n,e,t,s,i=null){const r=n[Jl]||(n[Jl]={}),a=r[e];if(s&&a)a.value=s;else{const[o,l]=sf(e);if(s){const c=r[e]=of(s,i);ds(n,o,c,l)}else a&&(tf(n,o,a,l),r[e]=void 0)}}const Ql=/(?:Once|Passive|Capture)$/;function sf(n){let e;if(Ql.test(n)){e={};let s;for(;s=n.match(Ql);)n=n.slice(0,n.length-s[0].length),e[s[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):pt(n.slice(2)),e]}let oa=0;const rf=Promise.resolve(),af=()=>oa||(rf.then(()=>oa=0),oa=Date.now());function of(n,e){const t=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=t.attached)return;Tt(lf(s,t.value),e,5,[s])};return t.value=n,t.attached=af(),t}function lf(n,e){if(de(e)){const t=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{t.call(n),n._stopped=!0},e.map(s=>i=>!i._stopped&&s&&s(i))}else return e}const ec=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,cf=(n,e,t,s,i,r)=>{const a=i==="svg";e==="class"?Zu(n,s,a):e==="style"?Qu(n,t,s):di(e)?br(e)||nf(n,e,t,s,r):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):df(n,e,s,a))?(ql(n,e,s),!n.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&Zl(n,e,s,a,r,e!=="value")):n._isVueCE&&(/[A-Z]/.test(e)||!Fe(s))?ql(n,xt(e),s,r,e):(e==="true-value"?n._trueValue=s:e==="false-value"&&(n._falseValue=s),Zl(n,e,s,a))};function df(n,e,t,s){if(s)return!!(e==="innerHTML"||e==="textContent"||e in n&&ec(e)&&pe(t));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="sandbox"&&n.tagName==="IFRAME"||e==="form"||e==="list"&&n.tagName==="INPUT"||e==="type"&&n.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const i=n.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return ec(e)&&Fe(t)?!1:e in n}const tc={};function hf(n,e,t){let s=st(n,e);ui(s)&&(s=Ge({},s,e));class i extends la{constructor(a){super(s,a,t)}}return i.def=s,i}const uf=typeof HTMLElement<"u"?HTMLElement:class{};class la extends uf{constructor(e,t={},s=dc){super(),this._def=e,this._props=t,this._createApp=s,this._isVueCE=!0,this._instance=null,this._app=null,this._nonce=this._def.nonce,this._connected=!1,this._resolved=!1,this._patching=!1,this._dirty=!1,this._numberProps=null,this._styleChildren=new WeakSet,this._ob=null,this.shadowRoot&&s!==dc?this._root=this.shadowRoot:e.shadowRoot!==!1?(this.attachShadow(Ge({},e.shadowRootOptions,{mode:"open"})),this._root=this.shadowRoot):this._root=this}connectedCallback(){if(!this.isConnected)return;!this.shadowRoot&&!this._resolved&&this._parseSlots(),this._connected=!0;let e=this;for(;e=e&&(e.parentNode||e.host);)if(e instanceof la){this._parent=e;break}this._instance||(this._resolved?this._mount(this._def):e&&e._pendingResolve?this._pendingResolve=e._pendingResolve.then(()=>{this._pendingResolve=void 0,this._resolveDef()}):this._resolveDef())}_setParent(e=this._parent){e&&(this._instance.parent=e._instance,this._inheritParentContext(e))}_inheritParentContext(e=this._parent){e&&this._app&&Object.setPrototypeOf(this._app._context.provides,e._instance.provides)}disconnectedCallback(){this._connected=!1,No(()=>{this._connected||(this._ob&&(this._ob.disconnect(),this._ob=null),this._app&&this._app.unmount(),this._instance&&(this._instance.ce=void 0),this._app=this._instance=null,this._teleportTargets&&(this._teleportTargets.clear(),this._teleportTargets=void 0))})}_processMutations(e){for(const t of e)this._setAttr(t.attributeName)}_resolveDef(){if(this._pendingResolve)return;for(let s=0;s<this.attributes.length;s++)this._setAttr(this.attributes[s].name);this._ob=new MutationObserver(this._processMutations.bind(this)),this._ob.observe(this,{attributes:!0});const e=(s,i=!1)=>{this._resolved=!0,this._pendingResolve=void 0;const{props:r,styles:a}=s;let o;if(r&&!de(r))for(const l in r){const c=r[l];(c===Number||c&&c.type===Number)&&(l in this._props&&(this._props[l]=Cr(this._props[l])),(o||(o=Object.create(null)))[xt(l)]=!0)}this._numberProps=o,this._resolveProps(s),this.shadowRoot&&this._applyStyles(a),this._mount(s)},t=this._def.__asyncLoader;t?this._pendingResolve=t().then(s=>{s.configureApp=this._def.configureApp,e(this._def=s,!0)}):e(this._def)}_mount(e){this._app=this._createApp(e),this._inheritParentContext(),e.configureApp&&e.configureApp(this._app),this._app._ceVNode=this._createVNode(),this._app.mount(this._root);const t=this._instance&&this._instance.exposed;if(t)for(const s in t)ke(this,s)||Object.defineProperty(this,s,{get:()=>_e(t[s])})}_resolveProps(e){const{props:t}=e,s=de(t)?t:Object.keys(t||{});for(const i of Object.keys(this))i[0]!=="_"&&s.includes(i)&&this._setProp(i,this[i]);for(const i of s.map(xt))Object.defineProperty(this,i,{get(){return this._getProp(i)},set(r){this._setProp(i,r,!0,!this._patching)}})}_setAttr(e){if(e.startsWith("data-v-"))return;const t=this.hasAttribute(e);let s=t?this.getAttribute(e):tc;const i=xt(e);t&&this._numberProps&&this._numberProps[i]&&(s=Cr(s)),this._setProp(i,s,!1,!0)}_getProp(e){return this._props[e]}_setProp(e,t,s=!0,i=!1){if(t!==this._props[e]&&(this._dirty=!0,t===tc?delete this._props[e]:(this._props[e]=t,e==="key"&&this._app&&(this._app._ceVNode.key=t)),i&&this._instance&&this._update(),s)){const r=this._ob;r&&(this._processMutations(r.takeRecords()),r.disconnect()),t===!0?this.setAttribute(pt(e),""):typeof t=="string"||typeof t=="number"?this.setAttribute(pt(e),t+""):t||this.removeAttribute(pt(e)),r&&r.observe(this,{attributes:!0})}}_update(){const e=this._createVNode();this._app&&(e.appContext=this._app._context),Sf(e,this._root)}_createVNode(){const e={};this.shadowRoot||(e.onVnodeMounted=e.onVnodeUpdated=this._renderSlots.bind(this));const t=We(this._def,Ge(e,this._props));return this._instance||(t.ce=s=>{this._instance=s,s.ce=this,s.isCE=!0;const i=(r,a)=>{this.dispatchEvent(new CustomEvent(r,ui(a[0])?Ge({detail:a},a[0]):{detail:a}))};s.emit=(r,...a)=>{i(r,a),pt(r)!==r&&i(pt(r),a)},this._setParent()}),t}_applyStyles(e,t){if(!e)return;if(t){if(t===this._def||this._styleChildren.has(t))return;this._styleChildren.add(t)}const s=this._nonce;for(let i=e.length-1;i>=0;i--){const r=document.createElement("style");s&&r.setAttribute("nonce",s),r.textContent=e[i],this.shadowRoot.prepend(r)}}_parseSlots(){const e=this._slots={};let t;for(;t=this.firstChild;){const s=t.nodeType===1&&t.getAttribute("slot")||"default";(e[s]||(e[s]=[])).push(t),this.removeChild(t)}}_renderSlots(){const e=this._getSlots(),t=this._instance.type.__scopeId;for(let s=0;s<e.length;s++){const i=e[s],r=i.getAttribute("name")||"default",a=this._slots[r],o=i.parentNode;if(a)for(const l of a){if(t&&l.nodeType===1){const c=t+"-s",d=document.createTreeWalker(l,1);l.setAttribute(c,"");let h;for(;h=d.nextNode();)h.setAttribute(c,"")}o.insertBefore(l,i)}else for(;i.firstChild;)o.insertBefore(i.firstChild,i);o.removeChild(i)}}_getSlots(){const e=[this];this._teleportTargets&&e.push(...this._teleportTargets);const t=new Set;for(const s of e){const i=s.querySelectorAll("slot");for(let r=0;r<i.length;r++)t.add(i[r])}return Array.from(t)}_injectChildStyle(e){this._applyStyles(e.styles,e)}_beginPatch(){this._patching=!0,this._dirty=!1}_endPatch(){this._patching=!1,this._dirty&&this._instance&&this._update()}_removeChildStyle(e){}}const nc=new WeakMap,sc=new WeakMap,$i=Symbol("_moveCb"),ic=Symbol("_enterCb"),ff=(n=>(delete n.props.mode,n))({name:"TransitionGroup",props:Ge({},zu,{tag:String,moveClass:String}),setup(n,{slots:e}){const t=ea(),s=Bh();let i,r;return el(()=>{if(!i.length)return;const a=n.moveClass||`${n.name||"v"}-move`;if(!_f(i[0].el,t.vnode.el,a)){i=[];return}i.forEach(pf),i.forEach(gf);const o=i.filter(mf);ia(t.vnode.el),o.forEach(l=>{const c=l.el,d=c.style;Lt(c,a),d.transform=d.webkitTransform=d.transitionDuration="";const h=c[$i]=u=>{u&&u.target!==c||(!u||u.propertyName.endsWith("transform"))&&(c.removeEventListener("transitionend",h),c[$i]=null,mn(c,a))};c.addEventListener("transitionend",h)}),i=[]}),()=>{const a=xe(n),o=Yu(a);let l=a.tag||He;if(i=[],r)for(let c=0;c<r.length;c++){const d=r[c];d.el&&d.el instanceof Element&&(i.push(d),Rs(d,Ur(d,o,s,t)),nc.set(d,{left:d.el.offsetLeft,top:d.el.offsetTop}))}r=e.default?Xo(e.default()):[];for(let c=0;c<r.length;c++){const d=r[c];d.key!=null&&Rs(d,Ur(d,o,s,t))}return We(l,null,r)}}});function pf(n){const e=n.el;e[$i]&&e[$i](),e[ic]&&e[ic]()}function gf(n){sc.set(n,{left:n.el.offsetLeft,top:n.el.offsetTop})}function mf(n){const e=nc.get(n),t=sc.get(n),s=e.left-t.left,i=e.top-t.top;if(s||i){const r=n.el.style;return r.transform=r.webkitTransform=`translate(${s}px,${i}px)`,r.transitionDuration="0s",n}}function _f(n,e,t){const s=n.cloneNode(),i=n[cs];i&&i.forEach(o=>{o.split(/\s+/).forEach(l=>l&&s.classList.remove(l))}),t.split(/\s+/).forEach(o=>o&&s.classList.add(o)),s.style.display="none";const r=e.nodeType===1?e:e.parentNode;r.appendChild(s);const{hasTransform:a}=Wl(s);return r.removeChild(s),a}const rc=n=>{const e=n.props["onUpdate:modelValue"]||!1;return de(e)?t=>pi(e,t):e};function vf(n){n.target.composing=!0}function ac(n){const e=n.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const ca=Symbol("_assign");function oc(n,e,t){return e&&(n=n.trim()),t&&(n=kr(n)),n}const yf={created(n,{modifiers:{lazy:e,trim:t,number:s}},i){n[ca]=rc(i);const r=s||i.props&&i.props.type==="number";ds(n,e?"change":"input",a=>{a.target.composing||n[ca](oc(n.value,t,r))}),(t||r)&&ds(n,"change",()=>{n.value=oc(n.value,t,r)}),e||(ds(n,"compositionstart",vf),ds(n,"compositionend",ac),ds(n,"change",ac))},mounted(n,{value:e}){n.value=e??""},beforeUpdate(n,{value:e,oldValue:t,modifiers:{lazy:s,trim:i,number:r}},a){if(n[ca]=rc(a),n.composing)return;const o=(r||n.type==="number")&&!/^0\d/.test(n.value)?kr(n.value):n.value,l=e??"";o!==l&&(document.activeElement===n&&n.type!=="range"&&(s&&e===t||i&&n.value.trim()===l)||(n.value=l))}},bf=["ctrl","shift","alt","meta"],wf={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,e)=>bf.some(t=>n[`${t}Key`]&&!e.includes(t))},Bs=(n,e)=>{const t=n._withMods||(n._withMods={}),s=e.join(".");return t[s]||(t[s]=((i,...r)=>{for(let a=0;a<e.length;a++){const o=wf[e[a]];if(o&&o(i,e))return}return n(i,...r)}))},xf=Ge({patchProp:cf},ju);let lc;function cc(){return lc||(lc=wu(xf))}const Sf=((...n)=>{cc().render(...n)}),dc=((...n)=>{const e=cc().createApp(...n),{mount:t}=e;return e.mount=s=>{const i=Cf(s);if(!i)return;const r=e._component;!pe(r)&&!r.render&&!r.template&&(r.template=i.innerHTML),i.nodeType===1&&(i.textContent="");const a=t(i,!1,kf(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),a},e});function kf(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function Cf(n){return Fe(n)?document.querySelector(n):n}const Tf=48,$n=180,Ef=32,Af=24,Rf=100,If=0,Pf=1,Mf="#1a1c20",hc="#4cc9f0",uc="#f72585",Of=4,Nf="#ff006e",Lf=2,Df="#1a1c20",Gf="#3a7ca5",Ff="#81c3d7",Bf=8,Hf="#555",$f="#888",Wf=8,Uf="#141618",Vf="#c8c8c8",jf=12,zf="#fff",Yf=10,Xf="#fff",Kf=10,Zf=50,fc=$n,Wi=200,da=120,pc=120,qf=8,Jf=2,Qf=3,gc="rgba(255, 255, 255, 0.15)",mc=4,Ui=24,ha="#4cc9f0",ua=2,fa=1,pa=.3,ga="#161819",e0="#141618",t0="#1a1c20",n0="#22252a",s0="#1e2428",i0=180,r0=340,_c=.1,a0=3e3,o0=3;function Hs(n,e){let t=0,s=n.length;for(;t<s;){const i=t+s>>>1;n[i]>e?s=i:t=i+1}return t}function vc(n,e,t){return n+(e-n)*t}function Ve(n,e,t){return Math.max(e,Math.min(t,n))}function $s(n){let e=0;for(let r=0;r<n.length;r++){const a=n.charCodeAt(r);e=(e<<5)-e+a,e=e&e}const t=Math.abs(e)%360,s=50+Math.abs(e>>8)%30,i=35+Math.abs(e>>16)%20;return`hsl(${t}, ${s}%, ${i}%)`}function _n(n,e,t,s){const i=t-e;return i<=0?0:(n-e)/i*s}function ma(n,e,t,s){const i=t-e;return s<=0?e:e+n/s*i}function l0(n,e,t,s){const i=e-n;if(i<=0||t<=0)return[];const r=Math.floor(t/s);if(r<1)return[];const a=i/r,o=Math.pow(10,Math.floor(Math.log10(a))),l=a/o;let c;l<=1?c=o:l<=2?c=2*o:l<=5?c=5*o:c=10*o;const d=[],h=Math.ceil(n/c)*c;for(let u=h;u<=e;u+=c)d.push(u);return d}function c0(n){const e=n.toFixed(2);return parseFloat(e).toString()}let d0=0,h0=0;function u0(){return`track_${++d0}`}function Vi(){return`elem_${++h0}`}class f0{tracksByName=new Map;tracksById=new Map;orderedTrackIds=[];currentTime=0;lastTime=0;duration;undoStack=[];redoStack=[];dragPreview=null;onInvalidate=null;constructor(e){this.duration=e??Rf}setInvalidateCallback(e){this.onInvalidate=e}invalidate(){this.onInvalidate?.()}addTrack(e){if(this.tracksByName.has(e.name))return console.warn(`Track "${e.name}" already exists`),!1;const t=[...e.data].sort((d,h)=>d.time-h.time),s=[],i=[],r=[];for(const d of t){const h=Vi();i.push(d.time),r.push(d.element),e.fieldType==="number"?s.push({id:h,time:d.time,value:d.element}):e.fieldType==="enum"?s.push({id:h,time:d.time,value:d.element}):s.push({id:h,time:d.time,value:d.element})}const a=e.low??If,o=e.high??Pf,l=u0(),c={id:l,def:e,times:i,elements:r,elementData:s,low:a,high:o};if(this.tracksByName.set(e.name,c),this.tracksById.set(l,c),this.orderedTrackIds.push(l),i.length>0){const d=i[i.length-1];d+1>this.duration&&(this.duration=d+1)}return this.invalidate(),!0}deleteTrack(e){const t=this.tracksById.get(e);return t?(this.tracksByName.delete(t.def.name),this.tracksById.delete(e),this.orderedTrackIds=this.orderedTrackIds.filter(s=>s!==e),this.invalidate(),!0):!1}getTrack(e){return this.tracksByName.get(e)}getTrackById(e){return this.tracksById.get(e)}getOrderedTracks(){return this.orderedTrackIds.map(e=>this.getTrackById(e)).filter(e=>e!==void 0)}getTracksByType(e){return this.getOrderedTracks().filter(t=>t.def.fieldType===e)}rebuildArrays(e){e.elementData.sort((t,s)=>t.time-s.time),e.times=[],e.elements=[];for(const t of e.elementData)e.times.push(t.time),e.def.fieldType==="number"||e.def.fieldType,e.elements.push(t.value)}addNumberElement(e,t,s){const i=this.tracksById.get(e);if(!i||i.def.fieldType!=="number")return null;const r=Vi(),a={id:r,time:t,value:Ve(s,i.low,i.high)};return i.elementData.push(a),this.rebuildArrays(i),this.invalidate(),r}addEnumElement(e,t){const s=this.tracksById.get(e);if(!s||s.def.fieldType!=="enum")return null;const r=this.getEnumOptions(e)[0]||"",a=this.resolveTimeCollision(s,t,null),o=Vi(),l={id:o,time:a,value:r};return s.elementData.push(l),this.rebuildArrays(s),this.invalidate(),o}addFuncElement(e,t){const s=this.tracksById.get(e);if(!s||s.def.fieldType!=="func")return null;const i=this.resolveTimeCollision(s,t,null),r=Vi(),a={id:r,time:i,value:{funcName:"func",args:[]}};return s.elementData.push(a),this.rebuildArrays(s),this.invalidate(),r}deleteElement(e,t){const s=this.tracksById.get(e);if(!s)return!1;const i=s.elementData.findIndex(r=>r.id===t);return i===-1?!1:(s.elementData.splice(i,1),this.rebuildArrays(s),this.invalidate(),!0)}updateNumberElement(e,t,s,i){const r=this.tracksById.get(e);if(!r||r.def.fieldType!=="number")return!1;const a=r.elementData.find(o=>o.id===t);return a?(a.time=s,a.value=Ve(i,r.low,r.high),this.rebuildArrays(r),this.invalidate(),!0):!1}updateEnumElement(e,t,s,i){const r=this.tracksById.get(e);if(!r||r.def.fieldType!=="enum")return{success:!1,collision:!1};const a=r.elementData.find(c=>c.id===t);if(!a)return{success:!1,collision:!1};const o=this.resolveTimeCollision(r,s,t),l=o!==s;return a.time=o,i!==void 0&&(a.value=i),this.rebuildArrays(r),this.invalidate(),{success:!0,collision:l}}updateFuncElement(e,t,s,i,r){const a=this.tracksById.get(e);if(!a||a.def.fieldType!=="func")return{success:!1,collision:!1};const o=a.elementData.find(d=>d.id===t);if(!o)return{success:!1,collision:!1};const l=this.resolveTimeCollision(a,s,t),c=l!==s;return o.time=l,i!==void 0&&(o.value.funcName=i),r!==void 0&&(o.value.args=r),this.rebuildArrays(a),this.invalidate(),{success:!0,collision:c}}setTrackBounds(e,t,s){const i=this.tracksById.get(e);if(!i||i.def.fieldType!=="number")return!1;i.low=t,i.high=s;for(const r of i.elementData)r.value=Ve(r.value,t,s);return this.rebuildArrays(i),this.invalidate(),!0}resolveTimeCollision(e,t,s){let i=t,r=0;const a=100;for(;r<a;){let o=!1;for(const l of e.elementData)if(!(s&&l.id===s)&&Math.abs(l.time-i)<_c){o=!0,i=l.time+_c;break}if(!o)break;r++}return Math.max(0,i)}getEnumOptions(e){const t=this.tracksById.get(e);if(!t||t.def.fieldType!=="enum")return[];const s=new Set;for(const i of t.elementData)s.add(i.value);return Array.from(s)}getElement(e,t){const s=this.tracksById.get(e);if(s)return s.elementData.find(i=>i.id===t)}createSnapshot(){const e=[];for(const t of this.tracksById.values())e.push({id:t.id,name:t.def.name,fieldType:t.def.fieldType,elementData:JSON.parse(JSON.stringify(t.elementData)),low:t.low,high:t.high});return{tracks:e,trackOrder:[...this.orderedTrackIds]}}pushSnapshot(){this.undoStack.push(this.createSnapshot()),this.redoStack=[]}restoreSnapshot(e){for(const t of e.tracks){const s=this.tracksById.get(t.id);s&&(s.elementData=JSON.parse(JSON.stringify(t.elementData)),s.low=t.low,s.high=t.high,this.rebuildArrays(s))}this.orderedTrackIds=[...e.trackOrder],this.invalidate()}undo(){if(this.undoStack.length===0)return!1;this.redoStack.push(this.createSnapshot());const e=this.undoStack.pop();return this.restoreSnapshot(e),!0}redo(){if(this.redoStack.length===0)return!1;this.undoStack.push(this.createSnapshot());const e=this.redoStack.pop();return this.restoreSnapshot(e),!0}setDragPreview(e){this.dragPreview=e}evaluateNumberTrack(e,t){let s=e.times,i=e.elements;if(this.dragPreview&&this.dragPreview.fieldType==="number"&&this.dragPreview.trackId===e.id){const u=e.elementData.findIndex(f=>f.id===this.dragPreview.elementId);if(u!==-1){s=[...e.times],i=[...e.elements],s[u]=this.dragPreview.time,i[u]=this.dragPreview.value;const f=s.map((p,m)=>m).sort((p,m)=>s[p]-s[m]);s=f.map(p=>s[p]),i=f.map(p=>i[p])}}const{low:r,high:a}=e,o=s.length;if(o===0)return r;const l=Hs(s,t),c=l-1,d=l;let h;if(c<0)h=i[0];else if(d>=o)h=i[c];else{const u=s[c],f=s[d],p=i[c],m=i[d],v=(t-u)/(f-u);h=vc(p,m,v)}return Ve(h,r,a)}evaluateEnumTrack(e,t){let s=e.times,i=e.elements;if(this.dragPreview&&this.dragPreview.fieldType==="enum"&&this.dragPreview.trackId===e.id){const o=e.elementData.findIndex(l=>l.id===this.dragPreview.elementId);if(o!==-1){s=[...e.times],i=[...e.elements],s[o]=this.dragPreview.time;const l=s.map((c,d)=>d).sort((c,d)=>s[c]-s[d]);s=l.map(c=>s[c]),i=l.map(c=>i[c])}}if(s.length===0)return"";const a=Hs(s,t)-1;return a<0?i[0]:i[a]}fireFuncHits(e,t,s){if(s<=t||!e.def.updateFunc)return;const{times:i,elements:r}=e,a=Hs(i,t),o=Hs(i,s);for(let l=a;l<o;l++){const c=r[l];e.def.updateFunc(c.funcName,...c.args)}}scrubToTime(e){this.currentTime=e;for(const t of this.tracksByName.values())switch(t.def.fieldType){case"number":if(t.def.updateNumber){const s=this.evaluateNumberTrack(t,e);t.def.updateNumber(s)}break;case"enum":if(t.def.updateEnum){const s=this.evaluateEnumTrack(t,e);t.def.updateEnum(s)}break;case"func":this.fireFuncHits(t,this.lastTime,e);break}this.lastTime=e,this.invalidate()}evaluateAtCurrentTime(){for(const e of this.tracksByName.values())switch(e.def.fieldType){case"number":if(e.def.updateNumber){const t=this.evaluateNumberTrack(e,this.currentTime);e.def.updateNumber(t)}break;case"enum":if(e.def.updateEnum){const t=this.evaluateEnumTrack(e,this.currentTime);e.def.updateEnum(t)}break}}jumpToTime(e){this.currentTime=e,this.lastTime=e,this.invalidate()}}class p0{dirty=!1;rafPending=!1;subs=new Set;subscribe(e){return this.subs.add(e),()=>{this.subs.delete(e)}}invalidate(){this.dirty=!0,this.rafPending||(this.rafPending=!0,requestAnimationFrame(()=>this.frame()))}frame(){if(this.rafPending=!1,!!this.dirty){this.dirty=!1;for(const e of this.subs)e()}}}const g0={class:"time-ribbon-wrapper"},m0={class:"time-ribbon-container"},_0={class:"time-ticks-container"},v0={class:"tick-label"},y0=st({__name:"TimeRibbon",props:{duration:{type:Number},windowStart:{type:Number},windowEnd:{type:Number},spacerWidth:{default:$n,type:Number}},emits:["update:windowStart","update:windowEnd"],setup(n,{emit:e}){Dt(_=>({v1d07b2a6:_e(Df),v54b317c3:_e(Ef)+"px",a35aae12:_e(Af)+"px",v1671855f:_.spacerWidth+"px",v9a2c26f2:_e(Gf),v7a273b01:_e(Bf)+"px",d838c06e:_e(Ff),v49ca3170:_e(Wf)+"px",v65283f0d:_e(Hf),a2ef8b3c:_e($f)}));const t=n,s=e,i=me(null),r=me(null),a=me(null),o=me(0),l=me(0),c=me(0),d=me(0);let h=null;Pt(()=>{r.value&&(d.value=r.value.clientWidth,h=new ResizeObserver(_=>{for(const C of _)d.value=C.contentRect.width}),h.observe(r.value))}),Xt(()=>{h?.disconnect()});const u=Pe(()=>t.windowStart/t.duration*100),f=Pe(()=>(t.windowEnd-t.windowStart)/t.duration*100),p=Pe(()=>d.value<=0?[]:l0(t.windowStart,t.windowEnd,d.value,Zf).map(C=>({time:C,x:_n(C,t.windowStart,t.windowEnd,d.value),label:c0(C)})));function m(){return i.value?.clientWidth??0}function v(_){const C=m();return C<=0?0:_/C*t.duration}function S(_,C){_.preventDefault(),a.value=C,o.value=_.clientX,l.value=t.windowStart,c.value=t.windowEnd,window.addEventListener("mousemove",k),window.addEventListener("mouseup",b)}function k(_){if(!a.value||!i.value)return;const C=_.clientX-o.value,A=v(C),L=.1;if(a.value==="viewport"){let O=l.value+A,I=c.value+A;O<0&&(I-=O,O=0),I>t.duration&&(O-=I-t.duration,I=t.duration),O=Math.max(0,O),I=Math.min(t.duration,I),s("update:windowStart",O),s("update:windowEnd",I)}else if(a.value==="start"){let O=l.value+A;O=Math.max(0,Math.min(O,t.windowEnd-L)),s("update:windowStart",O)}else if(a.value==="end"){let O=c.value+A;O=Math.min(t.duration,Math.max(O,t.windowStart+L)),s("update:windowEnd",O)}}function b(){a.value=null,window.removeEventListener("mousemove",k),window.removeEventListener("mouseup",b)}return(_,C)=>(le(),ge("div",g0,[U("div",m0,[C[3]||(C[3]=U("div",{class:"name-spacer"},null,-1)),U("div",{class:"ribbon",ref_key:"ribbonRef",ref:i},[U("div",{class:"viewport",style:Pn({left:u.value+"%",width:f.value+"%"}),onMousedown:C[2]||(C[2]=A=>S(A,"viewport"))},[U("div",{class:"handle handle-start",onMousedown:C[0]||(C[0]=Bs(A=>S(A,"start"),["stop"]))},null,32),U("div",{class:"handle handle-end",onMousedown:C[1]||(C[1]=Bs(A=>S(A,"end"),["stop"]))},null,32)],36)],512)]),U("div",_0,[C[5]||(C[5]=U("div",{class:"name-spacer ticks-spacer"},null,-1)),U("div",{class:"ticks-area",ref_key:"ticksRef",ref:r},[(le(!0),ge(He,null,hn(p.value,A=>(le(),ge("div",{key:A.time,class:"tick",style:Pn({left:A.x+"px"})},[C[4]||(C[4]=U("div",{class:"tick-mark"},null,-1)),U("div",v0,St(A.label),1)],4))),128))],512)])]))}}),b0=".time-ribbon-wrapper[data-v-5749d4dc]{display:flex;flex-direction:column;background:var(--v1d07b2a6)}.time-ribbon-container[data-v-5749d4dc]{display:flex;height:var(--v54b317c3)}.time-ticks-container[data-v-5749d4dc]{display:flex;height:var(--a35aae12);border-bottom:1px solid #2a2d30}.name-spacer[data-v-5749d4dc]{width:var(--v1671855f);min-width:var(--v1671855f);background:#141618}.ticks-spacer[data-v-5749d4dc]{border-bottom:1px solid #2a2d30}.ribbon[data-v-5749d4dc]{flex:1;position:relative;background:var(--v1d07b2a6);border-bottom:1px solid #2a2d30}.ticks-area[data-v-5749d4dc]{flex:1;position:relative;background:#141618}.viewport[data-v-5749d4dc]{position:absolute;top:4px;bottom:4px;background:var(--v9a2c26f2);border-radius:4px;cursor:grab}.viewport[data-v-5749d4dc]:active{cursor:grabbing}.handle[data-v-5749d4dc]{position:absolute;top:0;bottom:0;width:var(--v7a273b01);background:var(--d838c06e);cursor:ew-resize;opacity:.7;transition:opacity .15s}.handle[data-v-5749d4dc]:hover{opacity:1}.handle-start[data-v-5749d4dc]{left:0;border-radius:4px 0 0 4px}.handle-end[data-v-5749d4dc]{right:0;border-radius:0 4px 4px 0}.tick[data-v-5749d4dc]{position:absolute;top:0;transform:translate(-50%);display:flex;flex-direction:column;align-items:center}.tick-mark[data-v-5749d4dc]{width:1px;height:var(--v49ca3170);background:var(--v65283f0d)}.tick-label[data-v-5749d4dc]{font-size:10px;color:var(--a2ef8b3c);margin-top:2px;white-space:nowrap}",lt=(n,e)=>{const t=n.__vccOpts||n;for(const[s,i]of e)t[s]=i;return t},w0=lt(y0,[["styles",[b0]],["__scopeId","data-v-5749d4dc"]]),x0=lt(st({__name:"TrackCanvas",props:{track:{type:Object},windowStart:{type:Number},windowEnd:{type:Number}},setup(n){const e=n,t=Mt("scheduler"),s=me(null),i=me(0),r=me(0);let a=null,o=null;function l(){const f=s.value;if(!f)return;const p=window.devicePixelRatio||1,m=f.getBoundingClientRect();i.value=m.width,r.value=m.height,f.width=m.width*p,f.height=m.height*p;const v=f.getContext("2d");v&&v.scale(p,p)}function c(){const f=s.value;if(!f)return;const p=f.getContext("2d");if(!p)return;const m=i.value,v=r.value;switch(p.fillStyle=Mf,p.fillRect(0,0,m,v),e.track.def.fieldType){case"number":d(p,m,v);break;case"enum":h(p,m,v);break;case"func":u(p,m,v);break}}function d(f,p,m){const{times:v,elements:S,low:k,high:b}=e.track,{windowStart:_,windowEnd:C}=e;if(v.length===0)return;const A=4,L=m-A*2,O=w=>{const R=(w-k)/(b-k);return A+L*(1-R)},I=w=>_n(w,_,C,p),W=w=>{const R=v.length,P=Hs(v,w),M=P-1,D=P;let G;if(M<0)G=S[0];else if(D>=R)G=S[M];else{const J=v[M],ae=v[D],ne=S[M],ie=S[D],Re=(w-J)/(ae-J);G=vc(ne,ie,Re)}return Ve(G,k,b)};f.beginPath(),f.strokeStyle=hc,f.lineWidth=2;const K=W(_);f.moveTo(0,O(K));for(let w=0;w<v.length;w++){const R=v[w];if(R<_)continue;if(R>C){const M=W(C);f.lineTo(p,O(M));break}const P=S[w];f.lineTo(I(R),O(P))}if(v[v.length-1]<=C){const w=W(C);f.lineTo(p,O(w))}f.stroke(),f.fillStyle=uc;for(let w=0;w<v.length;w++){const R=v[w];if(R<_||R>C)continue;const P=S[w],M=I(R),D=O(P);f.beginPath(),f.arc(M,D,Of,0,Math.PI*2),f.fill()}}function h(f,p,m){const{times:v,elements:S}=e.track,{windowStart:k,windowEnd:b}=e;if(v.length===0)return;const _=C=>_n(C,k,b,p);for(let C=0;C<v.length;C++){const A=v[C],L=C<v.length-1?v[C+1]:b+1,O=S[C];if(L<=k)continue;if(A>b)break;const I=Math.max(A,k),W=Math.min(L,b),K=_(I),w=_(W)-K;if(!(w<1)&&(f.fillStyle=$s(O),f.fillRect(K,2,w,m-4),w>12)){f.save(),f.fillStyle=zf,f.font=`${Yf}px system-ui, sans-serif`;const R=K+w/2,P=m/2;f.translate(R,P),f.rotate(-Math.PI/2);const M=m-8;let D=O,G=f.measureText(D).width;for(;G>M&&D.length>3;)D=D.slice(0,-1),G=f.measureText(D+"").width;D!==O&&(D+=""),f.textAlign="center",f.textBaseline="middle",f.fillText(D,0,0),f.restore()}}if(v[0]>k){const A=_(v[0]),L=S[0];f.fillStyle=$s(L),f.globalAlpha=.4,f.fillRect(0,2,A-0,m-4),f.globalAlpha=1}}function u(f,p,m){const{times:v,elements:S}=e.track,{windowStart:k,windowEnd:b}=e;if(v.length===0)return;const _=A=>_n(A,k,b,p),C=24;for(let A=0;A<v.length;A++){const L=v[A];if(L<k||L>b)continue;const O=S[A],I=_(L),W=C/2;f.fillStyle=$s(O.funcName),f.fillRect(I-W,2,C,m-4),f.strokeStyle="rgba(255,255,255,0.5)",f.lineWidth=1,f.beginPath(),f.moveTo(I,0),f.lineTo(I,m),f.stroke(),f.save(),f.fillStyle=Xf,f.font=`${Kf}px system-ui, sans-serif`,f.translate(I,m/2),f.rotate(-Math.PI/2);const K=m-8;let g=O.funcName,w=f.measureText(g).width;for(;w>K&&g.length>3;)g=g.slice(0,-1),w=f.measureText(g+"").width;g!==O.funcName&&(g+=""),f.textAlign="center",f.textBaseline="middle",f.fillText(g,0,0),f.restore()}}return Pt(()=>{o=new ResizeObserver(()=>{l(),c()}),s.value&&o.observe(s.value),l(),c(),a=t.subscribe(c)}),Xt(()=>{a?.(),o?.disconnect()}),Qe(()=>e.track.id,()=>{c()}),(f,p)=>(le(),ge("canvas",{ref_key:"canvasRef",ref:s,class:"track-canvas"},null,512))}}),[["styles",[".track-canvas[data-v-cc5f2a97]{display:block;width:100%;height:100%}"]],["__scopeId","data-v-cc5f2a97"]]),S0={key:0,class:"track-row"},k0={class:"name-cell"},C0=["checked"],T0={class:"track-name"},E0={class:"canvas-cell"},A0=lt(st({__name:"TrackRow",props:{trackId:{type:String}},setup(n){Dt(d=>({v016f8515:_e(Tf)+"px",v550cf894:_e($n)+"px",c78e3d76:_e(Uf),ec6eb3d0:_e(jf)+"px",v3d17192d:_e(Vf)}));const e=n,t=Mt("core"),s=Mt("windowStart"),i=Mt("windowEnd"),r=Mt("selectedTrackIdsForEdit"),a=Mt("toggleTrackSelection"),o=Pe(()=>t.getTrackById(e.trackId)),l=Pe(()=>r.value.has(e.trackId));function c(){a(e.trackId)}return(d,h)=>o.value?(le(),ge("div",S0,[U("div",k0,[U("input",{type:"checkbox",checked:l.value,onChange:c,class:"track-checkbox",title:"Select for editing"},null,40,C0),U("span",T0,St(o.value.def.name),1)]),U("div",E0,[We(x0,{track:o.value,"window-start":_e(s),"window-end":_e(i)},null,8,["track","window-start","window-end"])])])):Ue("",!0)}}),[["styles",[".track-row[data-v-0d629af0]{display:flex;height:var(--v016f8515);border-bottom:1px solid #2a2d30}.name-cell[data-v-0d629af0]{width:var(--v550cf894);min-width:var(--v550cf894);background:var(--c78e3d76);padding:0 8px;display:flex;align-items:center;gap:8px;overflow:hidden}.track-checkbox[data-v-0d629af0]{flex-shrink:0;width:14px;height:14px;accent-color:#3a7ca5;cursor:pointer}.track-name[data-v-0d629af0]{font-size:var(--ec6eb3d0);color:var(--v3d17192d);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.canvas-cell[data-v-0d629af0]{flex:1;position:relative;overflow:hidden}"]],["__scopeId","data-v-0d629af0"]]),R0={class:"track-list"},I0={key:0,class:"empty-message"},P0=lt(st({__name:"TrackList",props:{trackIds:{type:Array}},setup(n){return(e,t)=>(le(),ge("div",R0,[(le(!0),ge(He,null,hn(n.trackIds,s=>(le(),fn(A0,{key:s,"track-id":s},null,8,["track-id"]))),128)),n.trackIds.length===0?(le(),ge("div",I0," No tracks ")):Ue("",!0)]))}}),[["styles",[".track-list[data-v-42782366]{display:flex;flex-direction:column}.empty-message[data-v-42782366]{padding:20px;text-align:center;color:#666;font-size:14px}"]],["__scopeId","data-v-42782366"]]),yc=lt(st({__name:"Playhead",props:{currentTime:{type:Number},windowStart:{type:Number},windowEnd:{type:Number},canvasWidth:{type:Number},leftOffset:{type:Number}},setup(n){Dt(i=>({b6b65ffe:_e(Lf)+"px",v3853aac9:_e(Nf)}));const e=n,t=Pe(()=>e.currentTime>=e.windowStart&&e.currentTime<=e.windowEnd),s=Pe(()=>e.leftOffset+_n(e.currentTime,e.windowStart,e.windowEnd,e.canvasWidth));return(i,r)=>t.value?(le(),ge("div",{key:0,class:"playhead",style:Pn({left:s.value+"px"})},null,4)):Ue("",!0)}}),[["styles",[".playhead[data-v-8443aa99]{position:absolute;top:0;bottom:0;width:var(--b6b65ffe);background:var(--v3853aac9);pointer-events:none;z-index:10;transform:translate(-50%)}"]],["__scopeId","data-v-8443aa99"]]);let M0=0;function O0(){return`toast_${++M0}`}const hs=me([]);function bc(){function n(a,o="info",l){const c=O0(),d={id:c,message:a,type:o,duration:l??a0};return hs.value.push(d),hs.value.length>o0&&hs.value.shift(),d.duration&&d.duration>0&&setTimeout(()=>{e(c)},d.duration),c}function e(a){const o=hs.value.findIndex(l=>l.id===a);o!==-1&&hs.value.splice(o,1)}function t(a,o){return n(a,"info",o)}function s(a,o){return n(a,"warning",o)}function i(a,o){return n(a,"error",o)}function r(a,o){return n(a,"success",o)}return{toasts:hs,addToast:n,removeToast:e,info:t,warning:s,error:i,success:r}}const N0={class:"edit-sidebar"},L0={key:0,class:"track-section"},D0={class:"track-list"},G0=["onClick"],F0={class:"track-row"},B0={class:"track-name"},H0=["onClick"],$0={key:0,class:"bounds-row"},W0=["value","onChange"],U0=["value","onChange"],V0={key:1,class:"track-section"},j0={class:"track-list"},z0=["onClick"],Y0={class:"track-row"},X0={class:"track-name"},K0=["onClick"],Z0={key:2,class:"track-section"},q0={class:"track-list"},J0=["onClick"],Q0={class:"track-row"},ep={class:"track-name"},tp=["onClick"],np={key:3,class:"empty-message"},sp=lt(st({__name:"EditSidebar",props:{tracks:{type:Array},editEnabledTrackIds:{type:Set},frontTrackIdByType:{type:Object}},emits:["action"],setup(n,{emit:e}){Dt(p=>({b09c4f52:_e(e0),v0a68f5ba:_e(i0)+"px",v08389d67:_e(t0),v1f68e844:_e(n0),v473f0449:_e(s0)}));const t=n,s=e,i=Pe(()=>t.tracks.filter(p=>p.def.fieldType==="number"&&t.editEnabledTrackIds.has(p.id))),r=Pe(()=>t.tracks.filter(p=>p.def.fieldType==="enum"&&t.editEnabledTrackIds.has(p.id))),a=Pe(()=>t.tracks.filter(p=>p.def.fieldType==="func"&&t.editEnabledTrackIds.has(p.id)));function o(p){return t.frontTrackIdByType[p.def.fieldType]===p.id}function l(p){s("action",{type:"TRACK/SET_FRONT",fieldType:p.def.fieldType,trackId:p.id})}function c(p){confirm("Delete this track?")&&s("action",{type:"TRACK/DELETE",trackId:p})}function d(p,m,v){s("action",{type:"TRACK/SET_BOUNDS",trackId:p,low:m,high:v})}function h(p,m){const v=parseFloat(m.target.value);!isNaN(v)&&v<p.high&&d(p.id,v,p.high)}function u(p,m){const v=parseFloat(m.target.value);!isNaN(v)&&v>p.low&&d(p.id,p.low,v)}const f=Pe(()=>t.editEnabledTrackIds.size===0);return(p,m)=>(le(),ge("div",N0,[i.value.length>0?(le(),ge("div",L0,[m[2]||(m[2]=U("div",{class:"section-header"},"Number Tracks",-1)),U("div",D0,[(le(!0),ge(He,null,hn(i.value,v=>(le(),ge("div",{key:v.id,class:Mn(["track-item",{"track-front":o(v)}]),onClick:S=>l(v)},[U("div",F0,[U("span",B0,St(v.def.name),1),U("button",{class:"delete-btn",onClick:Bs(S=>c(v.id),["stop"]),title:"Delete track"},"",8,H0)]),o(v)?(le(),ge("div",$0,[U("label",null,[m[0]||(m[0]=U("span",{class:"bounds-label"},"Low",-1)),U("input",{type:"number",value:v.low,step:"0.1",onChange:S=>h(v,S),class:"bounds-input"},null,40,W0)]),U("label",null,[m[1]||(m[1]=U("span",{class:"bounds-label"},"High",-1)),U("input",{type:"number",value:v.high,step:"0.1",onChange:S=>u(v,S),class:"bounds-input"},null,40,U0)])])):Ue("",!0)],10,G0))),128))])])):Ue("",!0),r.value.length>0?(le(),ge("div",V0,[m[3]||(m[3]=U("div",{class:"section-header"},"Enum Tracks",-1)),U("div",j0,[(le(!0),ge(He,null,hn(r.value,v=>(le(),ge("div",{key:v.id,class:Mn(["track-item",{"track-front":o(v)}]),onClick:S=>l(v)},[U("div",Y0,[U("span",X0,St(v.def.name),1),U("button",{class:"delete-btn",onClick:Bs(S=>c(v.id),["stop"]),title:"Delete track"},"",8,K0)])],10,z0))),128))])])):Ue("",!0),a.value.length>0?(le(),ge("div",Z0,[m[4]||(m[4]=U("div",{class:"section-header"},"Func Tracks",-1)),U("div",q0,[(le(!0),ge(He,null,hn(a.value,v=>(le(),ge("div",{key:v.id,class:Mn(["track-item",{"track-front":o(v)}]),onClick:S=>l(v)},[U("div",Q0,[U("span",ep,St(v.def.name),1),U("button",{class:"delete-btn",onClick:Bs(S=>c(v.id),["stop"]),title:"Delete track"},"",8,tp)])],10,J0))),128))])])):Ue("",!0),f.value?(le(),ge("div",np," Select tracks in view mode ")):Ue("",!0)]))}}),[["styles",[".edit-sidebar[data-v-a8f8913f]{flex:1;background:var(--b09c4f52);display:flex;flex-direction:column;overflow:hidden}.track-section[data-v-a8f8913f]{border-bottom:1px solid #2a2d30;display:flex;flex-direction:column;min-height:0}.section-header[data-v-a8f8913f]{padding:8px 12px 6px;font-size:10px;font-weight:600;color:#666;text-transform:uppercase;letter-spacing:1px;flex-shrink:0}.track-list[data-v-a8f8913f]{max-height:var(--v0a68f5ba);overflow-y:auto;overflow-x:hidden}.track-item[data-v-a8f8913f]{padding:8px 12px;background:var(--v08389d67);cursor:pointer;transition:background .15s ease;border-left:3px solid transparent}.track-item[data-v-a8f8913f]:hover{background:var(--v1f68e844)}.track-item.track-front[data-v-a8f8913f]{background:var(--v473f0449);border-left-color:#3a7ca5}.track-row[data-v-a8f8913f]{display:flex;align-items:center;gap:8px}.track-name[data-v-a8f8913f]{flex:1;font-size:12px;color:silver;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.track-front .track-name[data-v-a8f8913f]{color:#e0e0e0}.delete-btn[data-v-a8f8913f]{flex-shrink:0;width:18px;height:18px;padding:0;background:transparent;border:none;color:#555;font-size:14px;cursor:pointer;border-radius:3px;opacity:0;transition:all .15s ease}.track-item:hover .delete-btn[data-v-a8f8913f]{opacity:1}.delete-btn[data-v-a8f8913f]:hover{background:#dc2626;color:#fff}.bounds-row[data-v-a8f8913f]{display:flex;gap:12px;margin-top:8px}.bounds-row label[data-v-a8f8913f]{display:flex;align-items:center;gap:6px}.bounds-label[data-v-a8f8913f]{font-size:10px;color:#666;text-transform:uppercase;letter-spacing:.5px}.bounds-input[data-v-a8f8913f]{width:56px;padding:4px 6px;background:#1a1c20;border:1px solid #2a2d30;border-radius:3px;color:#c8c8c8;font-size:11px;transition:border-color .15s ease}.bounds-input[data-v-a8f8913f]:focus{outline:none;border-color:#3a7ca5}.empty-message[data-v-a8f8913f]{padding:24px 16px;text-align:center;color:#555;font-size:12px}"]],["__scopeId","data-v-a8f8913f"]]),ip=Math.PI/180;function rp(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}const Wn=typeof global<"u"?global:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},X={_global:Wn,version:"10.0.12",isBrowser:rp(),isUnminified:/param/.test(function(n){}.toString()),dblClickWindow:400,getAngle(n){return X.angleDeg?n*ip:n},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_renderBackend:"web",legacyTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return X.DD.isDragging},isTransforming(){var n,e;return(e=(n=X.Transformer)===null||n===void 0?void 0:n.isTransforming())!==null&&e!==void 0?e:!1},isDragReady(){return!!X.DD.node},releaseCanvasOnDestroy:!0,document:Wn.document,_injectGlobal(n){typeof Wn.Konva<"u"&&console.error("Several Konva instances detected. It is not recommended to use multiple Konva instances in the same environment."),Wn.Konva=n}},Be=n=>{X[n.prototype.getClassName()]=n};X._injectGlobal(X);const ap=`Konva.js unsupported environment.

Looks like you are trying to use Konva.js in Node.js environment. because "document" object is undefined.

To use Konva.js in Node.js environment, you need to use the "canvas-backend" or "skia-backend" module.

bash: npm install canvas
js: import "konva/canvas-backend";

or

bash: npm install skia-canvas
js: import "konva/skia-backend";
`,wc=()=>{if(typeof document>"u")throw new Error(ap)};class ct{constructor(e=[1,0,0,1,0,0]){this.dirty=!1,this.m=e&&e.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new ct(this.m)}copyInto(e){e.m[0]=this.m[0],e.m[1]=this.m[1],e.m[2]=this.m[2],e.m[3]=this.m[3],e.m[4]=this.m[4],e.m[5]=this.m[5]}point(e){const t=this.m;return{x:t[0]*e.x+t[2]*e.y+t[4],y:t[1]*e.x+t[3]*e.y+t[5]}}translate(e,t){return this.m[4]+=this.m[0]*e+this.m[2]*t,this.m[5]+=this.m[1]*e+this.m[3]*t,this}scale(e,t){return this.m[0]*=e,this.m[1]*=e,this.m[2]*=t,this.m[3]*=t,this}rotate(e){const t=Math.cos(e),s=Math.sin(e),i=this.m[0]*t+this.m[2]*s,r=this.m[1]*t+this.m[3]*s,a=this.m[0]*-s+this.m[2]*t,o=this.m[1]*-s+this.m[3]*t;return this.m[0]=i,this.m[1]=r,this.m[2]=a,this.m[3]=o,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(e,t){const s=this.m[0]+this.m[2]*t,i=this.m[1]+this.m[3]*t,r=this.m[2]+this.m[0]*e,a=this.m[3]+this.m[1]*e;return this.m[0]=s,this.m[1]=i,this.m[2]=r,this.m[3]=a,this}multiply(e){const t=this.m[0]*e.m[0]+this.m[2]*e.m[1],s=this.m[1]*e.m[0]+this.m[3]*e.m[1],i=this.m[0]*e.m[2]+this.m[2]*e.m[3],r=this.m[1]*e.m[2]+this.m[3]*e.m[3],a=this.m[0]*e.m[4]+this.m[2]*e.m[5]+this.m[4],o=this.m[1]*e.m[4]+this.m[3]*e.m[5]+this.m[5];return this.m[0]=t,this.m[1]=s,this.m[2]=i,this.m[3]=r,this.m[4]=a,this.m[5]=o,this}invert(){const e=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),t=this.m[3]*e,s=-this.m[1]*e,i=-this.m[2]*e,r=this.m[0]*e,a=e*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),o=e*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=t,this.m[1]=s,this.m[2]=i,this.m[3]=r,this.m[4]=a,this.m[5]=o,this}getMatrix(){return this.m}decompose(){const e=this.m[0],t=this.m[1],s=this.m[2],i=this.m[3],r=this.m[4],a=this.m[5],o=e*i-t*s,l={x:r,y:a,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(e!=0||t!=0){const c=Math.sqrt(e*e+t*t);l.rotation=t>0?Math.acos(e/c):-Math.acos(e/c),l.scaleX=c,l.scaleY=o/c,l.skewX=(e*s+t*i)/o,l.skewY=0}else if(s!=0||i!=0){const c=Math.sqrt(s*s+i*i);l.rotation=Math.PI/2-(i>0?Math.acos(-s/c):-Math.acos(s/c)),l.scaleX=o/c,l.scaleY=c,l.skewX=0,l.skewY=(e*s+t*i)/o}return l.rotation=E._getRotation(l.rotation),l}}const op="[object Array]",lp="[object Number]",cp="[object String]",dp="[object Boolean]",hp=Math.PI/180,up=180/Math.PI,Ws="#",fp="",pp="0",gp="Konva warning: ",xc="Konva error: ",mp="rgb(",_a={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},_p=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let ji=[],Us=null;const vp=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(n){setTimeout(n,60)},E={_isElement(n){return!!(n&&n.nodeType==1)},_isFunction(n){return!!(n&&n.constructor&&n.call&&n.apply)},_isPlainObject(n){return!!n&&n.constructor===Object},_isArray(n){return Object.prototype.toString.call(n)===op},_isNumber(n){return Object.prototype.toString.call(n)===lp&&!isNaN(n)&&isFinite(n)},_isString(n){return Object.prototype.toString.call(n)===cp},_isBoolean(n){return Object.prototype.toString.call(n)===dp},isObject(n){return n instanceof Object},isValidSelector(n){if(typeof n!="string")return!1;const e=n[0];return e==="#"||e==="."||e===e.toUpperCase()},_sign(n){return n===0||n>0?1:-1},requestAnimFrame(n){ji.push(n),ji.length===1&&vp(function(){const e=ji;ji=[],e.forEach(function(t){t()})})},createCanvasElement(){wc();const n=document.createElement("canvas");try{n.style=n.style||{}}catch{}return n},createImageElement(){return wc(),document.createElement("img")},_isInDocument(n){for(;n=n.parentNode;)if(n==document)return!0;return!1},_urlToImage(n,e){const t=E.createImageElement();t.onload=function(){e(t)},t.src=n},_rgbToHex(n,e,t){return((1<<24)+(n<<16)+(e<<8)+t).toString(16).slice(1)},_hexToRgb(n){n=n.replace(Ws,fp);const e=parseInt(n,16);return{r:e>>16&255,g:e>>8&255,b:e&255}},getRandomColor(){let n=(Math.random()*16777215<<0).toString(16);for(;n.length<6;)n=pp+n;return Ws+n},isCanvasFarblingActive(){if(Us!==null)return Us;if(typeof document>"u")return Us=!1,!1;const n=this.createCanvasElement();n.width=10,n.height=10;const e=n.getContext("2d",{willReadFrequently:!0});e.clearRect(0,0,10,10),e.fillStyle="#282828",e.fillRect(0,0,10,10);const t=e.getImageData(0,0,10,10).data;let s=!1;for(let i=0;i<100;i++)if(t[i*4]!==40||t[i*4+1]!==40||t[i*4+2]!==40||t[i*4+3]!==255){s=!0;break}return Us=s,this.releaseCanvas(n),Us},getHitColor(){const n=this.getRandomColor();return this.isCanvasFarblingActive()?this.getSnappedHexColor(n):n},getHitColorKey(n,e,t){return this.isCanvasFarblingActive()&&(n=Math.round(n/5)*5,e=Math.round(e/5)*5,t=Math.round(t/5)*5),Ws+this._rgbToHex(n,e,t)},getSnappedHexColor(n){const e=this._hexToRgb(n);return Ws+this._rgbToHex(Math.round(e.r/5)*5,Math.round(e.g/5)*5,Math.round(e.b/5)*5)},getRGB(n){let e;return n in _a?(e=_a[n],{r:e[0],g:e[1],b:e[2]}):n[0]===Ws?this._hexToRgb(n.substring(1)):n.substr(0,4)===mp?(e=_p.exec(n.replace(/ /g,"")),{r:parseInt(e[1],10),g:parseInt(e[2],10),b:parseInt(e[3],10)}):{r:0,g:0,b:0}},colorToRGBA(n){return n=n||"black",E._namedColorToRBA(n)||E._hex3ColorToRGBA(n)||E._hex4ColorToRGBA(n)||E._hex6ColorToRGBA(n)||E._hex8ColorToRGBA(n)||E._rgbColorToRGBA(n)||E._rgbaColorToRGBA(n)||E._hslColorToRGBA(n)},_namedColorToRBA(n){const e=_a[n.toLowerCase()];return e?{r:e[0],g:e[1],b:e[2],a:1}:null},_rgbColorToRGBA(n){if(n.indexOf("rgb(")===0){n=n.match(/rgb\(([^)]+)\)/)[1];const e=n.split(/ *, */).map(Number);return{r:e[0],g:e[1],b:e[2],a:1}}},_rgbaColorToRGBA(n){if(n.indexOf("rgba(")===0){n=n.match(/rgba\(([^)]+)\)/)[1];const e=n.split(/ *, */).map((t,s)=>t.slice(-1)==="%"?s===3?parseInt(t)/100:parseInt(t)/100*255:Number(t));return{r:e[0],g:e[1],b:e[2],a:e[3]}}},_hex8ColorToRGBA(n){if(n[0]==="#"&&n.length===9)return{r:parseInt(n.slice(1,3),16),g:parseInt(n.slice(3,5),16),b:parseInt(n.slice(5,7),16),a:parseInt(n.slice(7,9),16)/255}},_hex6ColorToRGBA(n){if(n[0]==="#"&&n.length===7)return{r:parseInt(n.slice(1,3),16),g:parseInt(n.slice(3,5),16),b:parseInt(n.slice(5,7),16),a:1}},_hex4ColorToRGBA(n){if(n[0]==="#"&&n.length===5)return{r:parseInt(n[1]+n[1],16),g:parseInt(n[2]+n[2],16),b:parseInt(n[3]+n[3],16),a:parseInt(n[4]+n[4],16)/255}},_hex3ColorToRGBA(n){if(n[0]==="#"&&n.length===4)return{r:parseInt(n[1]+n[1],16),g:parseInt(n[2]+n[2],16),b:parseInt(n[3]+n[3],16),a:1}},_hslColorToRGBA(n){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(n)){const[e,...t]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(n),s=Number(t[0])/360,i=Number(t[1])/100,r=Number(t[2])/100;let a,o,l;if(i===0)return l=r*255,{r:Math.round(l),g:Math.round(l),b:Math.round(l),a:1};r<.5?a=r*(1+i):a=r+i-r*i;const c=2*r-a,d=[0,0,0];for(let h=0;h<3;h++)o=s+1/3*-(h-1),o<0&&o++,o>1&&o--,6*o<1?l=c+(a-c)*6*o:2*o<1?l=a:3*o<2?l=c+(a-c)*(2/3-o)*6:l=c,d[h]=l*255;return{r:Math.round(d[0]),g:Math.round(d[1]),b:Math.round(d[2]),a:1}}},haveIntersection(n,e){return!(e.x>n.x+n.width||e.x+e.width<n.x||e.y>n.y+n.height||e.y+e.height<n.y)},cloneObject(n){const e={};for(const t in n)this._isPlainObject(n[t])?e[t]=this.cloneObject(n[t]):this._isArray(n[t])?e[t]=this.cloneArray(n[t]):e[t]=n[t];return e},cloneArray(n){return n.slice(0)},degToRad(n){return n*hp},radToDeg(n){return n*up},_degToRad(n){return E.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),E.degToRad(n)},_radToDeg(n){return E.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),E.radToDeg(n)},_getRotation(n){return X.angleDeg?E.radToDeg(n):n},_capitalize(n){return n.charAt(0).toUpperCase()+n.slice(1)},throw(n){throw new Error(xc+n)},error(n){console.error(xc+n)},warn(n){X.showWarnings&&console.warn(gp+n)},each(n,e){for(const t in n)e(t,n[t])},_inRange(n,e,t){return e<=n&&n<t},_getProjectionToSegment(n,e,t,s,i,r){let a,o,l;const c=(n-t)*(n-t)+(e-s)*(e-s);if(c==0)a=n,o=e,l=(i-t)*(i-t)+(r-s)*(r-s);else{const d=((i-n)*(t-n)+(r-e)*(s-e))/c;d<0?(a=n,o=e,l=(n-i)*(n-i)+(e-r)*(e-r)):d>1?(a=t,o=s,l=(t-i)*(t-i)+(s-r)*(s-r)):(a=n+d*(t-n),o=e+d*(s-e),l=(a-i)*(a-i)+(o-r)*(o-r))}return[a,o,l]},_getProjectionToLine(n,e,t){const s=E.cloneObject(n);let i=Number.MAX_VALUE;return e.forEach(function(r,a){if(!t&&a===e.length-1)return;const o=e[(a+1)%e.length],l=E._getProjectionToSegment(r.x,r.y,o.x,o.y,n.x,n.y),c=l[0],d=l[1],h=l[2];h<i&&(s.x=c,s.y=d,i=h)}),s},_prepareArrayForTween(n,e,t){const s=[],i=[];if(n.length>e.length){const a=e;e=n,n=a}for(let a=0;a<n.length;a+=2)s.push({x:n[a],y:n[a+1]});for(let a=0;a<e.length;a+=2)i.push({x:e[a],y:e[a+1]});const r=[];return i.forEach(function(a){const o=E._getProjectionToLine(a,s,t);r.push(o.x),r.push(o.y)}),r},_prepareToStringify(n){let e;n.visitedByCircularReferenceRemoval=!0;for(const t in n)if(n.hasOwnProperty(t)&&n[t]&&typeof n[t]=="object"){if(e=Object.getOwnPropertyDescriptor(n,t),n[t].visitedByCircularReferenceRemoval||E._isElement(n[t]))if(e.configurable)delete n[t];else return null;else if(E._prepareToStringify(n[t])===null)if(e.configurable)delete n[t];else return null}return delete n.visitedByCircularReferenceRemoval,n},_assign(n,e){for(const t in e)n[t]=e[t];return n},_getFirstPointerId(n){return n.touches?n.changedTouches[0].identifier:n.pointerId||999},releaseCanvas(...n){X.releaseCanvasOnDestroy&&n.forEach(e=>{e.width=0,e.height=0})},drawRoundedRectPath(n,e,t,s){let i=e<0?e:0,r=t<0?t:0;e=Math.abs(e),t=Math.abs(t);let a=0,o=0,l=0,c=0;typeof s=="number"?a=o=l=c=Math.min(s,e/2,t/2):(a=Math.min(s[0]||0,e/2,t/2),o=Math.min(s[1]||0,e/2,t/2),c=Math.min(s[2]||0,e/2,t/2),l=Math.min(s[3]||0,e/2,t/2)),n.moveTo(i+a,r),n.lineTo(i+e-o,r),n.arc(i+e-o,r+o,o,Math.PI*3/2,0,!1),n.lineTo(i+e,r+t-c),n.arc(i+e-c,r+t-c,c,0,Math.PI/2,!1),n.lineTo(i+l,r+t),n.arc(i+l,r+t-l,l,Math.PI/2,Math.PI,!1),n.lineTo(i,r+a),n.arc(i+a,r+a,a,Math.PI,Math.PI*3/2,!1)},drawRoundedPolygonPath(n,e,t,s,i){s=Math.abs(s);for(let r=0;r<t;r++){const a=e[(r-1+t)%t],o=e[r],l=e[(r+1)%t],c={x:o.x-a.x,y:o.y-a.y},d={x:l.x-o.x,y:l.y-o.y},h=Math.hypot(c.x,c.y),u=Math.hypot(d.x,d.y);let f;typeof i=="number"?f=i:f=r<i.length?i[r]:0,f=s*Math.cos(Math.PI/t)*Math.min(1,f/s*2);const m={x:c.x/h,y:c.y/h},v={x:d.x/u,y:d.y/u},S={x:o.x-m.x*f,y:o.y-m.y*f},k={x:o.x+v.x*f,y:o.y+v.y*f};r===0?n.moveTo(S.x,S.y):n.lineTo(S.x,S.y),n.arcTo(o.x,o.y,k.x,k.y,f)}}};function yp(n){const e=[],t=n.length,s=E;for(let i=0;i<t;i++){let r=n[i];s._isNumber(r)?r=Math.round(r*1e3)/1e3:s._isString(r)||(r=r+""),e.push(r)}return e}const Sc=",",bp="(",wp=")",xp="([",Sp="])",kp=";",Cp="()",Tp="=",kc=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],Ep=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled","filter"],Ap=100;let zi=null;function Cc(){if(zi!==null)return zi;try{const e=E.createCanvasElement().getContext("2d");return e?!!e&&"filter"in e:(zi=!1,!1)}catch{return zi=!1,!1}}class Yi{constructor(e){this.canvas=e,X.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(e){e.fillEnabled()&&this._fill(e)}_fill(e){}strokeShape(e){e.hasStroke()&&this._stroke(e)}_stroke(e){}fillStrokeShape(e){e.attrs.fillAfterStrokeEnabled?(this.strokeShape(e),this.fillShape(e)):(this.fillShape(e),this.strokeShape(e))}getTrace(e,t){let s=this.traceArr,i=s.length,r="",a,o,l,c;for(a=0;a<i;a++)o=s[a],l=o.method,l?(c=o.args,r+=l,e?r+=Cp:E._isArray(c[0])?r+=xp+c.join(Sc)+Sp:(t&&(c=c.map(d=>typeof d=="number"?Math.floor(d):d)),r+=bp+c.join(Sc)+wp)):(r+=o.property,e||(r+=Tp+o.val)),r+=kp;return r}clearTrace(){this.traceArr=[]}_trace(e){let t=this.traceArr,s;t.push(e),s=t.length,s>=Ap&&t.shift()}reset(){const e=this.getCanvas().getPixelRatio();this.setTransform(1*e,0,0,1*e,0,0)}getCanvas(){return this.canvas}clear(e){const t=this.getCanvas();e?this.clearRect(e.x||0,e.y||0,e.width||0,e.height||0):this.clearRect(0,0,t.getWidth()/t.pixelRatio,t.getHeight()/t.pixelRatio)}_applyLineCap(e){const t=e.attrs.lineCap;t&&this.setAttr("lineCap",t)}_applyOpacity(e){const t=e.getAbsoluteOpacity();t!==1&&this.setAttr("globalAlpha",t)}_applyLineJoin(e){const t=e.attrs.lineJoin;t&&this.setAttr("lineJoin",t)}_applyMiterLimit(e){const t=e.attrs.miterLimit;t!=null&&this.setAttr("miterLimit",t)}setAttr(e,t){this._context[e]=t}arc(e,t,s,i,r,a){this._context.arc(e,t,s,i,r,a)}arcTo(e,t,s,i,r){this._context.arcTo(e,t,s,i,r)}beginPath(){this._context.beginPath()}bezierCurveTo(e,t,s,i,r,a){this._context.bezierCurveTo(e,t,s,i,r,a)}clearRect(e,t,s,i){this._context.clearRect(e,t,s,i)}clip(...e){this._context.clip.apply(this._context,e)}closePath(){this._context.closePath()}createImageData(e,t){const s=arguments;if(s.length===2)return this._context.createImageData(e,t);if(s.length===1)return this._context.createImageData(e)}createLinearGradient(e,t,s,i){return this._context.createLinearGradient(e,t,s,i)}createPattern(e,t){return this._context.createPattern(e,t)}createRadialGradient(e,t,s,i,r,a){return this._context.createRadialGradient(e,t,s,i,r,a)}drawImage(e,t,s,i,r,a,o,l,c){const d=arguments,h=this._context;d.length===3?h.drawImage(e,t,s):d.length===5?h.drawImage(e,t,s,i,r):d.length===9&&h.drawImage(e,t,s,i,r,a,o,l,c)}ellipse(e,t,s,i,r,a,o,l){this._context.ellipse(e,t,s,i,r,a,o,l)}isPointInPath(e,t,s,i){return s?this._context.isPointInPath(s,e,t,i):this._context.isPointInPath(e,t,i)}fill(...e){this._context.fill.apply(this._context,e)}fillRect(e,t,s,i){this._context.fillRect(e,t,s,i)}strokeRect(e,t,s,i){this._context.strokeRect(e,t,s,i)}fillText(e,t,s,i){i?this._context.fillText(e,t,s,i):this._context.fillText(e,t,s)}measureText(e){return this._context.measureText(e)}getImageData(e,t,s,i){return this._context.getImageData(e,t,s,i)}lineTo(e,t){this._context.lineTo(e,t)}moveTo(e,t){this._context.moveTo(e,t)}rect(e,t,s,i){this._context.rect(e,t,s,i)}roundRect(e,t,s,i,r){this._context.roundRect(e,t,s,i,r)}putImageData(e,t,s){this._context.putImageData(e,t,s)}quadraticCurveTo(e,t,s,i){this._context.quadraticCurveTo(e,t,s,i)}restore(){this._context.restore()}rotate(e){this._context.rotate(e)}save(){this._context.save()}scale(e,t){this._context.scale(e,t)}setLineDash(e){this._context.setLineDash?this._context.setLineDash(e):"mozDash"in this._context?this._context.mozDash=e:"webkitLineDash"in this._context&&(this._context.webkitLineDash=e)}getLineDash(){return this._context.getLineDash()}setTransform(e,t,s,i,r,a){this._context.setTransform(e,t,s,i,r,a)}stroke(e){e?this._context.stroke(e):this._context.stroke()}strokeText(e,t,s,i){this._context.strokeText(e,t,s,i)}transform(e,t,s,i,r,a){this._context.transform(e,t,s,i,r,a)}translate(e,t){this._context.translate(e,t)}_enableTrace(){let e=this,t=kc.length,s=this.setAttr,i,r;const a=function(o){let l=e[o],c;e[o]=function(){return r=yp(Array.prototype.slice.call(arguments,0)),c=l.apply(e,arguments),e._trace({method:o,args:r}),c}};for(i=0;i<t;i++)a(kc[i]);e.setAttr=function(){s.apply(e,arguments);const o=arguments[0];let l=arguments[1];(o==="shadowOffsetX"||o==="shadowOffsetY"||o==="shadowBlur")&&(l=l/this.canvas.getPixelRatio()),e._trace({property:o,val:l})}}_applyGlobalCompositeOperation(e){const t=e.attrs.globalCompositeOperation;!t||t==="source-over"||this.setAttr("globalCompositeOperation",t)}}Ep.forEach(function(n){Object.defineProperty(Yi.prototype,n,{get(){return this._context[n]},set(e){this._context[n]=e}})});class Rp extends Yi{constructor(e,{willReadFrequently:t=!1}={}){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:t})}_fillColor(e){const t=e.fill();this.setAttr("fillStyle",t),e._fillFunc(this)}_fillPattern(e){this.setAttr("fillStyle",e._getFillPattern()),e._fillFunc(this)}_fillLinearGradient(e){const t=e._getLinearGradient();t&&(this.setAttr("fillStyle",t),e._fillFunc(this))}_fillRadialGradient(e){const t=e._getRadialGradient();t&&(this.setAttr("fillStyle",t),e._fillFunc(this))}_fill(e){const t=e.fill(),s=e.getFillPriority();if(t&&s==="color"){this._fillColor(e);return}const i=e.getFillPatternImage();if(i&&s==="pattern"){this._fillPattern(e);return}const r=e.getFillLinearGradientColorStops();if(r&&s==="linear-gradient"){this._fillLinearGradient(e);return}const a=e.getFillRadialGradientColorStops();if(a&&s==="radial-gradient"){this._fillRadialGradient(e);return}t?this._fillColor(e):i?this._fillPattern(e):r?this._fillLinearGradient(e):a&&this._fillRadialGradient(e)}_strokeLinearGradient(e){const t=e.getStrokeLinearGradientStartPoint(),s=e.getStrokeLinearGradientEndPoint(),i=e.getStrokeLinearGradientColorStops(),r=this.createLinearGradient(t.x,t.y,s.x,s.y);if(i){for(let a=0;a<i.length;a+=2)r.addColorStop(i[a],i[a+1]);this.setAttr("strokeStyle",r)}}_stroke(e){const t=e.dash(),s=e.getStrokeScaleEnabled();if(e.hasStroke()){if(!s){this.save();const r=this.getCanvas().getPixelRatio();this.setTransform(r,0,0,r,0,0)}this._applyLineCap(e),t&&e.dashEnabled()&&(this.setLineDash(t),this.setAttr("lineDashOffset",e.dashOffset())),this.setAttr("lineWidth",e.strokeWidth()),e.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),e.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(e):this.setAttr("strokeStyle",e.stroke()),e._strokeFunc(this),s||this.restore()}}_applyShadow(e){var t,s,i;const r=(t=e.getShadowRGBA())!==null&&t!==void 0?t:"black",a=(s=e.getShadowBlur())!==null&&s!==void 0?s:5,o=(i=e.getShadowOffset())!==null&&i!==void 0?i:{x:0,y:0},l=e.getAbsoluteScale(),c=this.canvas.getPixelRatio(),d=l.x*c,h=l.y*c;this.setAttr("shadowColor",r),this.setAttr("shadowBlur",a*Math.min(Math.abs(d),Math.abs(h))),this.setAttr("shadowOffsetX",o.x*d),this.setAttr("shadowOffsetY",o.y*h)}}class Ip extends Yi{constructor(e){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:!0})}_fill(e){this.save(),this.setAttr("fillStyle",e.colorKey),e._fillFuncHit(this),this.restore()}strokeShape(e){e.hasHitStroke()&&this._stroke(e)}_stroke(e){if(e.hasHitStroke()){const t=e.getStrokeScaleEnabled();if(!t){this.save();const r=this.getCanvas().getPixelRatio();this.setTransform(r,0,0,r,0,0)}this._applyLineCap(e);const s=e.hitStrokeWidth(),i=s==="auto"?e.strokeWidth():s;this.setAttr("lineWidth",i),this.setAttr("strokeStyle",e.colorKey),e._strokeFuncHit(this),t||this.restore()}}}let Xi;function Pp(){if(Xi)return Xi;const n=E.createCanvasElement(),e=n.getContext("2d");return Xi=(function(){const t=X._global.devicePixelRatio||1,s=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return t/s})(),E.releaseCanvas(n),Xi}class va{constructor(e){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const s=(e||{}).pixelRatio||X.pixelRatio||Pp();this.pixelRatio=s,this._canvas=E.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(e){const t=this.pixelRatio;this.pixelRatio=e,this.setSize(this.getWidth()/t,this.getHeight()/t)}setWidth(e){this.width=this._canvas.width=e*this.pixelRatio,this._canvas.style.width=e+"px";const t=this.pixelRatio;this.getContext()._context.scale(t,t)}setHeight(e){this.height=this._canvas.height=e*this.pixelRatio,this._canvas.style.height=e+"px";const t=this.pixelRatio;this.getContext()._context.scale(t,t)}getWidth(){return this.width}getHeight(){return this.height}setSize(e,t){this.setWidth(e||0),this.setHeight(t||0)}toDataURL(e,t){try{return this._canvas.toDataURL(e,t)}catch{try{return this._canvas.toDataURL()}catch(i){return E.error("Unable to get data URL. "+i.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}class vn extends va{constructor(e={width:0,height:0,willReadFrequently:!1}){super(e),this.context=new Rp(this,{willReadFrequently:e.willReadFrequently}),this.setSize(e.width,e.height)}}class ya extends va{constructor(e={width:0,height:0}){super(e),this.hitCanvas=!0,this.context=new Ip(this),this.setSize(e.width,e.height)}}const Ce={get isDragging(){let n=!1;return Ce._dragElements.forEach(e=>{e.dragStatus==="dragging"&&(n=!0)}),n},justDragged:!1,get node(){let n;return Ce._dragElements.forEach(e=>{n=e.node}),n},_dragElements:new Map,_drag(n){const e=[];Ce._dragElements.forEach((t,s)=>{const{node:i}=t,r=i.getStage();r.setPointersPositions(n),t.pointerId===void 0&&(t.pointerId=E._getFirstPointerId(n));const a=r._changedPointerPositions.find(o=>o.id===t.pointerId);if(a){if(t.dragStatus!=="dragging"){const o=i.dragDistance();if(Math.max(Math.abs(a.x-t.startPointerPos.x),Math.abs(a.y-t.startPointerPos.y))<o||(i.startDrag({evt:n}),!i.isDragging()))return}i._setDragPosition(n,t),e.push(i)}}),e.forEach(t=>{t.fire("dragmove",{type:"dragmove",target:t,evt:n},!0)})},_endDragBefore(n){const e=[];Ce._dragElements.forEach(t=>{const{node:s}=t,i=s.getStage();if(n&&i.setPointersPositions(n),!i._changedPointerPositions.find(o=>o.id===t.pointerId))return;(t.dragStatus==="dragging"||t.dragStatus==="stopped")&&(Ce.justDragged=!0,X._mouseListenClick=!1,X._touchListenClick=!1,X._pointerListenClick=!1,t.dragStatus="stopped");const a=t.node.getLayer()||t.node instanceof X.Stage&&t.node;a&&e.indexOf(a)===-1&&e.push(a)}),e.forEach(t=>{t.draw()})},_endDragAfter(n){Ce._dragElements.forEach((e,t)=>{e.dragStatus==="stopped"&&e.node.fire("dragend",{type:"dragend",target:e.node,evt:n},!0),e.dragStatus!=="dragging"&&Ce._dragElements.delete(t)})}};X.isBrowser&&(window.addEventListener("mouseup",Ce._endDragBefore,!0),window.addEventListener("touchend",Ce._endDragBefore,!0),window.addEventListener("touchcancel",Ce._endDragBefore,!0),window.addEventListener("mousemove",Ce._drag),window.addEventListener("touchmove",Ce._drag),window.addEventListener("mouseup",Ce._endDragAfter,!1),window.addEventListener("touchend",Ce._endDragAfter,!1),window.addEventListener("touchcancel",Ce._endDragAfter,!1));function yn(n){return E._isString(n)?'"'+n+'"':Object.prototype.toString.call(n)==="[object Number]"||E._isBoolean(n)?n:Object.prototype.toString.call(n)}function Tc(n){return n>255?255:n<0?0:Math.round(n)}function Y(){if(X.isUnminified)return function(n,e){return E._isNumber(n)||E.warn(yn(n)+' is a not valid value for "'+e+'" attribute. The value should be a number.'),n}}function Ki(n){if(X.isUnminified)return function(e,t){let s=E._isNumber(e),i=E._isArray(e)&&e.length==n;return!s&&!i&&E.warn(yn(e)+' is a not valid value for "'+t+'" attribute. The value should be a number or Array<number>('+n+")"),e}}function ba(){if(X.isUnminified)return function(n,e){return E._isNumber(n)||n==="auto"||E.warn(yn(n)+' is a not valid value for "'+e+'" attribute. The value should be a number or "auto".'),n}}function Un(){if(X.isUnminified)return function(n,e){return E._isString(n)||E.warn(yn(n)+' is a not valid value for "'+e+'" attribute. The value should be a string.'),n}}function Ec(){if(X.isUnminified)return function(n,e){const t=E._isString(n),s=Object.prototype.toString.call(n)==="[object CanvasGradient]"||n&&n.addColorStop;return t||s||E.warn(yn(n)+' is a not valid value for "'+e+'" attribute. The value should be a string or a native gradient.'),n}}function Mp(){if(X.isUnminified)return function(n,e){const t=Int8Array?Object.getPrototypeOf(Int8Array):null;return t&&n instanceof t||(E._isArray(n)?n.forEach(function(s){E._isNumber(s)||E.warn('"'+e+'" attribute has non numeric element '+s+". Make sure that all elements are numbers.")}):E.warn(yn(n)+' is a not valid value for "'+e+'" attribute. The value should be a array of numbers.')),n}}function Et(){if(X.isUnminified)return function(n,e){return n===!0||n===!1||E.warn(yn(n)+' is a not valid value for "'+e+'" attribute. The value should be a boolean.'),n}}function Op(n){if(X.isUnminified)return function(e,t){return e==null||E.isObject(e)||E.warn(yn(e)+' is a not valid value for "'+t+'" attribute. The value should be an object with properties '+n),e}}const Vs="get",js="set",y={addGetterSetter(n,e,t,s,i){y.addGetter(n,e,t),y.addSetter(n,e,s,i),y.addOverloadedGetterSetter(n,e)},addGetter(n,e,t){const s=Vs+E._capitalize(e);n.prototype[s]=n.prototype[s]||function(){const i=this.attrs[e];return i===void 0?t:i}},addSetter(n,e,t,s){const i=js+E._capitalize(e);n.prototype[i]||y.overWriteSetter(n,e,t,s)},overWriteSetter(n,e,t,s){const i=js+E._capitalize(e);n.prototype[i]=function(r){return t&&r!==void 0&&r!==null&&(r=t.call(this,r,e)),this._setAttr(e,r),s&&s.call(this),this}},addComponentsGetterSetter(n,e,t,s,i){const r=t.length,a=E._capitalize,o=Vs+a(e),l=js+a(e);n.prototype[o]=function(){const d={};for(let h=0;h<r;h++){const u=t[h];d[u]=this.getAttr(e+a(u))}return d};const c=Op(t);n.prototype[l]=function(d){const h=this.attrs[e];s&&(d=s.call(this,d,e)),c&&c.call(this,d,e);for(const u in d)d.hasOwnProperty(u)&&this._setAttr(e+a(u),d[u]);return d||t.forEach(u=>{this._setAttr(e+a(u),void 0)}),this._fireChangeEvent(e,h,d),i&&i.call(this),this},y.addOverloadedGetterSetter(n,e)},addOverloadedGetterSetter(n,e){const t=E._capitalize(e),s=js+t,i=Vs+t;n.prototype[e]=function(){return arguments.length?(this[s](arguments[0]),this):this[i]()}},addDeprecatedGetterSetter(n,e,t,s){E.error("Adding deprecated "+e);const i=Vs+E._capitalize(e),r=e+" property is deprecated and will be removed soon. Look at Konva change log for more information.";n.prototype[i]=function(){E.error(r);const a=this.attrs[e];return a===void 0?t:a},y.addSetter(n,e,s,function(){E.error(r)}),y.addOverloadedGetterSetter(n,e)},backCompat(n,e){E.each(e,function(t,s){const i=n.prototype[s],r=Vs+E._capitalize(t),a=js+E._capitalize(t);function o(){i.apply(this,arguments),E.error('"'+t+'" method is deprecated and will be removed soon. Use ""'+s+'" instead.')}n.prototype[t]=o,n.prototype[r]=o,n.prototype[a]=o})},afterSetFilter(){this._filterUpToDate=!1}};function Np(n){const e=/(\w+)\(([^)]+)\)/g;let t;for(;(t=e.exec(n))!==null;){const[,s,i]=t;switch(s){case"blur":{const r=parseFloat(i.replace("px",""));return function(a){this.blurRadius(r*.5);const o=X.Filters;o&&o.Blur&&o.Blur.call(this,a)}}case"brightness":{const r=i.includes("%")?parseFloat(i)/100:parseFloat(i);return function(a){this.brightness(r);const o=X.Filters;o&&o.Brightness&&o.Brightness.call(this,a)}}case"contrast":{const r=parseFloat(i);return function(a){const o=100*(Math.sqrt(r)-1);this.contrast(o);const l=X.Filters;l&&l.Contrast&&l.Contrast.call(this,a)}}case"grayscale":return function(r){const a=X.Filters;a&&a.Grayscale&&a.Grayscale.call(this,r)};case"sepia":return function(r){const a=X.Filters;a&&a.Sepia&&a.Sepia.call(this,r)};case"invert":return function(r){const a=X.Filters;a&&a.Invert&&a.Invert.call(this,r)};default:E.warn(`CSS filter "${s}" is not supported in fallback mode. Consider using function filters for better compatibility.`);break}}return()=>{}}const Zi="absoluteOpacity",qi="allEventListeners",qt="absoluteTransform",Ac="absoluteScale",Vn="canvas",Lp="Change",Dp="children",Gp="konva",wa="listening",Fp="mouseenter",Bp="mouseleave",Hp="pointerenter",$p="pointerleave",Wp="touchenter",Up="touchleave",Rc="set",Ic="Shape",Ji=" ",Pc="stage",bn="transform",Vp="Stage",xa="visible",jp=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(Ji);let zp=1;class z{constructor(e){this._id=zp++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(e),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(e){(e===bn||e===qt)&&this._cache.get(e)?this._cache.get(e).dirty=!0:e?this._cache.delete(e):this._cache.clear()}_getCache(e,t){let s=this._cache.get(e);return(s===void 0||(e===bn||e===qt)&&s.dirty===!0)&&(s=t.call(this),this._cache.set(e,s)),s}_calculate(e,t,s){if(!this._attachedDepsListeners.get(e)){const i=t.map(r=>r+"Change.konva").join(Ji);this.on(i,()=>{this._clearCache(e)}),this._attachedDepsListeners.set(e,!0)}return this._getCache(e,s)}_getCanvasCache(){return this._cache.get(Vn)}_clearSelfAndDescendantCache(e){this._clearCache(e),e===qt&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(Vn)){const{scene:e,filter:t,hit:s,buffer:i}=this._cache.get(Vn);E.releaseCanvas(e,t,s,i),this._cache.delete(Vn)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(e){const t=e||{};let s={};(t.x===void 0||t.y===void 0||t.width===void 0||t.height===void 0)&&(s=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let i=Math.ceil(t.width||s.width),r=Math.ceil(t.height||s.height),a=t.pixelRatio,o=t.x===void 0?Math.floor(s.x):t.x,l=t.y===void 0?Math.floor(s.y):t.y,c=t.offset||0,d=t.drawBorder||!1,h=t.hitCanvasPixelRatio||1;if(!i||!r){E.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const u=Math.abs(Math.round(s.x)-o)>.5?1:0,f=Math.abs(Math.round(s.y)-l)>.5?1:0;i+=c*2+u,r+=c*2+f,o-=c,l-=c;const p=new vn({pixelRatio:a,width:i,height:r}),m=new vn({pixelRatio:a,width:0,height:0,willReadFrequently:!0}),v=new ya({pixelRatio:h,width:i,height:r}),S=p.getContext(),k=v.getContext(),b=new vn({width:p.width/p.pixelRatio+Math.abs(o),height:p.height/p.pixelRatio+Math.abs(l),pixelRatio:p.pixelRatio}),_=b.getContext();return v.isCache=!0,p.isCache=!0,this._cache.delete(Vn),this._filterUpToDate=!1,t.imageSmoothingEnabled===!1&&(p.getContext()._context.imageSmoothingEnabled=!1,m.getContext()._context.imageSmoothingEnabled=!1),S.save(),k.save(),_.save(),S.translate(-o,-l),k.translate(-o,-l),_.translate(-o,-l),b.x=o,b.y=l,this._isUnderCache=!0,this._clearSelfAndDescendantCache(Zi),this._clearSelfAndDescendantCache(Ac),this.drawScene(p,this,b),this.drawHit(v,this),this._isUnderCache=!1,S.restore(),k.restore(),d&&(S.save(),S.beginPath(),S.rect(0,0,i,r),S.closePath(),S.setAttr("strokeStyle","red"),S.setAttr("lineWidth",5),S.stroke(),S.restore()),this._cache.set(Vn,{scene:p,filter:m,hit:v,buffer:b,x:o,y:l}),this._requestDraw(),this}isCached(){return this._cache.has(Vn)}getClientRect(e){throw new Error('abstract "getClientRect" method call')}_transformedRect(e,t){const s=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}];let i=1/0,r=1/0,a=-1/0,o=-1/0;const l=this.getAbsoluteTransform(t);return s.forEach(function(c){const d=l.point(c);i===void 0&&(i=a=d.x,r=o=d.y),i=Math.min(i,d.x),r=Math.min(r,d.y),a=Math.max(a,d.x),o=Math.max(o,d.y)}),{x:i,y:r,width:a-i,height:o-r}}_drawCachedSceneCanvas(e){e.save(),e._applyOpacity(this),e._applyGlobalCompositeOperation(this);const t=this._getCanvasCache();e.translate(t.x,t.y);const s=this._getCachedSceneCanvas(),i=s.pixelRatio;e.drawImage(s._canvas,0,0,s.width/i,s.height/i),e.restore()}_drawCachedHitCanvas(e){const t=this._getCanvasCache(),s=t.hit;e.save(),e.translate(t.x,t.y),e.drawImage(s._canvas,0,0,s.width/s.pixelRatio,s.height/s.pixelRatio),e.restore()}_getCachedSceneCanvas(){let e=this.filters(),t=this._getCanvasCache(),s=t.scene,i=t.filter,r=i.getContext(),a,o,l,c;if(!e||e.length===0)return s;if(this._filterUpToDate)return i;let d=!0;for(let u=0;u<e.length;u++)if(typeof e[u]=="string"&&Cc(),typeof e[u]!="string"||!Cc()){d=!1;break}const h=s.pixelRatio;if(i.setSize(s.width/s.pixelRatio,s.height/s.pixelRatio),d){const u=e.join(" ");return r.save(),r.setAttr("filter",u),r.drawImage(s._canvas,0,0,s.getWidth()/h,s.getHeight()/h),r.restore(),this._filterUpToDate=!0,i}try{for(a=e.length,r.clear(),r.drawImage(s._canvas,0,0,s.getWidth()/h,s.getHeight()/h),o=r.getImageData(0,0,i.getWidth(),i.getHeight()),l=0;l<a;l++)c=e[l],typeof c=="string"&&(c=Np(c)),c.call(this,o),r.putImageData(o,0,0)}catch(u){E.error("Unable to apply filter. "+u.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}return this._filterUpToDate=!0,i}on(e,t){if(this._cache&&this._cache.delete(qi),arguments.length===3)return this._delegate.apply(this,arguments);const s=e.split(Ji);for(let i=0;i<s.length;i++){const a=s[i].split("."),o=a[0],l=a[1]||"";this.eventListeners[o]||(this.eventListeners[o]=[]),this.eventListeners[o].push({name:l,handler:t})}return this}off(e,t){let s=(e||"").split(Ji),i=s.length,r,a,o,l,c,d;if(this._cache&&this._cache.delete(qi),!e)for(a in this.eventListeners)this._off(a);for(r=0;r<i;r++)if(o=s[r],l=o.split("."),c=l[0],d=l[1],c)this.eventListeners[c]&&this._off(c,d,t);else for(a in this.eventListeners)this._off(a,d,t);return this}dispatchEvent(e){const t={target:this,type:e.type,evt:e};return this.fire(e.type,t),this}addEventListener(e,t){return this.on(e,function(s){t.call(this,s.evt)}),this}removeEventListener(e){return this.off(e),this}_delegate(e,t,s){const i=this;this.on(e,function(r){const a=r.target.findAncestors(t,!0,i);for(let o=0;o<a.length;o++)r=E.cloneObject(r),r.currentTarget=a[o],s.call(a[o],r)})}remove(){return this.isDragging()&&this.stopDrag(),Ce._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(qt),this._clearSelfAndDescendantCache(Zi),this._clearSelfAndDescendantCache(Ac),this._clearSelfAndDescendantCache(Pc),this._clearSelfAndDescendantCache(xa),this._clearSelfAndDescendantCache(wa)}_remove(){this._clearCaches();const e=this.getParent();e&&e.children&&(e.children.splice(this.index,1),e._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(e){const t="get"+E._capitalize(e);return E._isFunction(this[t])?this[t]():this.attrs[e]}getAncestors(){let e=this.getParent(),t=[];for(;e;)t.push(e),e=e.getParent();return t}getAttrs(){return this.attrs||{}}setAttrs(e){return this._batchTransformChanges(()=>{let t,s;if(!e)return this;for(t in e)t!==Dp&&(s=Rc+E._capitalize(t),E._isFunction(this[s])?this[s](e[t]):this._setAttr(t,e[t]))}),this}isListening(){return this._getCache(wa,this._isListening)}_isListening(e){if(!this.listening())return!1;const s=this.getParent();return s&&s!==e&&this!==e?s._isListening(e):!0}isVisible(){return this._getCache(xa,this._isVisible)}_isVisible(e){if(!this.visible())return!1;const s=this.getParent();return s&&s!==e&&this!==e?s._isVisible(e):!0}shouldDrawHit(e,t=!1){if(e)return this._isVisible(e)&&this._isListening(e);const s=this.getLayer();let i=!1;Ce._dragElements.forEach(a=>{a.dragStatus==="dragging"&&(a.node.nodeType==="Stage"||a.node.getLayer()===s)&&(i=!0)});const r=!t&&!X.hitOnDragEnabled&&(i||X.isTransforming());return this.isListening()&&this.isVisible()&&!r}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let e=this.getDepth(),t=this,s=0,i,r,a,o;function l(d){for(i=[],r=d.length,a=0;a<r;a++)o=d[a],s++,o.nodeType!==Ic&&(i=i.concat(o.getChildren().slice())),o._id===t._id&&(a=r);i.length>0&&i[0].getDepth()<=e&&l(i)}const c=this.getStage();return t.nodeType!==Vp&&c&&l(c.getChildren()),s}getDepth(){let e=0,t=this.parent;for(;t;)e++,t=t.parent;return e}_batchTransformChanges(e){this._batchingTransformChange=!0,e(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(bn),this._clearSelfAndDescendantCache(qt)),this._needClearTransformCache=!1}setPosition(e){return this._batchTransformChanges(()=>{this.x(e.x),this.y(e.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const e=this.getStage();if(!e)return null;const t=e.getPointerPosition();if(!t)return null;const s=this.getAbsoluteTransform().copy();return s.invert(),s.point(t)}getAbsolutePosition(e){let t=!1,s=this.parent;for(;s;){if(s.isCached()){t=!0;break}s=s.parent}t&&!e&&(e=!0);const i=this.getAbsoluteTransform(e).getMatrix(),r=new ct,a=this.offset();return r.m=i.slice(),r.translate(a.x,a.y),r.getTranslation()}setAbsolutePosition(e){const{x:t,y:s,...i}=this._clearTransform();this.attrs.x=t,this.attrs.y=s,this._clearCache(bn);const r=this._getAbsoluteTransform().copy();return r.invert(),r.translate(e.x,e.y),e={x:this.attrs.x+r.getTranslation().x,y:this.attrs.y+r.getTranslation().y},this._setTransform(i),this.setPosition({x:e.x,y:e.y}),this._clearCache(bn),this._clearSelfAndDescendantCache(qt),this}_setTransform(e){let t;for(t in e)this.attrs[t]=e[t]}_clearTransform(){const e={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,e}move(e){let t=e.x,s=e.y,i=this.x(),r=this.y();return t!==void 0&&(i+=t),s!==void 0&&(r+=s),this.setPosition({x:i,y:r}),this}_eachAncestorReverse(e,t){let s=[],i=this.getParent(),r,a;if(!(t&&t._id===this._id)){for(s.unshift(this);i&&(!t||i._id!==t._id);)s.unshift(i),i=i.parent;for(r=s.length,a=0;a<r;a++)e(s[a])}}rotate(e){return this.rotation(this.rotation()+e),this}moveToTop(){if(!this.parent)return E.warn("Node has no parent. moveToTop function is ignored."),!1;const e=this.index,t=this.parent.getChildren().length;return e<t-1?(this.parent.children.splice(e,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return E.warn("Node has no parent. moveUp function is ignored."),!1;const e=this.index,t=this.parent.getChildren().length;return e<t-1?(this.parent.children.splice(e,1),this.parent.children.splice(e+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return E.warn("Node has no parent. moveDown function is ignored."),!1;const e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.splice(e-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return E.warn("Node has no parent. moveToBottom function is ignored."),!1;const e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(e){if(!this.parent)return E.warn("Node has no parent. zIndex parameter is ignored."),this;(e<0||e>=this.parent.children.length)&&E.warn("Unexpected value "+e+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const t=this.index;return this.parent.children.splice(t,1),this.parent.children.splice(e,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(Zi,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let e=this.opacity();const t=this.getParent();return t&&!t._isUnderCache&&(e*=t.getAbsoluteOpacity()),e}moveTo(e){return this.getParent()!==e&&(this._remove(),e.add(this)),this}toObject(){let e=this.getAttrs(),t,s,i,r,a;const o={attrs:{},className:this.getClassName()};for(t in e)s=e[t],a=E.isObject(s)&&!E._isPlainObject(s)&&!E._isArray(s),!a&&(i=typeof this[t]=="function"&&this[t],delete e[t],r=i?i.call(this):null,e[t]=s,r!==s&&(o.attrs[t]=s));return E._prepareToStringify(o)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(e,t,s){const i=[];t&&this._isMatch(e)&&i.push(this);let r=this.parent;for(;r;){if(r===s)return i;r._isMatch(e)&&i.push(r),r=r.parent}return i}isAncestorOf(e){return!1}findAncestor(e,t,s){return this.findAncestors(e,t,s)[0]}_isMatch(e){if(!e)return!1;if(typeof e=="function")return e(this);let t=e.replace(/ /g,"").split(","),s=t.length,i,r;for(i=0;i<s;i++)if(r=t[i],E.isValidSelector(r)||(E.warn('Selector "'+r+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),E.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),E.warn("Konva is awesome, right?")),r.charAt(0)==="#"){if(this.id()===r.slice(1))return!0}else if(r.charAt(0)==="."){if(this.hasName(r.slice(1)))return!0}else if(this.className===r||this.nodeType===r)return!0;return!1}getLayer(){const e=this.getParent();return e?e.getLayer():null}getStage(){return this._getCache(Pc,this._getStage)}_getStage(){const e=this.getParent();return e?e.getStage():null}fire(e,t={},s){return t.target=t.target||this,s?this._fireAndBubble(e,t):this._fire(e,t),this}getAbsoluteTransform(e){return e?this._getAbsoluteTransform(e):this._getCache(qt,this._getAbsoluteTransform)}_getAbsoluteTransform(e){let t;if(e)return t=new ct,this._eachAncestorReverse(function(s){const i=s.transformsEnabled();i==="all"?t.multiply(s.getTransform()):i==="position"&&t.translate(s.x()-s.offsetX(),s.y()-s.offsetY())},e),t;{t=this._cache.get(qt)||new ct,this.parent?this.parent.getAbsoluteTransform().copyInto(t):t.reset();const s=this.transformsEnabled();if(s==="all")t.multiply(this.getTransform());else if(s==="position"){const i=this.attrs.x||0,r=this.attrs.y||0,a=this.attrs.offsetX||0,o=this.attrs.offsetY||0;t.translate(i-a,r-o)}return t.dirty=!1,t}}getAbsoluteScale(e){let t=this;for(;t;)t._isUnderCache&&(e=t),t=t.getParent();const i=this.getAbsoluteTransform(e).decompose();return{x:i.scaleX,y:i.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(bn,this._getTransform)}_getTransform(){var e,t;const s=this._cache.get(bn)||new ct;s.reset();const i=this.x(),r=this.y(),a=X.getAngle(this.rotation()),o=(e=this.attrs.scaleX)!==null&&e!==void 0?e:1,l=(t=this.attrs.scaleY)!==null&&t!==void 0?t:1,c=this.attrs.skewX||0,d=this.attrs.skewY||0,h=this.attrs.offsetX||0,u=this.attrs.offsetY||0;return(i!==0||r!==0)&&s.translate(i,r),a!==0&&s.rotate(a),(c!==0||d!==0)&&s.skew(c,d),(o!==1||l!==1)&&s.scale(o,l),(h!==0||u!==0)&&s.translate(-1*h,-1*u),s.dirty=!1,s}clone(e){let t=E.cloneObject(this.attrs),s,i,r,a,o;for(s in e)t[s]=e[s];const l=new this.constructor(t);for(s in this.eventListeners)for(i=this.eventListeners[s],r=i.length,a=0;a<r;a++)o=i[a],o.name.indexOf(Gp)<0&&(l.eventListeners[s]||(l.eventListeners[s]=[]),l.eventListeners[s].push(o));return l}_toKonvaCanvas(e){e=e||{};const t=this.getClientRect(),s=this.getStage(),i=e.x!==void 0?e.x:Math.floor(t.x),r=e.y!==void 0?e.y:Math.floor(t.y),a=e.pixelRatio||1,o=new vn({width:e.width||Math.ceil(t.width)||(s?s.width():0),height:e.height||Math.ceil(t.height)||(s?s.height():0),pixelRatio:a}),l=o.getContext(),c=new vn({width:o.width/o.pixelRatio+Math.abs(i),height:o.height/o.pixelRatio+Math.abs(r),pixelRatio:o.pixelRatio});return e.imageSmoothingEnabled===!1&&(l._context.imageSmoothingEnabled=!1),l.save(),(i||r)&&l.translate(-1*i,-1*r),this.drawScene(o,void 0,c),l.restore(),o}toCanvas(e){return this._toKonvaCanvas(e)._canvas}toDataURL(e){e=e||{};const t=e.mimeType||null,s=e.quality||null,i=this._toKonvaCanvas(e).toDataURL(t,s);return e.callback&&e.callback(i),i}toImage(e){return new Promise((t,s)=>{try{const i=e?.callback;i&&delete e.callback,E._urlToImage(this.toDataURL(e),function(r){t(r),i?.(r)})}catch(i){s(i)}})}toBlob(e){return new Promise((t,s)=>{try{const i=e?.callback;i&&delete e.callback,this.toCanvas(e).toBlob(r=>{t(r),i?.(r)},e?.mimeType,e?.quality)}catch(i){s(i)}})}setSize(e){return this.width(e.width),this.height(e.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():X.dragDistance}_off(e,t,s){let i=this.eventListeners[e],r,a,o;for(r=0;r<i.length;r++)if(a=i[r].name,o=i[r].handler,(a!=="konva"||t==="konva")&&(!t||a===t)&&(!s||s===o)){if(i.splice(r,1),i.length===0){delete this.eventListeners[e];break}r--}}_fireChangeEvent(e,t,s){this._fire(e+Lp,{oldVal:t,newVal:s})}addName(e){if(!this.hasName(e)){const t=this.name(),s=t?t+" "+e:e;this.name(s)}return this}hasName(e){if(!e)return!1;const t=this.name();return t?(t||"").split(/\s/g).indexOf(e)!==-1:!1}removeName(e){const t=(this.name()||"").split(/\s/g),s=t.indexOf(e);return s!==-1&&(t.splice(s,1),this.name(t.join(" "))),this}setAttr(e,t){const s=this[Rc+E._capitalize(e)];return E._isFunction(s)?s.call(this,t):this._setAttr(e,t),this}_requestDraw(){if(X.autoDrawEnabled){const e=this.getLayer()||this.getStage();e?.batchDraw()}}_setAttr(e,t){const s=this.attrs[e];s===t&&!E.isObject(t)||(t==null?delete this.attrs[e]:this.attrs[e]=t,this._shouldFireChangeEvents&&this._fireChangeEvent(e,s,t),this._requestDraw())}_setComponentAttr(e,t,s){let i;s!==void 0&&(i=this.attrs[e],i||(this.attrs[e]=this.getAttr(e)),this.attrs[e][t]=s,this._fireChangeEvent(e,i,s))}_fireAndBubble(e,t,s){t&&this.nodeType===Ic&&(t.target=this);const i=[Fp,Bp,Hp,$p,Wp,Up];if(!(i.indexOf(e)!==-1&&(s&&(this===s||this.isAncestorOf&&this.isAncestorOf(s))||this.nodeType==="Stage"&&!s))){this._fire(e,t);const a=i.indexOf(e)!==-1&&s&&s.isAncestorOf&&s.isAncestorOf(this)&&!s.isAncestorOf(this.parent);(t&&!t.cancelBubble||!t)&&this.parent&&this.parent.isListening()&&!a&&(s&&s.parent?this._fireAndBubble.call(this.parent,e,t,s):this._fireAndBubble.call(this.parent,e,t))}}_getProtoListeners(e){var t,s,i;const r=(t=this._cache.get(qi))!==null&&t!==void 0?t:{};let a=r?.[e];if(a===void 0){a=[];let o=Object.getPrototypeOf(this);for(;o;){const l=(i=(s=o.eventListeners)===null||s===void 0?void 0:s[e])!==null&&i!==void 0?i:[];a.push(...l),o=Object.getPrototypeOf(o)}r[e]=a,this._cache.set(qi,r)}return a}_fire(e,t){t=t||{},t.currentTarget=this,t.type=e;const s=this._getProtoListeners(e);if(s)for(let r=0;r<s.length;r++)s[r].handler.call(this,t);const i=this.eventListeners[e];if(i)for(let r=0;r<i.length;r++)i[r].handler.call(this,t)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(e){const t=e?e.pointerId:void 0,s=this.getStage(),i=this.getAbsolutePosition();if(!s)return;const r=s._getPointerById(t)||s._changedPointerPositions[0]||i;Ce._dragElements.set(this._id,{node:this,startPointerPos:r,offset:{x:r.x-i.x,y:r.y-i.y},dragStatus:"ready",pointerId:t})}startDrag(e,t=!0){Ce._dragElements.has(this._id)||this._createDragElement(e);const s=Ce._dragElements.get(this._id);s.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:e&&e.evt},t)}_setDragPosition(e,t){const s=this.getStage()._getPointerById(t.pointerId);if(!s)return;let i={x:s.x-t.offset.x,y:s.y-t.offset.y};const r=this.dragBoundFunc();if(r!==void 0){const a=r.call(this,i,e);a?i=a:E.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==i.x||this._lastPos.y!==i.y)&&(this.setAbsolutePosition(i),this._requestDraw()),this._lastPos=i}stopDrag(e){const t=Ce._dragElements.get(this._id);t&&(t.dragStatus="stopped"),Ce._endDragBefore(e),Ce._endDragAfter(e)}setDraggable(e){this._setAttr("draggable",e),this._dragChange()}isDragging(){const e=Ce._dragElements.get(this._id);return e?e.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(e){if(!(!(e.evt.button!==void 0)||X.dragButtons.indexOf(e.evt.button)>=0)||this.isDragging())return;let i=!1;Ce._dragElements.forEach(r=>{this.isAncestorOf(r.node)&&(i=!0)}),i||this._createDragElement(e)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const t=Ce._dragElements.get(this._id),s=t&&t.dragStatus==="dragging",i=t&&t.dragStatus==="ready";s?this.stopDrag():i&&Ce._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(e={x:0,y:0}){const t=this.getStage();if(!t)return!1;const s={x:-e.x,y:-e.y,width:t.width()+2*e.x,height:t.height()+2*e.y};return E.haveIntersection(s,this.getClientRect())}static create(e,t){return E._isString(e)&&(e=JSON.parse(e)),this._createNode(e,t)}static _createNode(e,t){let s=z.prototype.getClassName.call(e),i=e.children,r,a,o;t&&(e.attrs.container=t),X[s]||(E.warn('Can not find a node with class name "'+s+'". Fallback to "Shape".'),s="Shape");const l=X[s];if(r=new l(e.attrs),i)for(a=i.length,o=0;o<a;o++)r.add(z._createNode(i[o]));return r}}z.prototype.nodeType="Node",z.prototype._attrsAffectingSize=[],z.prototype.eventListeners={},z.prototype.on.call(z.prototype,jp,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(bn),this._clearSelfAndDescendantCache(qt)}),z.prototype.on.call(z.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(xa)}),z.prototype.on.call(z.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(wa)}),z.prototype.on.call(z.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(Zi)});const Ae=y.addGetterSetter;Ae(z,"zIndex"),Ae(z,"absolutePosition"),Ae(z,"position"),Ae(z,"x",0,Y()),Ae(z,"y",0,Y()),Ae(z,"globalCompositeOperation","source-over",Un()),Ae(z,"opacity",1,Y()),Ae(z,"name","",Un()),Ae(z,"id","",Un()),Ae(z,"rotation",0,Y()),y.addComponentsGetterSetter(z,"scale",["x","y"]),Ae(z,"scaleX",1,Y()),Ae(z,"scaleY",1,Y()),y.addComponentsGetterSetter(z,"skew",["x","y"]),Ae(z,"skewX",0,Y()),Ae(z,"skewY",0,Y()),y.addComponentsGetterSetter(z,"offset",["x","y"]),Ae(z,"offsetX",0,Y()),Ae(z,"offsetY",0,Y()),Ae(z,"dragDistance",void 0,Y()),Ae(z,"width",0,Y()),Ae(z,"height",0,Y()),Ae(z,"listening",!0,Et()),Ae(z,"preventDefault",!0,Et()),Ae(z,"filters",void 0,function(n){return this._filterUpToDate=!1,n}),Ae(z,"visible",!0,Et()),Ae(z,"transformsEnabled","all",Un()),Ae(z,"size"),Ae(z,"dragBoundFunc"),Ae(z,"draggable",!1,Et()),y.backCompat(z,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});class dt extends z{constructor(){super(...arguments),this.children=[]}getChildren(e){const t=this.children||[];return e?t.filter(e):t}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.destroy()}),this.children=[],this._requestDraw(),this}add(...e){if(e.length===0)return this;if(e.length>1){for(let s=0;s<e.length;s++)this.add(e[s]);return this}const t=e[0];return t.getParent()?(t.moveTo(this),this):(this._validateAdd(t),t.index=this.getChildren().length,t.parent=this,t._clearCaches(),this.getChildren().push(t),this._fire("add",{child:t}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(e){return this._generalFind(e,!1)}findOne(e){const t=this._generalFind(e,!0);return t.length>0?t[0]:void 0}_generalFind(e,t){const s=[];return this._descendants(i=>{const r=i._isMatch(e);return r&&s.push(i),!!(r&&t)}),s}_descendants(e){let t=!1;const s=this.getChildren();for(const i of s){if(t=e(i),t)return!0;if(i.hasChildren()&&(t=i._descendants(e),t))return!0}return!1}toObject(){const e=z.prototype.toObject.call(this);return e.children=[],this.getChildren().forEach(t=>{e.children.push(t.toObject())}),e}isAncestorOf(e){let t=e.getParent();for(;t;){if(t._id===this._id)return!0;t=t.getParent()}return!1}clone(e){const t=z.prototype.clone.call(this,e);return this.getChildren().forEach(function(s){t.add(s.clone())}),t}getAllIntersections(e){const t=[];return this.find("Shape").forEach(s=>{s.isVisible()&&s.intersects(e)&&t.push(s)}),t}_clearSelfAndDescendantCache(e){var t;super._clearSelfAndDescendantCache(e),!this.isCached()&&((t=this.children)===null||t===void 0||t.forEach(function(s){s._clearSelfAndDescendantCache(e)}))}_setChildrenIndices(){var e;(e=this.children)===null||e===void 0||e.forEach(function(t,s){t.index=s}),this._requestDraw()}drawScene(e,t,s){const i=this.getLayer(),r=e||i&&i.getCanvas(),a=r&&r.getContext(),o=this._getCanvasCache(),l=o&&o.scene,c=r&&r.isCache;if(!this.isVisible()&&!c)return this;if(l){a.save();const d=this.getAbsoluteTransform(t).getMatrix();a.transform(d[0],d[1],d[2],d[3],d[4],d[5]),this._drawCachedSceneCanvas(a),a.restore()}else this._drawChildren("drawScene",r,t,s);return this}drawHit(e,t){if(!this.shouldDrawHit(t))return this;const s=this.getLayer(),i=e||s&&s.hitCanvas,r=i&&i.getContext(),a=this._getCanvasCache();if(a&&a.hit){r.save();const l=this.getAbsoluteTransform(t).getMatrix();r.transform(l[0],l[1],l[2],l[3],l[4],l[5]),this._drawCachedHitCanvas(r),r.restore()}else this._drawChildren("drawHit",i,t);return this}_drawChildren(e,t,s,i){var r;const a=t&&t.getContext(),o=this.clipWidth(),l=this.clipHeight(),c=this.clipFunc(),d=typeof o=="number"&&typeof l=="number"||c,h=s===this;if(d){a.save();const f=this.getAbsoluteTransform(s);let p=f.getMatrix();a.transform(p[0],p[1],p[2],p[3],p[4],p[5]),a.beginPath();let m;if(c)m=c.call(this,a,this);else{const v=this.clipX(),S=this.clipY();a.rect(v||0,S||0,o,l)}a.clip.apply(a,m),p=f.copy().invert().getMatrix(),a.transform(p[0],p[1],p[2],p[3],p[4],p[5])}const u=!h&&this.globalCompositeOperation()!=="source-over"&&e==="drawScene";u&&(a.save(),a._applyGlobalCompositeOperation(this)),(r=this.children)===null||r===void 0||r.forEach(function(f){f[e](t,s,i)}),u&&a.restore(),d&&a.restore()}getClientRect(e={}){var t;const s=e.skipTransform,i=e.relativeTo;let r,a,o,l,c={x:1/0,y:1/0,width:0,height:0};const d=this;(t=this.children)===null||t===void 0||t.forEach(function(f){if(!f.visible())return;const p=f.getClientRect({relativeTo:d,skipShadow:e.skipShadow,skipStroke:e.skipStroke});p.width===0&&p.height===0||(r===void 0?(r=p.x,a=p.y,o=p.x+p.width,l=p.y+p.height):(r=Math.min(r,p.x),a=Math.min(a,p.y),o=Math.max(o,p.x+p.width),l=Math.max(l,p.y+p.height)))});const h=this.find("Shape");let u=!1;for(let f=0;f<h.length;f++)if(h[f]._isVisible(this)){u=!0;break}return u&&r!==void 0?c={x:r,y:a,width:o-r,height:l-a}:c={x:0,y:0,width:0,height:0},s?c:this._transformedRect(c,i)}}y.addComponentsGetterSetter(dt,"clip",["x","y","width","height"]),y.addGetterSetter(dt,"clipX",void 0,Y()),y.addGetterSetter(dt,"clipY",void 0,Y()),y.addGetterSetter(dt,"clipWidth",void 0,Y()),y.addGetterSetter(dt,"clipHeight",void 0,Y()),y.addGetterSetter(dt,"clipFunc");const zs=new Map,Mc=X._global.PointerEvent!==void 0;function Sa(n){return zs.get(n)}function ka(n){return{evt:n,pointerId:n.pointerId}}function Oc(n,e){return zs.get(n)===e}function Nc(n,e){Ys(n),e.getStage()&&(zs.set(n,e),Mc&&e._fire("gotpointercapture",ka(new PointerEvent("gotpointercapture"))))}function Ys(n,e){const t=zs.get(n);if(!t)return;const s=t.getStage();s&&s.content,zs.delete(n),Mc&&t._fire("lostpointercapture",ka(new PointerEvent("lostpointercapture")))}const Yp="Stage",Xp="string",Lc="px",Kp="mouseout",Dc="mouseleave",Gc="mouseover",Fc="mouseenter",Bc="mousemove",Hc="mousedown",$c="mouseup",Xs="pointermove",Ks="pointerdown",us="pointerup",Zs="pointercancel",Zp="lostpointercapture",Qi="pointerout",qs="pointerleave",er="pointerover",tr="pointerenter",Ca="contextmenu",Wc="touchstart",Uc="touchend",Vc="touchmove",jc="touchcancel",Ta="wheel",qp=5,Jp=[[Fc,"_pointerenter"],[Hc,"_pointerdown"],[Bc,"_pointermove"],[$c,"_pointerup"],[Dc,"_pointerleave"],[Wc,"_pointerdown"],[Vc,"_pointermove"],[Uc,"_pointerup"],[jc,"_pointercancel"],[Gc,"_pointerover"],[Ta,"_wheel"],[Ca,"_contextmenu"],[Ks,"_pointerdown"],[Xs,"_pointermove"],[us,"_pointerup"],[Zs,"_pointercancel"],[qs,"_pointerleave"],[Zp,"_lostpointercapture"]],Ea={mouse:{[Qi]:Kp,[qs]:Dc,[er]:Gc,[tr]:Fc,[Xs]:Bc,[Ks]:Hc,[us]:$c,[Zs]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[Qi]:"touchout",[qs]:"touchleave",[er]:"touchover",[tr]:"touchenter",[Xs]:Vc,[Ks]:Wc,[us]:Uc,[Zs]:jc,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[Qi]:Qi,[qs]:qs,[er]:er,[tr]:tr,[Xs]:Xs,[Ks]:Ks,[us]:us,[Zs]:Zs,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},Js=n=>n.indexOf("pointer")>=0?"pointer":n.indexOf("touch")>=0?"touch":"mouse",fs=n=>{const e=Js(n);if(e==="pointer")return X.pointerEventsEnabled&&Ea.pointer;if(e==="touch")return Ea.touch;if(e==="mouse")return Ea.mouse};function zc(n={}){return(n.clipFunc||n.clipWidth||n.clipHeight)&&E.warn("Stage does not support clipping. Please use clip for Layers or Groups."),n}const Qp="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);",Qs=[];class nr extends dt{constructor(e){super(zc(e)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),Qs.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{zc(this.attrs)}),this._checkVisibility()}_validateAdd(e){const t=e.getType()==="Layer",s=e.getType()==="FastLayer";t||s||E.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const e=this.visible()?"":"none";this.content.style.display=e}setContainer(e){if(typeof e===Xp){let t;if(e.charAt(0)==="."){const s=e.slice(1);e=document.getElementsByClassName(s)[0]}else e.charAt(0)!=="#"?t=e:t=e.slice(1),e=document.getElementById(t);if(!e)throw"Can not find container in document with id "+t}return this._setAttr("container",e),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),e.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const e=this.children,t=e.length;for(let s=0;s<t;s++)e[s].clear();return this}clone(e){return e||(e={}),e.container=typeof document<"u"&&document.createElement("div"),dt.prototype.clone.call(this,e)}destroy(){super.destroy();const e=this.content;e&&E._isInDocument(e)&&this.container().removeChild(e);const t=Qs.indexOf(this);return t>-1&&Qs.splice(t,1),E.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const e=this._pointerPositions[0]||this._changedPointerPositions[0];return e?{x:e.x,y:e.y}:(E.warn(Qp),null)}_getPointerById(e){return this._pointerPositions.find(t=>t.id===e)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(e){e={...e},e.x=e.x||0,e.y=e.y||0,e.width=e.width||this.width(),e.height=e.height||this.height();const t=new vn({width:e.width,height:e.height,pixelRatio:e.pixelRatio||1}),s=t.getContext()._context,i=this.children;return(e.x||e.y)&&s.translate(-1*e.x,-1*e.y),i.forEach(function(r){if(!r.isVisible())return;const a=r._toKonvaCanvas(e);s.drawImage(a._canvas,e.x,e.y,a.getWidth()/a.getPixelRatio(),a.getHeight()/a.getPixelRatio())}),t}getIntersection(e){if(!e)return null;const t=this.children,s=t.length,i=s-1;for(let r=i;r>=0;r--){const a=t[r].getIntersection(e);if(a)return a}return null}_resizeDOM(){const e=this.width(),t=this.height();this.content&&(this.content.style.width=e+Lc,this.content.style.height=t+Lc),this.bufferCanvas.setSize(e,t),this.bufferHitCanvas.setSize(e,t),this.children.forEach(s=>{s.setSize({width:e,height:t}),s.draw()})}add(e,...t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}super.add(e);const s=this.children.length;return s>qp&&E.warn("The stage has "+s+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),e.setSize({width:this.width(),height:this.height()}),e.draw(),X.isBrowser&&this.content.appendChild(e.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(e){return Oc(e,this)}setPointerCapture(e){Nc(e,this)}releaseCapture(e){Ys(e)}getLayers(){return this.children}_bindContentEvents(){X.isBrowser&&Jp.forEach(([e,t])=>{this.content.addEventListener(e,s=>{this[t](s)},{passive:!1})})}_pointerenter(e){this.setPointersPositions(e);const t=fs(e.type);t&&this._fire(t.pointerenter,{evt:e,target:this,currentTarget:this})}_pointerover(e){this.setPointersPositions(e);const t=fs(e.type);t&&this._fire(t.pointerover,{evt:e,target:this,currentTarget:this})}_getTargetShape(e){let t=this[e+"targetShape"];return t&&!t.getStage()&&(t=null),t}_pointerleave(e){const t=fs(e.type),s=Js(e.type);if(!t)return;this.setPointersPositions(e);const i=this._getTargetShape(s),r=!(X.isDragging()||X.isTransforming())||X.hitOnDragEnabled;i&&r?(i._fireAndBubble(t.pointerout,{evt:e}),i._fireAndBubble(t.pointerleave,{evt:e}),this._fire(t.pointerleave,{evt:e,target:this,currentTarget:this}),this[s+"targetShape"]=null):r&&(this._fire(t.pointerleave,{evt:e,target:this,currentTarget:this}),this._fire(t.pointerout,{evt:e,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(e){const t=fs(e.type),s=Js(e.type);if(!t)return;this.setPointersPositions(e);let i=!1;this._changedPointerPositions.forEach(r=>{const a=this.getIntersection(r);if(Ce.justDragged=!1,X["_"+s+"ListenClick"]=!0,!a||!a.isListening()){this[s+"ClickStartShape"]=void 0;return}X.capturePointerEventsEnabled&&a.setPointerCapture(r.id),this[s+"ClickStartShape"]=a,a._fireAndBubble(t.pointerdown,{evt:e,pointerId:r.id}),i=!0;const o=e.type.indexOf("touch")>=0;a.preventDefault()&&e.cancelable&&o&&e.preventDefault()}),i||this._fire(t.pointerdown,{evt:e,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(e){const t=fs(e.type),s=Js(e.type);if(!t)return;const i=e.type.indexOf("touch")>=0||e.pointerType==="touch";if(X.isDragging()&&Ce.node.preventDefault()&&e.cancelable&&i&&e.preventDefault(),this.setPointersPositions(e),!(!(X.isDragging()||X.isTransforming())||X.hitOnDragEnabled))return;const a={};let o=!1;const l=this._getTargetShape(s);this._changedPointerPositions.forEach(c=>{const d=Sa(c.id)||this.getIntersection(c),h=c.id,u={evt:e,pointerId:h},f=l!==d;if(f&&l&&(l._fireAndBubble(t.pointerout,{...u},d),l._fireAndBubble(t.pointerleave,{...u},d)),d){if(a[d._id])return;a[d._id]=!0}d&&d.isListening()?(o=!0,f&&(d._fireAndBubble(t.pointerover,{...u},l),d._fireAndBubble(t.pointerenter,{...u},l),this[s+"targetShape"]=d),d._fireAndBubble(t.pointermove,{...u})):l&&(this._fire(t.pointerover,{evt:e,target:this,currentTarget:this,pointerId:h}),this[s+"targetShape"]=null)}),o||this._fire(t.pointermove,{evt:e,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(e){const t=fs(e.type),s=Js(e.type);if(!t)return;this.setPointersPositions(e);const i=this[s+"ClickStartShape"],r=this[s+"ClickEndShape"],a={};let o=!1;this._changedPointerPositions.forEach(l=>{const c=Sa(l.id)||this.getIntersection(l);if(c){if(c.releaseCapture(l.id),a[c._id])return;a[c._id]=!0}const d=l.id,h={evt:e,pointerId:d};let u=!1;X["_"+s+"InDblClickWindow"]?(u=!0,clearTimeout(this[s+"DblTimeout"])):Ce.justDragged||(X["_"+s+"InDblClickWindow"]=!0,clearTimeout(this[s+"DblTimeout"])),this[s+"DblTimeout"]=setTimeout(function(){X["_"+s+"InDblClickWindow"]=!1},X.dblClickWindow),c&&c.isListening()?(o=!0,this[s+"ClickEndShape"]=c,c._fireAndBubble(t.pointerup,{...h}),X["_"+s+"ListenClick"]&&i&&i===c&&(c._fireAndBubble(t.pointerclick,{...h}),u&&r&&r===c&&c._fireAndBubble(t.pointerdblclick,{...h}))):(this[s+"ClickEndShape"]=null,o||(this._fire(t.pointerup,{evt:e,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),o=!0),X["_"+s+"ListenClick"]&&this._fire(t.pointerclick,{evt:e,target:this,currentTarget:this,pointerId:d}),u&&this._fire(t.pointerdblclick,{evt:e,target:this,currentTarget:this,pointerId:d}))}),o||this._fire(t.pointerup,{evt:e,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),X["_"+s+"ListenClick"]=!1,e.cancelable&&s!=="touch"&&s!=="pointer"&&e.preventDefault()}_contextmenu(e){this.setPointersPositions(e);const t=this.getIntersection(this.getPointerPosition());t&&t.isListening()?t._fireAndBubble(Ca,{evt:e}):this._fire(Ca,{evt:e,target:this,currentTarget:this})}_wheel(e){this.setPointersPositions(e);const t=this.getIntersection(this.getPointerPosition());t&&t.isListening()?t._fireAndBubble(Ta,{evt:e}):this._fire(Ta,{evt:e,target:this,currentTarget:this})}_pointercancel(e){this.setPointersPositions(e);const t=Sa(e.pointerId)||this.getIntersection(this.getPointerPosition());t&&t._fireAndBubble(us,ka(e)),Ys(e.pointerId)}_lostpointercapture(e){Ys(e.pointerId)}setPointersPositions(e){const t=this._getContentPosition();let s=null,i=null;e=e||window.event,e.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(e.touches,r=>{this._pointerPositions.push({id:r.identifier,x:(r.clientX-t.left)/t.scaleX,y:(r.clientY-t.top)/t.scaleY})}),Array.prototype.forEach.call(e.changedTouches||e.touches,r=>{this._changedPointerPositions.push({id:r.identifier,x:(r.clientX-t.left)/t.scaleX,y:(r.clientY-t.top)/t.scaleY})})):(s=(e.clientX-t.left)/t.scaleX,i=(e.clientY-t.top)/t.scaleY,this.pointerPos={x:s,y:i},this._pointerPositions=[{x:s,y:i,id:E._getFirstPointerId(e)}],this._changedPointerPositions=[{x:s,y:i,id:E._getFirstPointerId(e)}])}_setPointerPosition(e){E.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(e)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const e=this.content.getBoundingClientRect();return{top:e.top,left:e.left,scaleX:e.width/this.content.clientWidth||1,scaleY:e.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new vn({width:this.width(),height:this.height()}),this.bufferHitCanvas=new ya({pixelRatio:1,width:this.width(),height:this.height()}),!X.isBrowser)return;const e=this.container();if(!e)throw"Stage has no container. A container is required.";e.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),e.appendChild(this.content),this._resizeDOM()}cache(){return E.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(e){e.batchDraw()}),this}}nr.prototype.nodeType=Yp,Be(nr),y.addGetterSetter(nr,"container"),X.isBrowser&&document.addEventListener("visibilitychange",()=>{Qs.forEach(n=>{n.batchDraw()})});const Yc="hasShadow",Xc="shadowRGBA",Kc="patternImage",Zc="linearGradient",qc="radialGradient";let sr;function Aa(){return sr||(sr=E.createCanvasElement().getContext("2d"),sr)}const ei={};function eg(n){const e=this.attrs.fillRule;e?n.fill(e):n.fill()}function tg(n){n.stroke()}function ng(n){const e=this.attrs.fillRule;e?n.fill(e):n.fill()}function sg(n){n.stroke()}function ig(){this._clearCache(Yc)}function rg(){this._clearCache(Xc)}function ag(){this._clearCache(Kc)}function og(){this._clearCache(Zc)}function lg(){this._clearCache(qc)}class B extends z{constructor(e){super(e);let t,s=0;for(;t=E.getHitColor(),!(t&&!(t in ei));)if(s++,s>=1e4){E.warn("Failed to find a unique color key for a shape. Konva may work incorrectly. Most likely your browser is using canvas farbling. Consider disabling it."),t=E.getRandomColor();break}this.colorKey=t,ei[t]=this}getContext(){return E.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return E.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(Yc,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(Kc,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const t=Aa().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(t&&t.setTransform){const s=new ct;s.translate(this.fillPatternX(),this.fillPatternY()),s.rotate(X.getAngle(this.fillPatternRotation())),s.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),s.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const i=s.getMatrix(),r=typeof DOMMatrix>"u"?{a:i[0],b:i[1],c:i[2],d:i[3],e:i[4],f:i[5]}:new DOMMatrix(i);t.setTransform(r)}return t}}_getLinearGradient(){return this._getCache(Zc,this.__getLinearGradient)}__getLinearGradient(){const e=this.fillLinearGradientColorStops();if(e){const t=Aa(),s=this.fillLinearGradientStartPoint(),i=this.fillLinearGradientEndPoint(),r=t.createLinearGradient(s.x,s.y,i.x,i.y);for(let a=0;a<e.length;a+=2)r.addColorStop(e[a],e[a+1]);return r}}_getRadialGradient(){return this._getCache(qc,this.__getRadialGradient)}__getRadialGradient(){const e=this.fillRadialGradientColorStops();if(e){const t=Aa(),s=this.fillRadialGradientStartPoint(),i=this.fillRadialGradientEndPoint(),r=t.createRadialGradient(s.x,s.y,this.fillRadialGradientStartRadius(),i.x,i.y,this.fillRadialGradientEndRadius());for(let a=0;a<e.length;a+=2)r.addColorStop(e[a],e[a+1]);return r}}getShadowRGBA(){return this._getCache(Xc,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const e=E.colorToRGBA(this.shadowColor());if(e)return"rgba("+e.r+","+e.g+","+e.b+","+e.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const e=this.hitStrokeWidth();return e==="auto"?this.hasStroke():this.strokeEnabled()&&!!e}intersects(e){const t=this.getStage();if(!t)return!1;const s=t.bufferHitCanvas;return s.getContext().clear(),this.drawHit(s,void 0,!0),s.context.getImageData(Math.round(e.x),Math.round(e.y),1,1).data[3]>0}destroy(){return z.prototype.destroy.call(this),delete ei[this.colorKey],delete this.colorKey,this}_useBufferCanvas(e){var t;if(!((t=this.attrs.perfectDrawEnabled)!==null&&t!==void 0?t:!0))return!1;const i=e||this.hasFill(),r=this.hasStroke(),a=this.getAbsoluteOpacity()!==1;if(i&&r&&a)return!0;const o=this.hasShadow(),l=this.shadowForStrokeEnabled();return!!(i&&r&&o&&l)}setStrokeHitEnabled(e){E.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),e?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const e=this.size();return{x:this._centroid?-e.width/2:0,y:this._centroid?-e.height/2:0,width:e.width,height:e.height}}getClientRect(e={}){let t=!1,s=this.getParent();for(;s;){if(s.isCached()){t=!0;break}s=s.getParent()}const i=e.skipTransform,r=e.relativeTo||t&&this.getStage()||void 0,a=this.getSelfRect(),l=!e.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,c=a.width+l,d=a.height+l,h=!e.skipShadow&&this.hasShadow(),u=h?this.shadowOffsetX():0,f=h?this.shadowOffsetY():0,p=c+Math.abs(u),m=d+Math.abs(f),v=h&&this.shadowBlur()||0,S=p+v*2,k=m+v*2,b={width:S,height:k,x:-(l/2+v)+Math.min(u,0)+a.x,y:-(l/2+v)+Math.min(f,0)+a.y};return i?b:this._transformedRect(b,r)}drawScene(e,t,s){const i=this.getLayer(),r=e||i.getCanvas(),a=r.getContext(),o=this._getCanvasCache(),l=this.getSceneFunc(),c=this.hasShadow();let d;const h=t===this;if(!this.isVisible()&&!h)return this;if(o){a.save();const u=this.getAbsoluteTransform(t).getMatrix();return a.transform(u[0],u[1],u[2],u[3],u[4],u[5]),this._drawCachedSceneCanvas(a),a.restore(),this}if(!l)return this;if(a.save(),this._useBufferCanvas()){d=this.getStage();const u=s||d.bufferCanvas,f=u.getContext();f.clear(),f.save(),f._applyLineJoin(this),f._applyMiterLimit(this);const p=this.getAbsoluteTransform(t).getMatrix();f.transform(p[0],p[1],p[2],p[3],p[4],p[5]),l.call(this,f,this),f.restore();const m=u.pixelRatio;c&&a._applyShadow(this),h||(a._applyOpacity(this),a._applyGlobalCompositeOperation(this)),a.drawImage(u._canvas,u.x||0,u.y||0,u.width/m,u.height/m)}else{if(a._applyLineJoin(this),a._applyMiterLimit(this),!h){const u=this.getAbsoluteTransform(t).getMatrix();a.transform(u[0],u[1],u[2],u[3],u[4],u[5]),a._applyOpacity(this),a._applyGlobalCompositeOperation(this)}c&&a._applyShadow(this),l.call(this,a,this)}return a.restore(),this}drawHit(e,t,s=!1){if(!this.shouldDrawHit(t,s))return this;const i=this.getLayer(),r=e||i.hitCanvas,a=r&&r.getContext(),o=this.hitFunc()||this.sceneFunc(),l=this._getCanvasCache(),c=l&&l.hit;if(this.colorKey||E.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),c){a.save();const h=this.getAbsoluteTransform(t).getMatrix();return a.transform(h[0],h[1],h[2],h[3],h[4],h[5]),this._drawCachedHitCanvas(a),a.restore(),this}if(!o)return this;if(a.save(),a._applyLineJoin(this),a._applyMiterLimit(this),!(this===t)){const h=this.getAbsoluteTransform(t).getMatrix();a.transform(h[0],h[1],h[2],h[3],h[4],h[5])}return o.call(this,a,this),a.restore(),this}drawHitFromCache(e=0){const t=this._getCanvasCache(),s=this._getCachedSceneCanvas(),i=t.hit,r=i.getContext(),a=i.getWidth(),o=i.getHeight();r.clear(),r.drawImage(s._canvas,0,0,a,o);try{const l=r.getImageData(0,0,a,o),c=l.data,d=c.length,h=E._hexToRgb(this.colorKey);for(let u=0;u<d;u+=4)c[u+3]>e?(c[u]=h.r,c[u+1]=h.g,c[u+2]=h.b,c[u+3]=255):c[u+3]=0;r.putImageData(l,0,0)}catch(l){E.error("Unable to draw hit graph from cached scene canvas. "+l.message)}return this}hasPointerCapture(e){return Oc(e,this)}setPointerCapture(e){Nc(e,this)}releaseCapture(e){Ys(e)}}B.prototype._fillFunc=eg,B.prototype._strokeFunc=tg,B.prototype._fillFuncHit=ng,B.prototype._strokeFuncHit=sg,B.prototype._centroid=!1,B.prototype.nodeType="Shape",Be(B),B.prototype.eventListeners={},B.prototype.on.call(B.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",ig),B.prototype.on.call(B.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",rg),B.prototype.on.call(B.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",ag),B.prototype.on.call(B.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",og),B.prototype.on.call(B.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",lg),y.addGetterSetter(B,"stroke",void 0,Ec()),y.addGetterSetter(B,"strokeWidth",2,Y()),y.addGetterSetter(B,"fillAfterStrokeEnabled",!1),y.addGetterSetter(B,"hitStrokeWidth","auto",ba()),y.addGetterSetter(B,"strokeHitEnabled",!0,Et()),y.addGetterSetter(B,"perfectDrawEnabled",!0,Et()),y.addGetterSetter(B,"shadowForStrokeEnabled",!0,Et()),y.addGetterSetter(B,"lineJoin"),y.addGetterSetter(B,"lineCap"),y.addGetterSetter(B,"miterLimit"),y.addGetterSetter(B,"sceneFunc"),y.addGetterSetter(B,"hitFunc"),y.addGetterSetter(B,"dash"),y.addGetterSetter(B,"dashOffset",0,Y()),y.addGetterSetter(B,"shadowColor",void 0,Un()),y.addGetterSetter(B,"shadowBlur",0,Y()),y.addGetterSetter(B,"shadowOpacity",1,Y()),y.addComponentsGetterSetter(B,"shadowOffset",["x","y"]),y.addGetterSetter(B,"shadowOffsetX",0,Y()),y.addGetterSetter(B,"shadowOffsetY",0,Y()),y.addGetterSetter(B,"fillPatternImage"),y.addGetterSetter(B,"fill",void 0,Ec()),y.addGetterSetter(B,"fillPatternX",0,Y()),y.addGetterSetter(B,"fillPatternY",0,Y()),y.addGetterSetter(B,"fillLinearGradientColorStops"),y.addGetterSetter(B,"strokeLinearGradientColorStops"),y.addGetterSetter(B,"fillRadialGradientStartRadius",0),y.addGetterSetter(B,"fillRadialGradientEndRadius",0),y.addGetterSetter(B,"fillRadialGradientColorStops"),y.addGetterSetter(B,"fillPatternRepeat","repeat"),y.addGetterSetter(B,"fillEnabled",!0),y.addGetterSetter(B,"strokeEnabled",!0),y.addGetterSetter(B,"shadowEnabled",!0),y.addGetterSetter(B,"dashEnabled",!0),y.addGetterSetter(B,"strokeScaleEnabled",!0),y.addGetterSetter(B,"fillPriority","color"),y.addComponentsGetterSetter(B,"fillPatternOffset",["x","y"]),y.addGetterSetter(B,"fillPatternOffsetX",0,Y()),y.addGetterSetter(B,"fillPatternOffsetY",0,Y()),y.addComponentsGetterSetter(B,"fillPatternScale",["x","y"]),y.addGetterSetter(B,"fillPatternScaleX",1,Y()),y.addGetterSetter(B,"fillPatternScaleY",1,Y()),y.addComponentsGetterSetter(B,"fillLinearGradientStartPoint",["x","y"]),y.addComponentsGetterSetter(B,"strokeLinearGradientStartPoint",["x","y"]),y.addGetterSetter(B,"fillLinearGradientStartPointX",0),y.addGetterSetter(B,"strokeLinearGradientStartPointX",0),y.addGetterSetter(B,"fillLinearGradientStartPointY",0),y.addGetterSetter(B,"strokeLinearGradientStartPointY",0),y.addComponentsGetterSetter(B,"fillLinearGradientEndPoint",["x","y"]),y.addComponentsGetterSetter(B,"strokeLinearGradientEndPoint",["x","y"]),y.addGetterSetter(B,"fillLinearGradientEndPointX",0),y.addGetterSetter(B,"strokeLinearGradientEndPointX",0),y.addGetterSetter(B,"fillLinearGradientEndPointY",0),y.addGetterSetter(B,"strokeLinearGradientEndPointY",0),y.addComponentsGetterSetter(B,"fillRadialGradientStartPoint",["x","y"]),y.addGetterSetter(B,"fillRadialGradientStartPointX",0),y.addGetterSetter(B,"fillRadialGradientStartPointY",0),y.addComponentsGetterSetter(B,"fillRadialGradientEndPoint",["x","y"]),y.addGetterSetter(B,"fillRadialGradientEndPointX",0),y.addGetterSetter(B,"fillRadialGradientEndPointY",0),y.addGetterSetter(B,"fillPatternRotation",0),y.addGetterSetter(B,"fillRule",void 0,Un()),y.backCompat(B,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"});const cg="beforeDraw",dg="draw",Jc=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],hg=Jc.length;class jn extends dt{constructor(e){super(e),this.canvas=new vn,this.hitCanvas=new ya({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(e){return this.getContext().clear(e),this.getHitCanvas().getContext().clear(e),this}setZIndex(e){super.setZIndex(e);const t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),e<t.children.length-1?t.content.insertBefore(this.getNativeCanvasElement(),t.children[e+1].getCanvas()._canvas):t.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){z.prototype.moveToTop.call(this);const e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!z.prototype.moveUp.call(this))return!1;const t=this.getStage();return!t||!t.content?!1:(t.content.removeChild(this.getNativeCanvasElement()),this.index<t.children.length-1?t.content.insertBefore(this.getNativeCanvasElement(),t.children[this.index+1].getCanvas()._canvas):t.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(z.prototype.moveDown.call(this)){const e=this.getStage();if(e){const t=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),t[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(z.prototype.moveToBottom.call(this)){const e=this.getStage();if(e){const t=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),t[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const e=this.getNativeCanvasElement();return z.prototype.remove.call(this),e&&e.parentNode&&E._isInDocument(e)&&e.parentNode.removeChild(e),this}getStage(){return this.parent}setSize({width:e,height:t}){return this.canvas.setSize(e,t),this.hitCanvas.setSize(e,t),this._setSmoothEnabled(),this}_validateAdd(e){const t=e.getType();t!=="Group"&&t!=="Shape"&&E.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(e){return e={...e},e.width=e.width||this.getWidth(),e.height=e.height||this.getHeight(),e.x=e.x!==void 0?e.x:this.x(),e.y=e.y!==void 0?e.y:this.y(),z.prototype._toKonvaCanvas.call(this,e)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){E.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){E.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,E.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(e){if(!this.isListening()||!this.isVisible())return null;let t=1,s=!1;for(;;){for(let i=0;i<hg;i++){const r=Jc[i],a=this._getIntersection({x:e.x+r.x*t,y:e.y+r.y*t}),o=a.shape;if(o)return o;if(s=!!a.antialiased,!a.antialiased)break}if(s)t+=1;else return null}}_getIntersection(e){const t=this.hitCanvas.pixelRatio,s=this.hitCanvas.context.getImageData(Math.round(e.x*t),Math.round(e.y*t),1,1).data,i=s[3];if(i===255){const r=E.getHitColorKey(s[0],s[1],s[2]),a=ei[r];return a?{shape:a}:{antialiased:!0}}else if(i>0)return{antialiased:!0};return{}}drawScene(e,t,s){const i=this.getLayer(),r=e||i&&i.getCanvas();return this._fire(cg,{node:this}),this.clearBeforeDraw()&&r.getContext().clear(),dt.prototype.drawScene.call(this,r,t,s),this._fire(dg,{node:this}),this}drawHit(e,t){const s=this.getLayer(),i=e||s&&s.hitCanvas;return s&&s.clearBeforeDraw()&&s.getHitCanvas().getContext().clear(),dt.prototype.drawHit.call(this,i,t),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(e){E.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(e)}getHitGraphEnabled(e){return E.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const e=this.parent;!!this.hitCanvas._canvas.parentNode?e.content.removeChild(this.hitCanvas._canvas):e.content.appendChild(this.hitCanvas._canvas)}destroy(){return E.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}}jn.prototype.nodeType="Layer",Be(jn),y.addGetterSetter(jn,"imageSmoothingEnabled",!0),y.addGetterSetter(jn,"clearBeforeDraw",!0),y.addGetterSetter(jn,"hitGraphEnabled",!0,Et());class Ra extends jn{constructor(e){super(e),this.listening(!1),E.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}Ra.prototype.nodeType="FastLayer",Be(Ra);class ps extends dt{_validateAdd(e){const t=e.getType();t!=="Group"&&t!=="Shape"&&E.throw("You may only add groups and shapes to groups.")}}ps.prototype.nodeType="Group",Be(ps);const Ia=(function(){return Wn.performance&&Wn.performance.now?function(){return Wn.performance.now()}:function(){return new Date().getTime()}})();class vt{constructor(e,t){this.id=vt.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:Ia(),frameRate:0},this.func=e,this.setLayers(t)}setLayers(e){let t=[];return e&&(t=Array.isArray(e)?e:[e]),this.layers=t,this}getLayers(){return this.layers}addLayer(e){const t=this.layers,s=t.length;for(let i=0;i<s;i++)if(t[i]._id===e._id)return!1;return this.layers.push(e),!0}isRunning(){const t=vt.animations,s=t.length;for(let i=0;i<s;i++)if(t[i].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=Ia(),vt._addAnimation(this),this}stop(){return vt._removeAnimation(this),this}_updateFrameObject(e){this.frame.timeDiff=e-this.frame.lastTime,this.frame.lastTime=e,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(e){this.animations.push(e),this._handleAnimation()}static _removeAnimation(e){const t=e.id,s=this.animations,i=s.length;for(let r=0;r<i;r++)if(s[r].id===t){this.animations.splice(r,1);break}}static _runFrames(){const e={},t=this.animations;for(let s=0;s<t.length;s++){const i=t[s],r=i.layers,a=i.func;i._updateFrameObject(Ia());const o=r.length;let l;if(a?l=a.call(i,i.frame)!==!1:l=!0,!!l)for(let c=0;c<o;c++){const d=r[c];d._id!==void 0&&(e[d._id]=d)}}for(const s in e)e.hasOwnProperty(s)&&e[s].batchDraw()}static _animationLoop(){const e=vt;e.animations.length?(e._runFrames(),E.requestAnimFrame(e._animationLoop)):e.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,E.requestAnimFrame(this._animationLoop))}}vt.animations=[],vt.animIdCounter=0,vt.animRunning=!1;const ug={node:1,duration:1,easing:1,onFinish:1,yoyo:1},fg=1,Qc=2,ed=3,td=["fill","stroke","shadowColor"];let pg=0;class gg{constructor(e,t,s,i,r,a,o){this.prop=e,this.propFunc=t,this.begin=i,this._pos=i,this.duration=a,this._change=0,this.prevPos=0,this.yoyo=o,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=s,this._change=r-this.begin,this.pause()}fire(e){const t=this[e];t&&t()}setTime(e){e>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():e<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=e,this.update())}getTime(){return this._time}setPosition(e){this.prevPos=this._pos,this.propFunc(e),this._pos=e}getPosition(e){return e===void 0&&(e=this._time),this.func(e,this.begin,this._change,this.duration)}play(){this.state=Qc,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=ed,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(e){this.pause(),this._time=e,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const e=this.getTimer()-this._startTime;this.state===Qc?this.setTime(e):this.state===ed&&this.setTime(this.duration-e)}pause(){this.state=fg,this.fire("onPause")}getTimer(){return new Date().getTime()}}class Me{constructor(e){const t=this,s=e.node,i=s._id,r=e.easing||ti.Linear,a=!!e.yoyo;let o,l;typeof e.duration>"u"?o=.3:e.duration===0?o=.001:o=e.duration,this.node=s,this._id=pg++;const c=s.getLayer()||(s instanceof X.Stage?s.getLayers():null);c||E.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new vt(function(){t.tween.onEnterFrame()},c),this.tween=new gg(l,function(d){t._tweenFunc(d)},r,0,1,o*1e3,a),this._addListeners(),Me.attrs[i]||(Me.attrs[i]={}),Me.attrs[i][this._id]||(Me.attrs[i][this._id]={}),Me.tweens[i]||(Me.tweens[i]={});for(l in e)ug[l]===void 0&&this._addAttr(l,e[l]);this.reset(),this.onFinish=e.onFinish,this.onReset=e.onReset,this.onUpdate=e.onUpdate}_addAttr(e,t){const s=this.node,i=s._id;let r,a,o,l,c;const d=Me.tweens[i][e];d&&delete Me.attrs[i][d][e];let h=s.getAttr(e);if(E._isArray(t))if(r=[],a=Math.max(t.length,h.length),e==="points"&&t.length!==h.length&&(t.length>h.length?(l=h,h=E._prepareArrayForTween(h,t,s.closed())):(o=t,t=E._prepareArrayForTween(t,h,s.closed()))),e.indexOf("fill")===0)for(let u=0;u<a;u++)if(u%2===0)r.push(t[u]-h[u]);else{const f=E.colorToRGBA(h[u]);c=E.colorToRGBA(t[u]),h[u]=f,r.push({r:c.r-f.r,g:c.g-f.g,b:c.b-f.b,a:c.a-f.a})}else for(let u=0;u<a;u++)r.push(t[u]-h[u]);else td.indexOf(e)!==-1?(h=E.colorToRGBA(h),c=E.colorToRGBA(t),r={r:c.r-h.r,g:c.g-h.g,b:c.b-h.b,a:c.a-h.a}):r=t-h;Me.attrs[i][this._id][e]={start:h,diff:r,end:t,trueEnd:o,trueStart:l},Me.tweens[i][e]=this._id}_tweenFunc(e){const t=this.node,s=Me.attrs[t._id][this._id];let i,r,a,o,l,c,d,h;for(i in s){if(r=s[i],a=r.start,o=r.diff,h=r.end,E._isArray(a))if(l=[],d=Math.max(a.length,h.length),i.indexOf("fill")===0)for(c=0;c<d;c++)c%2===0?l.push((a[c]||0)+o[c]*e):l.push("rgba("+Math.round(a[c].r+o[c].r*e)+","+Math.round(a[c].g+o[c].g*e)+","+Math.round(a[c].b+o[c].b*e)+","+(a[c].a+o[c].a*e)+")");else for(c=0;c<d;c++)l.push((a[c]||0)+o[c]*e);else td.indexOf(i)!==-1?l="rgba("+Math.round(a.r+o.r*e)+","+Math.round(a.g+o.g*e)+","+Math.round(a.b+o.b*e)+","+(a.a+o.a*e)+")":l=a+o*e;t.setAttr(i,l)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const e=this.node,t=Me.attrs[e._id][this._id];t.points&&t.points.trueEnd&&e.setAttr("points",t.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const e=this.node,t=Me.attrs[e._id][this._id];t.points&&t.points.trueStart&&e.points(t.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(e){return this.tween.seek(e*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const e=this.node._id,t=this._id,s=Me.tweens[e];this.pause(),this.anim&&this.anim.stop();for(const i in s)delete Me.tweens[e][i];delete Me.attrs[e][t],Me.tweens[e]&&(Object.keys(Me.tweens[e]).length===0&&delete Me.tweens[e],Object.keys(Me.attrs[e]).length===0&&delete Me.attrs[e])}}Me.attrs={},Me.tweens={},z.prototype.to=function(n){const e=n.onFinish;n.node=this,n.onFinish=function(){this.destroy(),e&&e()},new Me(n).play()};const ti={BackEaseIn(n,e,t,s){return t*(n/=s)*n*((1.70158+1)*n-1.70158)+e},BackEaseOut(n,e,t,s){return t*((n=n/s-1)*n*((1.70158+1)*n+1.70158)+1)+e},BackEaseInOut(n,e,t,s){let i=1.70158;return(n/=s/2)<1?t/2*(n*n*(((i*=1.525)+1)*n-i))+e:t/2*((n-=2)*n*(((i*=1.525)+1)*n+i)+2)+e},ElasticEaseIn(n,e,t,s,i,r){let a=0;return n===0?e:(n/=s)===1?e+t:(r||(r=s*.3),!i||i<Math.abs(t)?(i=t,a=r/4):a=r/(2*Math.PI)*Math.asin(t/i),-(i*Math.pow(2,10*(n-=1))*Math.sin((n*s-a)*(2*Math.PI)/r))+e)},ElasticEaseOut(n,e,t,s,i,r){let a=0;return n===0?e:(n/=s)===1?e+t:(r||(r=s*.3),!i||i<Math.abs(t)?(i=t,a=r/4):a=r/(2*Math.PI)*Math.asin(t/i),i*Math.pow(2,-10*n)*Math.sin((n*s-a)*(2*Math.PI)/r)+t+e)},ElasticEaseInOut(n,e,t,s,i,r){let a=0;return n===0?e:(n/=s/2)===2?e+t:(r||(r=s*(.3*1.5)),!i||i<Math.abs(t)?(i=t,a=r/4):a=r/(2*Math.PI)*Math.asin(t/i),n<1?-.5*(i*Math.pow(2,10*(n-=1))*Math.sin((n*s-a)*(2*Math.PI)/r))+e:i*Math.pow(2,-10*(n-=1))*Math.sin((n*s-a)*(2*Math.PI)/r)*.5+t+e)},BounceEaseOut(n,e,t,s){return(n/=s)<1/2.75?t*(7.5625*n*n)+e:n<2/2.75?t*(7.5625*(n-=1.5/2.75)*n+.75)+e:n<2.5/2.75?t*(7.5625*(n-=2.25/2.75)*n+.9375)+e:t*(7.5625*(n-=2.625/2.75)*n+.984375)+e},BounceEaseIn(n,e,t,s){return t-ti.BounceEaseOut(s-n,0,t,s)+e},BounceEaseInOut(n,e,t,s){return n<s/2?ti.BounceEaseIn(n*2,0,t,s)*.5+e:ti.BounceEaseOut(n*2-s,0,t,s)*.5+t*.5+e},EaseIn(n,e,t,s){return t*(n/=s)*n+e},EaseOut(n,e,t,s){return-t*(n/=s)*(n-2)+e},EaseInOut(n,e,t,s){return(n/=s/2)<1?t/2*n*n+e:-t/2*(--n*(n-2)-1)+e},StrongEaseIn(n,e,t,s){return t*(n/=s)*n*n*n*n+e},StrongEaseOut(n,e,t,s){return t*((n=n/s-1)*n*n*n*n+1)+e},StrongEaseInOut(n,e,t,s){return(n/=s/2)<1?t/2*n*n*n*n*n+e:t/2*((n-=2)*n*n*n*n+2)+e},Linear(n,e,t,s){return t*n/s+e}},nd=E._assign(X,{Util:E,Transform:ct,Node:z,Container:dt,Stage:nr,stages:Qs,Layer:jn,FastLayer:Ra,Group:ps,DD:Ce,Shape:B,shapes:ei,Animation:vt,Tween:Me,Easings:ti,Context:Yi,Canvas:va});class Jt extends B{_sceneFunc(e){const t=X.getAngle(this.angle()),s=this.clockwise();e.beginPath(),e.arc(0,0,this.outerRadius(),0,t,s),e.arc(0,0,this.innerRadius(),t,0,!s),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}getSelfRect(){const e=this.innerRadius(),t=this.outerRadius(),s=this.clockwise(),i=X.getAngle(s?360-this.angle():this.angle()),r=Math.cos(Math.min(i,Math.PI)),a=1,o=Math.sin(Math.min(Math.max(Math.PI,i),3*Math.PI/2)),l=Math.sin(Math.min(i,Math.PI/2)),c=r*(r>0?e:t),d=a*t,h=o*(o>0?e:t),u=l*(l>0?t:e);return{x:c,y:s?-1*u:h,width:d-c,height:u-h}}}Jt.prototype._centroid=!0,Jt.prototype.className="Arc",Jt.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"],Be(Jt),y.addGetterSetter(Jt,"innerRadius",0,Y()),y.addGetterSetter(Jt,"outerRadius",0,Y()),y.addGetterSetter(Jt,"angle",0,Y()),y.addGetterSetter(Jt,"clockwise",!1,Et());function Pa(n,e,t,s,i,r,a){const o=Math.sqrt(Math.pow(t-n,2)+Math.pow(s-e,2)),l=Math.sqrt(Math.pow(i-t,2)+Math.pow(r-s,2)),c=a*o/(o+l),d=a*l/(o+l),h=t-c*(i-n),u=s-c*(r-e),f=t+d*(i-n),p=s+d*(r-e);return[h,u,f,p]}function sd(n,e){const t=n.length,s=[];for(let i=2;i<t-2;i+=2){const r=Pa(n[i-2],n[i-1],n[i],n[i+1],n[i+2],n[i+3],e);isNaN(r[0])||(s.push(r[0]),s.push(r[1]),s.push(n[i]),s.push(n[i+1]),s.push(r[2]),s.push(r[3]))}return s}class Qt extends B{constructor(e){super(e),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(e){const t=this.points(),s=t.length,i=this.tension(),r=this.closed(),a=this.bezier();if(!s)return;let o=0;if(e.beginPath(),e.moveTo(t[0],t[1]),i!==0&&s>4){const l=this.getTensionPoints(),c=l.length;for(o=r?0:4,r||e.quadraticCurveTo(l[0],l[1],l[2],l[3]);o<c-2;)e.bezierCurveTo(l[o++],l[o++],l[o++],l[o++],l[o++],l[o++]);r||e.quadraticCurveTo(l[c-2],l[c-1],t[s-2],t[s-1])}else if(a)for(o=2;o<s;)e.bezierCurveTo(t[o++],t[o++],t[o++],t[o++],t[o++],t[o++]);else for(o=2;o<s;o+=2)e.lineTo(t[o],t[o+1]);r?(e.closePath(),e.fillStrokeShape(this)):e.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():sd(this.points(),this.tension())}_getTensionPointsClosed(){const e=this.points(),t=e.length,s=this.tension(),i=Pa(e[t-2],e[t-1],e[0],e[1],e[2],e[3],s),r=Pa(e[t-4],e[t-3],e[t-2],e[t-1],e[0],e[1],s),a=sd(e,s);return[i[2],i[3]].concat(a).concat([r[0],r[1],e[t-2],e[t-1],r[2],r[3],i[0],i[1],e[0],e[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let e=this.points();if(e.length<4)return{x:e[0]||0,y:e[1]||0,width:0,height:0};this.tension()!==0?e=[e[0],e[1],...this._getTensionPoints(),e[e.length-2],e[e.length-1]]:e=this.points();let t=e[0],s=e[0],i=e[1],r=e[1],a,o;for(let l=0;l<e.length/2;l++)a=e[l*2],o=e[l*2+1],t=Math.min(t,a),s=Math.max(s,a),i=Math.min(i,o),r=Math.max(r,o);return{x:t,y:i,width:s-t,height:r-i}}}Qt.prototype.className="Line",Qt.prototype._attrsAffectingSize=["points","bezier","tension"],Be(Qt),y.addGetterSetter(Qt,"closed",!1),y.addGetterSetter(Qt,"bezier",!1),y.addGetterSetter(Qt,"tension",0,Y()),y.addGetterSetter(Qt,"points",[],Mp());const mg=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],_g=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],vg=[[1],[1,1],[1,2,1],[1,3,3,1]],id=(n,e,t)=>{let s,i;const a=t/2;s=0;for(let o=0;o<20;o++)i=a*mg[20][o]+a,s+=_g[20][o]*yg(n,e,i);return a*s},rd=(n,e,t)=>{t===void 0&&(t=1);const s=n[0]-2*n[1]+n[2],i=e[0]-2*e[1]+e[2],r=2*n[1]-2*n[0],a=2*e[1]-2*e[0],o=4*(s*s+i*i),l=4*(s*r+i*a),c=r*r+a*a;if(o===0)return t*Math.sqrt(Math.pow(n[2]-n[0],2)+Math.pow(e[2]-e[0],2));const d=l/(2*o),h=c/o,u=t+d,f=h-d*d,p=u*u+f>0?Math.sqrt(u*u+f):0,m=d*d+f>0?Math.sqrt(d*d+f):0,v=d+Math.sqrt(d*d+f)!==0?f*Math.log(Math.abs((u+p)/(d+m))):0;return Math.sqrt(o)/2*(u*p-d*m+v)};function yg(n,e,t){const s=Ma(1,t,n),i=Ma(1,t,e),r=s*s+i*i;return Math.sqrt(r)}const Ma=(n,e,t)=>{const s=t.length-1;let i,r;if(s===0)return 0;if(n===0){r=0;for(let a=0;a<=s;a++)r+=vg[s][a]*Math.pow(1-e,s-a)*Math.pow(e,a)*t[a];return r}else{i=new Array(s);for(let a=0;a<s;a++)i[a]=s*(t[a+1]-t[a]);return Ma(n-1,e,i)}},ad=(n,e,t)=>{let s=1,i=n/e,r=(n-t(i))/e,a=0;for(;s>.001;){const o=t(i+r),l=Math.abs(n-o)/e;if(l<s)s=l,i+=r;else{const c=t(i-r),d=Math.abs(n-c)/e;d<s?(s=d,i-=r):r/=2}if(a++,a>500)break}return i};class Oe extends B{constructor(e){super(e),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=Oe.parsePathData(this.data()),this.pathLength=Oe.getPathLength(this.dataArray)}_sceneFunc(e){const t=this.dataArray;e.beginPath();let s=!1;for(let i=0;i<t.length;i++){const r=t[i].command,a=t[i].points;switch(r){case"L":e.lineTo(a[0],a[1]);break;case"M":e.moveTo(a[0],a[1]);break;case"C":e.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5]);break;case"Q":e.quadraticCurveTo(a[0],a[1],a[2],a[3]);break;case"A":const o=a[0],l=a[1],c=a[2],d=a[3],h=a[4],u=a[5],f=a[6],p=a[7],m=c>d?c:d,v=c>d?1:c/d,S=c>d?d/c:1;e.translate(o,l),e.rotate(f),e.scale(v,S),e.arc(0,0,m,h,h+u,1-p),e.scale(1/v,1/S),e.rotate(-f),e.translate(-o,-l);break;case"z":s=!0,e.closePath();break}}!s&&!this.hasFill()?e.strokeShape(this):e.fillStrokeShape(this)}getSelfRect(){let e=[];this.dataArray.forEach(function(l){if(l.command==="A"){const c=l.points[4],d=l.points[5],h=l.points[4]+d;let u=Math.PI/180;if(Math.abs(c-h)<u&&(u=Math.abs(c-h)),d<0)for(let f=c-u;f>h;f-=u){const p=Oe.getPointOnEllipticalArc(l.points[0],l.points[1],l.points[2],l.points[3],f,0);e.push(p.x,p.y)}else for(let f=c+u;f<h;f+=u){const p=Oe.getPointOnEllipticalArc(l.points[0],l.points[1],l.points[2],l.points[3],f,0);e.push(p.x,p.y)}}else if(l.command==="C")for(let c=0;c<=1;c+=.01){const d=Oe.getPointOnCubicBezier(c,l.start.x,l.start.y,l.points[0],l.points[1],l.points[2],l.points[3],l.points[4],l.points[5]);e.push(d.x,d.y)}else e=e.concat(l.points)});let t=e[0],s=e[0],i=e[1],r=e[1],a,o;for(let l=0;l<e.length/2;l++)a=e[l*2],o=e[l*2+1],isNaN(a)||(t=Math.min(t,a),s=Math.max(s,a)),isNaN(o)||(i=Math.min(i,o),r=Math.max(r,o));return{x:t,y:i,width:s-t,height:r-i}}getLength(){return this.pathLength}getPointAtLength(e){return Oe.getPointAtLengthOfDataArray(e,this.dataArray)}static getLineLength(e,t,s,i){return Math.sqrt((s-e)*(s-e)+(i-t)*(i-t))}static getPathLength(e){let t=0;for(let s=0;s<e.length;++s)t+=e[s].pathLength;return t}static getPointAtLengthOfDataArray(e,t){let s,i=0,r=t.length;if(!r)return null;for(;i<r&&e>t[i].pathLength;)e-=t[i].pathLength,++i;if(i===r)return s=t[i-1].points.slice(-2),{x:s[0],y:s[1]};if(e<.01)return t[i].command==="M"?(s=t[i].points.slice(0,2),{x:s[0],y:s[1]}):{x:t[i].start.x,y:t[i].start.y};const a=t[i],o=a.points;switch(a.command){case"L":return Oe.getPointOnLine(e,a.start.x,a.start.y,o[0],o[1]);case"C":return Oe.getPointOnCubicBezier(ad(e,Oe.getPathLength(t),m=>id([a.start.x,o[0],o[2],o[4]],[a.start.y,o[1],o[3],o[5]],m)),a.start.x,a.start.y,o[0],o[1],o[2],o[3],o[4],o[5]);case"Q":return Oe.getPointOnQuadraticBezier(ad(e,Oe.getPathLength(t),m=>rd([a.start.x,o[0],o[2]],[a.start.y,o[1],o[3]],m)),a.start.x,a.start.y,o[0],o[1],o[2],o[3]);case"A":const l=o[0],c=o[1],d=o[2],h=o[3],u=o[5],f=o[6];let p=o[4];return p+=u*e/a.pathLength,Oe.getPointOnEllipticalArc(l,c,d,h,p,f)}return null}static getPointOnLine(e,t,s,i,r,a,o){a=a??t,o=o??s;const l=this.getLineLength(t,s,i,r);if(l<1e-10)return{x:t,y:s};if(i===t)return{x:a,y:o+(r>s?e:-e)};const c=(r-s)/(i-t),d=Math.sqrt(e*e/(1+c*c))*(i<t?-1:1),h=c*d;if(Math.abs(o-s-c*(a-t))<1e-10)return{x:a+d,y:o+h};const u=((a-t)*(i-t)+(o-s)*(r-s))/(l*l),f=t+u*(i-t),p=s+u*(r-s),m=this.getLineLength(a,o,f,p),v=Math.sqrt(e*e-m*m),S=Math.sqrt(v*v/(1+c*c))*(i<t?-1:1),k=c*S;return{x:f+S,y:p+k}}static getPointOnCubicBezier(e,t,s,i,r,a,o,l,c){function d(v){return v*v*v}function h(v){return 3*v*v*(1-v)}function u(v){return 3*v*(1-v)*(1-v)}function f(v){return(1-v)*(1-v)*(1-v)}const p=l*d(e)+a*h(e)+i*u(e)+t*f(e),m=c*d(e)+o*h(e)+r*u(e)+s*f(e);return{x:p,y:m}}static getPointOnQuadraticBezier(e,t,s,i,r,a,o){function l(f){return f*f}function c(f){return 2*f*(1-f)}function d(f){return(1-f)*(1-f)}const h=a*l(e)+i*c(e)+t*d(e),u=o*l(e)+r*c(e)+s*d(e);return{x:h,y:u}}static getPointOnEllipticalArc(e,t,s,i,r,a){const o=Math.cos(a),l=Math.sin(a),c={x:s*Math.cos(r),y:i*Math.sin(r)};return{x:e+(c.x*o-c.y*l),y:t+(c.x*l+c.y*o)}}static parsePathData(e){if(!e)return[];let t=e;const s=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];t=t.replace(new RegExp(" ","g"),",");for(let h=0;h<s.length;h++)t=t.replace(new RegExp(s[h],"g"),"|"+s[h]);const i=t.split("|"),r=[],a=[];let o=0,l=0;const c=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let d;for(let h=1;h<i.length;h++){let u=i[h],f=u.charAt(0);for(u=u.slice(1),a.length=0;d=c.exec(u);)a.push(d[0]);let p=[],m=f==="A"||f==="a"?0:-1;for(let v=0,S=a.length;v<S;v++){const k=a[v];if(k==="00"){p.push(0,0),m>=0&&(m+=2,m>=7&&(m-=7));continue}if(m>=0){if(m===3){if(/^[01]{2}\d+(?:\.\d+)?$/.test(k)){p.push(parseInt(k[0],10)),p.push(parseInt(k[1],10)),p.push(parseFloat(k.slice(2))),m+=3,m>=7&&(m-=7);continue}if(k==="11"||k==="10"||k==="01"){p.push(parseInt(k[0],10)),p.push(parseInt(k[1],10)),m+=2,m>=7&&(m-=7);continue}if(k==="0"||k==="1"){p.push(parseInt(k,10)),m+=1,m>=7&&(m-=7);continue}}else if(m===4){if(/^[01]\d+(?:\.\d+)?$/.test(k)){p.push(parseInt(k[0],10)),p.push(parseFloat(k.slice(1))),m+=2,m>=7&&(m-=7);continue}if(k==="0"||k==="1"){p.push(parseInt(k,10)),m+=1,m>=7&&(m-=7);continue}}const b=parseFloat(k);isNaN(b)?p.push(0):p.push(b),m+=1,m>=7&&(m-=7)}else{const b=parseFloat(k);isNaN(b)?p.push(0):p.push(b)}}for(;p.length>0&&!isNaN(p[0]);){let v="",S=[];const k=o,b=l;let _,C,A,L,O,I,W,K,g,w;switch(f){case"l":o+=p.shift(),l+=p.shift(),v="L",S.push(o,l);break;case"L":o=p.shift(),l=p.shift(),S.push(o,l);break;case"m":const R=p.shift(),P=p.shift();if(o+=R,l+=P,v="M",r.length>2&&r[r.length-1].command==="z"){for(let M=r.length-2;M>=0;M--)if(r[M].command==="M"){o=r[M].points[0]+R,l=r[M].points[1]+P;break}}S.push(o,l),f="l";break;case"M":o=p.shift(),l=p.shift(),v="M",S.push(o,l),f="L";break;case"h":o+=p.shift(),v="L",S.push(o,l);break;case"H":o=p.shift(),v="L",S.push(o,l);break;case"v":l+=p.shift(),v="L",S.push(o,l);break;case"V":l=p.shift(),v="L",S.push(o,l);break;case"C":S.push(p.shift(),p.shift(),p.shift(),p.shift()),o=p.shift(),l=p.shift(),S.push(o,l);break;case"c":S.push(o+p.shift(),l+p.shift(),o+p.shift(),l+p.shift()),o+=p.shift(),l+=p.shift(),v="C",S.push(o,l);break;case"S":C=o,A=l,_=r[r.length-1],_.command==="C"&&(C=o+(o-_.points[2]),A=l+(l-_.points[3])),S.push(C,A,p.shift(),p.shift()),o=p.shift(),l=p.shift(),v="C",S.push(o,l);break;case"s":C=o,A=l,_=r[r.length-1],_.command==="C"&&(C=o+(o-_.points[2]),A=l+(l-_.points[3])),S.push(C,A,o+p.shift(),l+p.shift()),o+=p.shift(),l+=p.shift(),v="C",S.push(o,l);break;case"Q":S.push(p.shift(),p.shift()),o=p.shift(),l=p.shift(),S.push(o,l);break;case"q":S.push(o+p.shift(),l+p.shift()),o+=p.shift(),l+=p.shift(),v="Q",S.push(o,l);break;case"T":C=o,A=l,_=r[r.length-1],_.command==="Q"&&(C=o+(o-_.points[0]),A=l+(l-_.points[1])),o=p.shift(),l=p.shift(),v="Q",S.push(C,A,o,l);break;case"t":C=o,A=l,_=r[r.length-1],_.command==="Q"&&(C=o+(o-_.points[0]),A=l+(l-_.points[1])),o+=p.shift(),l+=p.shift(),v="Q",S.push(C,A,o,l);break;case"A":L=p.shift(),O=p.shift(),I=p.shift(),W=p.shift(),K=p.shift(),g=o,w=l,o=p.shift(),l=p.shift(),v="A",S=this.convertEndpointToCenterParameterization(g,w,o,l,W,K,L,O,I);break;case"a":L=p.shift(),O=p.shift(),I=p.shift(),W=p.shift(),K=p.shift(),g=o,w=l,o+=p.shift(),l+=p.shift(),v="A",S=this.convertEndpointToCenterParameterization(g,w,o,l,W,K,L,O,I);break}r.push({command:v||f,points:S,start:{x:k,y:b},pathLength:this.calcLength(k,b,v||f,S)})}(f==="z"||f==="Z")&&r.push({command:"z",points:[],start:void 0,pathLength:0})}return r}static calcLength(e,t,s,i){let r,a,o,l;const c=Oe;switch(s){case"L":return c.getLineLength(e,t,i[0],i[1]);case"C":return id([e,i[0],i[2],i[4]],[t,i[1],i[3],i[5]],1);case"Q":return rd([e,i[0],i[2]],[t,i[1],i[3]],1);case"A":r=0;const d=i[4],h=i[5],u=i[4]+h;let f=Math.PI/180;if(Math.abs(d-u)<f&&(f=Math.abs(d-u)),a=c.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],d,0),h<0)for(l=d-f;l>u;l-=f)o=c.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],l,0),r+=c.getLineLength(a.x,a.y,o.x,o.y),a=o;else for(l=d+f;l<u;l+=f)o=c.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],l,0),r+=c.getLineLength(a.x,a.y,o.x,o.y),a=o;return o=c.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],u,0),r+=c.getLineLength(a.x,a.y,o.x,o.y),r}return 0}static convertEndpointToCenterParameterization(e,t,s,i,r,a,o,l,c){const d=c*(Math.PI/180),h=Math.cos(d)*(e-s)/2+Math.sin(d)*(t-i)/2,u=-1*Math.sin(d)*(e-s)/2+Math.cos(d)*(t-i)/2,f=h*h/(o*o)+u*u/(l*l);f>1&&(o*=Math.sqrt(f),l*=Math.sqrt(f));let p=Math.sqrt((o*o*(l*l)-o*o*(u*u)-l*l*(h*h))/(o*o*(u*u)+l*l*(h*h)));r===a&&(p*=-1),isNaN(p)&&(p=0);const m=p*o*u/l,v=p*-l*h/o,S=(e+s)/2+Math.cos(d)*m-Math.sin(d)*v,k=(t+i)/2+Math.sin(d)*m+Math.cos(d)*v,b=function(W){return Math.sqrt(W[0]*W[0]+W[1]*W[1])},_=function(W,K){return(W[0]*K[0]+W[1]*K[1])/(b(W)*b(K))},C=function(W,K){return(W[0]*K[1]<W[1]*K[0]?-1:1)*Math.acos(_(W,K))},A=C([1,0],[(h-m)/o,(u-v)/l]),L=[(h-m)/o,(u-v)/l],O=[(-1*h-m)/o,(-1*u-v)/l];let I=C(L,O);return _(L,O)<=-1&&(I=Math.PI),_(L,O)>=1&&(I=0),a===0&&I>0&&(I=I-2*Math.PI),a===1&&I<0&&(I=I+2*Math.PI),[S,k,o,l,A,I,d,a]}}Oe.prototype.className="Path",Oe.prototype._attrsAffectingSize=["data"],Be(Oe),y.addGetterSetter(Oe,"data");class zn extends Qt{_sceneFunc(e){super._sceneFunc(e);const t=Math.PI*2,s=this.points();let i=s;const r=this.tension()!==0&&s.length>4;r&&(i=this.getTensionPoints());const a=this.pointerLength(),o=s.length;let l,c;if(r){const u=[i[i.length-4],i[i.length-3],i[i.length-2],i[i.length-1],s[o-2],s[o-1]],f=Oe.calcLength(i[i.length-4],i[i.length-3],"C",u),p=Oe.getPointOnQuadraticBezier(Math.min(1,1-a/f),u[0],u[1],u[2],u[3],u[4],u[5]);l=s[o-2]-p.x,c=s[o-1]-p.y}else l=s[o-2]-s[o-4],c=s[o-1]-s[o-3];const d=(Math.atan2(c,l)+t)%t,h=this.pointerWidth();this.pointerAtEnding()&&(e.save(),e.beginPath(),e.translate(s[o-2],s[o-1]),e.rotate(d),e.moveTo(0,0),e.lineTo(-a,h/2),e.lineTo(-a,-h/2),e.closePath(),e.restore(),this.__fillStroke(e)),this.pointerAtBeginning()&&(e.save(),e.beginPath(),e.translate(s[0],s[1]),r?(l=(i[0]+i[2])/2-s[0],c=(i[1]+i[3])/2-s[1]):(l=s[2]-s[0],c=s[3]-s[1]),e.rotate((Math.atan2(-c,-l)+t)%t),e.moveTo(0,0),e.lineTo(-a,h/2),e.lineTo(-a,-h/2),e.closePath(),e.restore(),this.__fillStroke(e))}__fillStroke(e){const t=this.dashEnabled();t&&(this.attrs.dashEnabled=!1,e.setLineDash([])),e.fillStrokeShape(this),t&&(this.attrs.dashEnabled=!0)}getSelfRect(){const e=super.getSelfRect(),t=this.pointerWidth()/2;return{x:e.x,y:e.y-t,width:e.width,height:e.height+t*2}}}zn.prototype.className="Arrow",Be(zn),y.addGetterSetter(zn,"pointerLength",10,Y()),y.addGetterSetter(zn,"pointerWidth",10,Y()),y.addGetterSetter(zn,"pointerAtBeginning",!1),y.addGetterSetter(zn,"pointerAtEnding",!0);class gs extends B{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius()!==e/2&&this.radius(e/2)}setHeight(e){this.radius()!==e/2&&this.radius(e/2)}}gs.prototype._centroid=!0,gs.prototype.className="Circle",gs.prototype._attrsAffectingSize=["radius"],Be(gs),y.addGetterSetter(gs,"radius",0,Y());class wn extends B{_sceneFunc(e){const t=this.radiusX(),s=this.radiusY();e.beginPath(),e.save(),t!==s&&e.scale(1,s/t),e.arc(0,0,t,0,Math.PI*2,!1),e.restore(),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(e){this.radiusX(e/2)}setHeight(e){this.radiusY(e/2)}}wn.prototype.className="Ellipse",wn.prototype._centroid=!0,wn.prototype._attrsAffectingSize=["radiusX","radiusY"],Be(wn),y.addComponentsGetterSetter(wn,"radius",["x","y"]),y.addGetterSetter(wn,"radiusX",0,Y()),y.addGetterSetter(wn,"radiusY",0,Y());class ht extends B{constructor(e){super(e),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",t=>{this._removeImageLoad(t.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const e=this.image();e&&e.complete||e&&e.readyState===4||e&&e.addEventListener&&e.addEventListener("load",this._loadListener)}_removeImageLoad(e){e&&e.removeEventListener&&e.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const e=!!this.cornerRadius(),t=this.hasShadow();return e&&t?!0:super._useBufferCanvas(!0)}_sceneFunc(e){const t=this.getWidth(),s=this.getHeight(),i=this.cornerRadius(),r=this.attrs.image;let a;if(r){const o=this.attrs.cropWidth,l=this.attrs.cropHeight;o&&l?a=[r,this.cropX(),this.cropY(),o,l,0,0,t,s]:a=[r,0,0,t,s]}(this.hasFill()||this.hasStroke()||i)&&(e.beginPath(),i?E.drawRoundedRectPath(e,t,s,i):e.rect(0,0,t,s),e.closePath(),e.fillStrokeShape(this)),r&&(i&&e.clip(),e.drawImage.apply(e,a))}_hitFunc(e){const t=this.width(),s=this.height(),i=this.cornerRadius();e.beginPath(),i?E.drawRoundedRectPath(e,t,s,i):e.rect(0,0,t,s),e.closePath(),e.fillStrokeShape(this)}getWidth(){var e,t,s;return(s=(e=this.attrs.width)!==null&&e!==void 0?e:(t=this.image())===null||t===void 0?void 0:t.width)!==null&&s!==void 0?s:0}getHeight(){var e,t,s;return(s=(e=this.attrs.height)!==null&&e!==void 0?e:(t=this.image())===null||t===void 0?void 0:t.height)!==null&&s!==void 0?s:0}static fromURL(e,t,s=null){const i=E.createImageElement();i.onload=function(){const r=new ht({image:i});t(r)},i.onerror=s,i.crossOrigin="Anonymous",i.src=e}}ht.prototype.className="Image",ht.prototype._attrsAffectingSize=["image"],Be(ht),y.addGetterSetter(ht,"cornerRadius",0,Ki(4)),y.addGetterSetter(ht,"image"),y.addComponentsGetterSetter(ht,"crop",["x","y","width","height"]),y.addGetterSetter(ht,"cropX",0,Y()),y.addGetterSetter(ht,"cropY",0,Y()),y.addGetterSetter(ht,"cropWidth",0,Y()),y.addGetterSetter(ht,"cropHeight",0,Y());const od=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],bg="Change.konva",wg="none",Oa="up",Na="right",La="down",Da="left",xg=od.length;class Ga extends ps{constructor(e){super(e),this.on("add.konva",function(t){this._addListeners(t.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(e){let t=this,s;const i=function(){t._sync()};for(s=0;s<xg;s++)e.on(od[s]+bg,i)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let e=this.getText(),t=this.getTag(),s,i,r,a,o,l,c;if(e&&t){switch(s=e.width(),i=e.height(),r=t.pointerDirection(),a=t.pointerWidth(),c=t.pointerHeight(),o=0,l=0,r){case Oa:o=s/2,l=-1*c;break;case Na:o=s+a,l=i/2;break;case La:o=s/2,l=i+c;break;case Da:o=-1*a,l=i/2;break}t.setAttrs({x:-1*o,y:-1*l,width:s,height:i}),e.setAttrs({x:-1*o,y:-1*l})}}}Ga.prototype.className="Label",Be(Ga);class Yn extends B{_sceneFunc(e){const t=this.width(),s=this.height(),i=this.pointerDirection(),r=this.pointerWidth(),a=this.pointerHeight(),o=this.cornerRadius();let l=0,c=0,d=0,h=0;typeof o=="number"?l=c=d=h=Math.min(o,t/2,s/2):(l=Math.min(o[0]||0,t/2,s/2),c=Math.min(o[1]||0,t/2,s/2),h=Math.min(o[2]||0,t/2,s/2),d=Math.min(o[3]||0,t/2,s/2)),e.beginPath(),e.moveTo(l,0),i===Oa&&(e.lineTo((t-r)/2,0),e.lineTo(t/2,-1*a),e.lineTo((t+r)/2,0)),e.lineTo(t-c,0),e.arc(t-c,c,c,Math.PI*3/2,0,!1),i===Na&&(e.lineTo(t,(s-a)/2),e.lineTo(t+r,s/2),e.lineTo(t,(s+a)/2)),e.lineTo(t,s-h),e.arc(t-h,s-h,h,0,Math.PI/2,!1),i===La&&(e.lineTo((t+r)/2,s),e.lineTo(t/2,s+a),e.lineTo((t-r)/2,s)),e.lineTo(d,s),e.arc(d,s-d,d,Math.PI/2,Math.PI,!1),i===Da&&(e.lineTo(0,(s+a)/2),e.lineTo(-1*r,s/2),e.lineTo(0,(s-a)/2)),e.lineTo(0,l),e.arc(l,l,l,Math.PI,Math.PI*3/2,!1),e.closePath(),e.fillStrokeShape(this)}getSelfRect(){let e=0,t=0,s=this.pointerWidth(),i=this.pointerHeight(),r=this.pointerDirection(),a=this.width(),o=this.height();return r===Oa?(t-=i,o+=i):r===La?o+=i:r===Da?(e-=s*1.5,a+=s):r===Na&&(a+=s*1.5),{x:e,y:t,width:a,height:o}}}Yn.prototype.className="Tag",Be(Yn),y.addGetterSetter(Yn,"pointerDirection",wg),y.addGetterSetter(Yn,"pointerWidth",0,Y()),y.addGetterSetter(Yn,"pointerHeight",0,Y()),y.addGetterSetter(Yn,"cornerRadius",0,Ki(4));class ni extends B{_sceneFunc(e){const t=this.cornerRadius(),s=this.width(),i=this.height();e.beginPath(),t?E.drawRoundedRectPath(e,s,i,t):e.rect(0,0,s,i),e.closePath(),e.fillStrokeShape(this)}}ni.prototype.className="Rect",Be(ni),y.addGetterSetter(ni,"cornerRadius",0,Ki(4));class xn extends B{_sceneFunc(e){const t=this._getPoints(),s=this.radius(),i=this.sides(),r=this.cornerRadius();if(e.beginPath(),r)E.drawRoundedPolygonPath(e,t,i,s,r);else{e.moveTo(t[0].x,t[0].y);for(let a=1;a<t.length;a++)e.lineTo(t[a].x,t[a].y)}e.closePath(),e.fillStrokeShape(this)}_getPoints(){const e=this.attrs.sides,t=this.attrs.radius||0,s=[];for(let i=0;i<e;i++)s.push({x:t*Math.sin(i*2*Math.PI/e),y:-1*t*Math.cos(i*2*Math.PI/e)});return s}getSelfRect(){const e=this._getPoints();let t=e[0].x,s=e[0].x,i=e[0].y,r=e[0].y;return e.forEach(a=>{t=Math.min(t,a.x),s=Math.max(s,a.x),i=Math.min(i,a.y),r=Math.max(r,a.y)}),{x:t,y:i,width:s-t,height:r-i}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}xn.prototype.className="RegularPolygon",xn.prototype._centroid=!0,xn.prototype._attrsAffectingSize=["radius"],Be(xn),y.addGetterSetter(xn,"radius",0,Y()),y.addGetterSetter(xn,"sides",0,Y()),y.addGetterSetter(xn,"cornerRadius",0,Ki(4));const ld=Math.PI*2;class Xn extends B{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.innerRadius(),0,ld,!1),e.moveTo(this.outerRadius(),0),e.arc(0,0,this.outerRadius(),ld,0,!0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}Xn.prototype.className="Ring",Xn.prototype._centroid=!0,Xn.prototype._attrsAffectingSize=["innerRadius","outerRadius"],Be(Xn),y.addGetterSetter(Xn,"innerRadius",0,Y()),y.addGetterSetter(Xn,"outerRadius",0,Y());class Gt extends B{constructor(e){super(e),this._updated=!0,this.anim=new vt(()=>{const t=this._updated;return this._updated=!1,t}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(e){const t=this.animation(),s=this.frameIndex(),i=s*4,r=this.animations()[t],a=this.frameOffsets(),o=r[i+0],l=r[i+1],c=r[i+2],d=r[i+3],h=this.image();if((this.hasFill()||this.hasStroke())&&(e.beginPath(),e.rect(0,0,c,d),e.closePath(),e.fillStrokeShape(this)),h)if(a){const u=a[t],f=s*2;e.drawImage(h,o,l,c,d,u[f+0],u[f+1],c,d)}else e.drawImage(h,o,l,c,d,0,0,c,d)}_hitFunc(e){const t=this.animation(),s=this.frameIndex(),i=s*4,r=this.animations()[t],a=this.frameOffsets(),o=r[i+2],l=r[i+3];if(e.beginPath(),a){const c=a[t],d=s*2;e.rect(c[d+0],c[d+1],o,l)}else e.rect(0,0,o,l);e.closePath(),e.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const e=this;this.interval=setInterval(function(){e._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const e=this.getLayer();this.anim.setLayers(e),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const e=this.frameIndex(),t=this.animation(),s=this.animations(),i=s[t],r=i.length/4;e<r-1?this.frameIndex(e+1):this.frameIndex(0)}}Gt.prototype.className="Sprite",Be(Gt),y.addGetterSetter(Gt,"animation"),y.addGetterSetter(Gt,"animations"),y.addGetterSetter(Gt,"frameOffsets"),y.addGetterSetter(Gt,"image"),y.addGetterSetter(Gt,"frameIndex",0,Y()),y.addGetterSetter(Gt,"frameRate",17,Y()),y.backCompat(Gt,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});class Sn extends B{_sceneFunc(e){const t=this.innerRadius(),s=this.outerRadius(),i=this.numPoints();e.beginPath(),e.moveTo(0,0-s);for(let r=1;r<i*2;r++){const a=r%2===0?s:t,o=a*Math.sin(r*Math.PI/i),l=-1*a*Math.cos(r*Math.PI/i);e.lineTo(o,l)}e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}Sn.prototype.className="Star",Sn.prototype._centroid=!0,Sn.prototype._attrsAffectingSize=["innerRadius","outerRadius"],Be(Sn),y.addGetterSetter(Sn,"numPoints",5,Y()),y.addGetterSetter(Sn,"innerRadius",0,Y()),y.addGetterSetter(Sn,"outerRadius",0,Y());function kn(n){return[...n].reduce((e,t,s,i)=>{if(/\p{Emoji}/u.test(t)){const r=i[s+1];r&&/\p{Emoji_Modifier}|\u200D/u.test(r)?(e.push(t+r),i[s+1]=""):e.push(t)}else/\p{Regional_Indicator}{2}/u.test(t+(i[s+1]||""))?e.push(t+i[s+1]):s>0&&/\p{Mn}|\p{Me}|\p{Mc}/u.test(t)?e[e.length-1]+=t:t&&e.push(t);return e},[])}const ms="auto",Sg="center",cd="inherit",si="justify",kg="Change.konva",Cg="2d",dd="-",hd="left",Tg="text",Eg="Text",Ag="top",Rg="bottom",ud="middle",fd="normal",Ig="px ",ir=" ",Pg="right",pd="rtl",Mg="word",Og="char",gd="none",Fa="",md=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],Ng=md.length;function Lg(n){return n.split(",").map(e=>{e=e.trim();const t=e.indexOf(" ")>=0,s=e.indexOf('"')>=0||e.indexOf("'")>=0;return t&&!s&&(e=`"${e}"`),e}).join(", ")}let rr;function Ba(){return rr||(rr=E.createCanvasElement().getContext(Cg),rr)}function Dg(n){n.fillText(this._partialText,this._partialTextX,this._partialTextY)}function Gg(n){n.setAttr("miterLimit",2),n.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function Fg(n){return n=n||{},!n.fillLinearGradientColorStops&&!n.fillRadialGradientColorStops&&!n.fillPatternImage&&(n.fill=n.fill||"black"),n}class De extends B{constructor(e){super(Fg(e)),this._partialTextX=0,this._partialTextY=0;for(let t=0;t<Ng;t++)this.on(md[t]+kg,this._setTextData);this._setTextData()}_sceneFunc(e){var t,s;const i=this.textArr,r=i.length;if(!this.text())return;let a=this.padding(),o=this.fontSize(),l=this.lineHeight()*o,c=this.verticalAlign(),d=this.direction(),h=0,u=this.align(),f=this.getWidth(),p=this.letterSpacing(),m=this.charRenderFunc(),v=this.fill(),S=this.textDecoration(),k=S.indexOf("underline")!==-1,b=S.indexOf("line-through")!==-1,_;d=d===cd?e.direction:d;let C=l/2,A=ud;if(!X.legacyTextRendering){const L=this.measureSize("M");A="alphabetic";const O=(t=L.fontBoundingBoxAscent)!==null&&t!==void 0?t:L.actualBoundingBoxAscent,I=(s=L.fontBoundingBoxDescent)!==null&&s!==void 0?s:L.actualBoundingBoxDescent;C=(O-I)/2+l/2}for(d===pd&&e.setAttr("direction",d),e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",A),e.setAttr("textAlign",hd),c===ud?h=(this.getHeight()-r*l-a*2)/2:c===Rg&&(h=this.getHeight()-r*l-a*2),e.translate(a,h+a),_=0;_<r;_++){let L=0,O=0;const I=i[_],W=I.text,K=I.width,g=I.lastInParagraph;if(e.save(),u===Pg?L+=f-K-a*2:u===Sg&&(L+=(f-K-a*2)/2),k){e.save(),e.beginPath();const R=X.legacyTextRendering?Math.round(o/2):Math.round(o/4),P=L,M=C+O+R;e.moveTo(P,M);const D=u===si&&!g?f-a*2:K;e.lineTo(P+Math.round(D),M),e.lineWidth=o/15;const G=this._getLinearGradient();e.strokeStyle=G||v,e.stroke(),e.restore()}const w=L;if(d!==pd&&(p!==0||u===si||m)){const R=W.split(" ").length-1,P=kn(W);for(let M=0;M<P.length;M++){const D=P[M];if(D===" "&&!g&&u===si&&(L+=(f-a*2-K)/R),this._partialTextX=L,this._partialTextY=C+O,this._partialText=D,m){e.save();const J=i.slice(0,_).reduce((ne,ie)=>ne+kn(ie.text).length,0),ae=M+J;m({char:D,index:ae,x:L,y:C+O,lineIndex:_,column:M,isLastInLine:g,width:this.measureSize(D).width,context:e})}e.fillStrokeShape(this),m&&e.restore(),L+=this.measureSize(D).width+p}}else p!==0&&e.setAttr("letterSpacing",`${p}px`),this._partialTextX=L,this._partialTextY=C+O,this._partialText=W,e.fillStrokeShape(this);if(b){e.save(),e.beginPath();const R=X.legacyTextRendering?0:-Math.round(o/4),P=w;e.moveTo(P,C+O+R);const M=u===si&&!g?f-a*2:K;e.lineTo(P+Math.round(M),C+O+R),e.lineWidth=o/15;const D=this._getLinearGradient();e.strokeStyle=D||v,e.stroke(),e.restore()}e.restore(),r>1&&(C+=l)}}_hitFunc(e){const t=this.getWidth(),s=this.getHeight();e.beginPath(),e.rect(0,0,t,s),e.closePath(),e.fillStrokeShape(this)}setText(e){const t=E._isString(e)?e:e==null?"":e+"";return this._setAttr(Tg,t),this}getWidth(){return this.attrs.width===ms||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===ms||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return E.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(e){var t,s,i,r,a,o,l,c,d,h,u;let f=Ba(),p=this.fontSize(),m;f.save(),f.font=this._getContextFont(),m=f.measureText(e),f.restore();const v=p/100;return{actualBoundingBoxAscent:(t=m.actualBoundingBoxAscent)!==null&&t!==void 0?t:71.58203125*v,actualBoundingBoxDescent:(s=m.actualBoundingBoxDescent)!==null&&s!==void 0?s:0,actualBoundingBoxLeft:(i=m.actualBoundingBoxLeft)!==null&&i!==void 0?i:-7.421875*v,actualBoundingBoxRight:(r=m.actualBoundingBoxRight)!==null&&r!==void 0?r:75.732421875*v,alphabeticBaseline:(a=m.alphabeticBaseline)!==null&&a!==void 0?a:0,emHeightAscent:(o=m.emHeightAscent)!==null&&o!==void 0?o:100*v,emHeightDescent:(l=m.emHeightDescent)!==null&&l!==void 0?l:-20*v,fontBoundingBoxAscent:(c=m.fontBoundingBoxAscent)!==null&&c!==void 0?c:91*v,fontBoundingBoxDescent:(d=m.fontBoundingBoxDescent)!==null&&d!==void 0?d:21*v,hangingBaseline:(h=m.hangingBaseline)!==null&&h!==void 0?h:72.80000305175781*v,ideographicBaseline:(u=m.ideographicBaseline)!==null&&u!==void 0?u:-21*v,width:m.width,height:p}}_getContextFont(){return this.fontStyle()+ir+this.fontVariant()+ir+(this.fontSize()+Ig)+Lg(this.fontFamily())}_addTextLine(e){this.align()===si&&(e=e.trim());const s=this._getTextWidth(e);return this.textArr.push({text:e,width:s,lastInParagraph:!1})}_getTextWidth(e){const t=this.letterSpacing(),s=e.length;return Ba().measureText(e).width+t*s}_setTextData(){let e=this.text().split(`
`),t=+this.fontSize(),s=0,i=this.lineHeight()*t,r=this.attrs.width,a=this.attrs.height,o=r!==ms&&r!==void 0,l=a!==ms&&a!==void 0,c=this.padding(),d=r-c*2,h=a-c*2,u=0,f=this.wrap(),p=f!==gd,m=f!==Og&&p,v=this.ellipsis();this.textArr=[],Ba().font=this._getContextFont();const S=v?this._getTextWidth(Fa):0;for(let k=0,b=e.length;k<b;++k){let _=e[k],C=this._getTextWidth(_);if(o&&C>d)for(;_.length>0;){let A=0,L=kn(_).length,O="",I=0;for(;A<L;){const W=A+L>>>1,K=kn(_),g=K.slice(0,W+1).join(""),w=this._getTextWidth(g);(v&&l&&u+i>h?w+S:w)<=d?(A=W+1,O=g,I=w):L=W}if(O){if(m){const g=kn(_),w=kn(O),R=g[w.length],P=R===ir||R===dd;let M;if(P&&I<=d)M=w.length;else{const D=w.lastIndexOf(ir),G=w.lastIndexOf(dd);M=Math.max(D,G)+1}M>0&&(A=M,O=g.slice(0,A).join(""),I=this._getTextWidth(O))}if(O=O.trimRight(),this._addTextLine(O),s=Math.max(s,I),u+=i,this._shouldHandleEllipsis(u)){this._tryToAddEllipsisToLastLine();break}if(_=kn(_).slice(A).join("").trimLeft(),_.length>0&&(C=this._getTextWidth(_),C<=d)){this._addTextLine(_),u+=i,s=Math.max(s,C);break}}else break}else this._addTextLine(_),u+=i,s=Math.max(s,C),this._shouldHandleEllipsis(u)&&k<b-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),l&&u+i>h)break}this.textHeight=t,this.textWidth=s}_shouldHandleEllipsis(e){const t=+this.fontSize(),s=this.lineHeight()*t,i=this.attrs.height,r=i!==ms&&i!==void 0,a=this.padding(),o=i-a*2;return!(this.wrap()!==gd)||r&&e+s>o}_tryToAddEllipsisToLastLine(){const e=this.attrs.width,t=e!==ms&&e!==void 0,s=this.padding(),i=e-s*2,r=this.ellipsis(),a=this.textArr[this.textArr.length-1];!a||!r||(t&&(this._getTextWidth(a.text+Fa)<i||(a.text=a.text.slice(0,a.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(a.text+Fa))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const e=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,t=this.hasShadow();return e&&t?!0:super._useBufferCanvas()}}De.prototype._fillFunc=Dg,De.prototype._strokeFunc=Gg,De.prototype.className=Eg,De.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],Be(De),y.overWriteSetter(De,"width",ba()),y.overWriteSetter(De,"height",ba()),y.addGetterSetter(De,"direction",cd),y.addGetterSetter(De,"fontFamily","Arial"),y.addGetterSetter(De,"fontSize",12,Y()),y.addGetterSetter(De,"fontStyle",fd),y.addGetterSetter(De,"fontVariant",fd),y.addGetterSetter(De,"padding",0,Y()),y.addGetterSetter(De,"align",hd),y.addGetterSetter(De,"verticalAlign",Ag),y.addGetterSetter(De,"lineHeight",1,Y()),y.addGetterSetter(De,"wrap",Mg),y.addGetterSetter(De,"ellipsis",!1,Et()),y.addGetterSetter(De,"letterSpacing",0,Y()),y.addGetterSetter(De,"text","",Un()),y.addGetterSetter(De,"textDecoration",""),y.addGetterSetter(De,"charRenderFunc",void 0);const Bg="",_d="normal";function vd(n){n.fillText(this.partialText,0,0)}function yd(n){n.strokeText(this.partialText,0,0)}class je extends B{constructor(e){super(e),this.dummyCanvas=E.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return Oe.getPathLength(this.dataArray)}_getPointAtLength(e){if(!this.attrs.data)return null;const t=this.pathLength;return e>t?null:Oe.getPointAtLengthOfDataArray(e,this.dataArray)}_readDataAttribute(){this.dataArray=Oe.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(e){e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",this.textBaseline()),e.setAttr("textAlign","left"),e.save();const t=this.textDecoration(),s=this.fill(),i=this.fontSize(),r=this.glyphInfo,a=t.indexOf("underline")!==-1,o=t.indexOf("line-through")!==-1;a&&e.beginPath();for(let l=0;l<r.length;l++){e.save();const c=r[l].p0;e.translate(c.x,c.y),e.rotate(r[l].rotation),this.partialText=r[l].text,e.fillStrokeShape(this),a&&(l===0&&e.moveTo(0,i/2+1),e.lineTo(r[l].width,i/2+1)),e.restore()}if(a&&(e.strokeStyle=s,e.lineWidth=i/20,e.stroke()),o){e.beginPath();for(let l=0;l<r.length;l++){e.save();const c=r[l].p0;e.translate(c.x,c.y),e.rotate(r[l].rotation),l===0&&e.moveTo(0,0),e.lineTo(r[l].width,0),e.restore()}e.strokeStyle=s,e.lineWidth=i/20,e.stroke()}e.restore()}_hitFunc(e){e.beginPath();const t=this.glyphInfo;if(t.length>=1){const s=t[0].p0;e.moveTo(s.x,s.y)}for(let s=0;s<t.length;s++){const i=t[s].p1;e.lineTo(i.x,i.y)}e.setAttr("lineWidth",this.fontSize()),e.setAttr("strokeStyle",this.colorKey),e.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return E.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(e){return De.prototype.setText.call(this,e)}_getContextFont(){return De.prototype._getContextFont.call(this)}_getTextSize(e){const s=this.dummyCanvas.getContext("2d");s.save(),s.font=this._getContextFont();const i=s.measureText(e);return s.restore(),{width:i.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const e=kn(this.text()),t=[];let s=0;for(let h=0;h<e.length;h++)t.push({char:e[h],width:this._getTextSize(e[h]).width}),s+=t[h].width;const{height:i}=this._getTextSize(this.attrs.text);if(this.textWidth=s,this.textHeight=i,this.glyphInfo=[],!this.attrs.data)return null;const r=this.letterSpacing(),a=this.align(),o=this.kerningFunc(),l=Math.max(this.textWidth+((this.attrs.text||"").length-1)*r,0);let c=0;a==="center"&&(c=Math.max(0,this.pathLength/2-l/2)),a==="right"&&(c=Math.max(0,this.pathLength-l));let d=c;for(let h=0;h<t.length;h++){const u=this._getPointAtLength(d);if(!u)return;const f=t[h].char;let p=t[h].width+r;if(f===" "&&a==="justify"){const _=this.text().split(" ").length-1;p+=(this.pathLength-l)/_}const m=this._getPointAtLength(d+p);if(!m)return;const v=Oe.getLineLength(u.x,u.y,m.x,m.y);let S=0;if(o)try{S=o(t[h-1].char,f)*this.fontSize()}catch{S=0}u.x+=S,m.x+=S,this.textWidth+=S;const k=Oe.getPointOnLine(S+v/2,u.x,u.y,m.x,m.y),b=Math.atan2(m.y-u.y,m.x-u.x);this.glyphInfo.push({transposeX:k.x,transposeY:k.y,text:e[h],rotation:b,p0:u,p1:m,width:v}),d+=p}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const e=[];this.glyphInfo.forEach(function(c){e.push(c.p0.x),e.push(c.p0.y),e.push(c.p1.x),e.push(c.p1.y)});let t=e[0]||0,s=e[0]||0,i=e[1]||0,r=e[1]||0,a,o;for(let c=0;c<e.length/2;c++)a=e[c*2],o=e[c*2+1],t=Math.min(t,a),s=Math.max(s,a),i=Math.min(i,o),r=Math.max(r,o);const l=this.fontSize();return{x:t-l/2,y:i-l/2,width:s-t+l,height:r-i+l}}destroy(){return E.releaseCanvas(this.dummyCanvas),super.destroy()}}je.prototype._fillFunc=vd,je.prototype._strokeFunc=yd,je.prototype._fillFuncHit=vd,je.prototype._strokeFuncHit=yd,je.prototype.className="TextPath",je.prototype._attrsAffectingSize=["text","fontSize","data"],Be(je),y.addGetterSetter(je,"data"),y.addGetterSetter(je,"fontFamily","Arial"),y.addGetterSetter(je,"fontSize",12,Y()),y.addGetterSetter(je,"fontStyle",_d),y.addGetterSetter(je,"align","left"),y.addGetterSetter(je,"letterSpacing",0,Y()),y.addGetterSetter(je,"textBaseline","middle"),y.addGetterSetter(je,"fontVariant",_d),y.addGetterSetter(je,"text",Bg),y.addGetterSetter(je,"textDecoration",""),y.addGetterSetter(je,"kerningFunc",void 0);const bd="tr-konva",Hg=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(n=>n+`.${bd}`).join(" "),wd="nodesRect",$g=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange","draggableChange"],Wg={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},Ug="ontouchstart"in X._global;function Vg(n,e,t){if(n==="rotater")return t;e+=E.degToRad(Wg[n]||0);const s=(E.radToDeg(e)%360+360)%360;return E._inRange(s,337.5,360)||E._inRange(s,0,22.5)?"ns-resize":E._inRange(s,22.5,67.5)?"nesw-resize":E._inRange(s,67.5,112.5)?"ew-resize":E._inRange(s,112.5,157.5)?"nwse-resize":E._inRange(s,157.5,202.5)?"ns-resize":E._inRange(s,202.5,247.5)?"nesw-resize":E._inRange(s,247.5,292.5)?"ew-resize":E._inRange(s,292.5,337.5)?"nwse-resize":(E.error("Transformer has unknown angle for cursor detection: "+s),"pointer")}const ar=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function jg(n){return{x:n.x+n.width/2*Math.cos(n.rotation)+n.height/2*Math.sin(-n.rotation),y:n.y+n.height/2*Math.cos(n.rotation)+n.width/2*Math.sin(n.rotation)}}function xd(n,e,t){const s=t.x+(n.x-t.x)*Math.cos(e)-(n.y-t.y)*Math.sin(e),i=t.y+(n.x-t.x)*Math.sin(e)+(n.y-t.y)*Math.cos(e);return{...n,rotation:n.rotation+e,x:s,y:i}}function zg(n,e){const t=jg(n);return xd(n,e,t)}function Yg(n,e,t){let s=e;for(let i=0;i<n.length;i++){const r=X.getAngle(n[i]),a=Math.abs(r-e)%(Math.PI*2);Math.min(a,Math.PI*2-a)<t&&(s=r)}return s}let Ha=0;class ye extends ps{constructor(e){super(e),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(Hg,this.update),this.getNode()&&this.update()}attachTo(e){return this.setNode(e),this}setNode(e){return E.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([e])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return bd+this._id}setNodes(e=[]){this._nodes&&this._nodes.length&&this.detach();const t=e.filter(i=>i.isAncestorOf(this)?(E.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=e=t,e.length===1&&this.useSingleNodeRotation()?this.rotation(e[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(i=>{const r=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(i._attrsAffectingSize.length){const a=i._attrsAffectingSize.map(o=>o+"Change."+this._getEventNamespace()).join(" ");i.on(a,r)}i.on($g.map(a=>a+`.${this._getEventNamespace()}`).join(" "),r),i.on(`absoluteTransformChange.${this._getEventNamespace()}`,r),this._proxyDrag(i)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(e){let t;e.on(`dragstart.${this._getEventNamespace()}`,s=>{t=e.getAbsolutePosition(),!this.isDragging()&&e!==this.findOne(".back")&&this.startDrag(s,!1)}),e.on(`dragmove.${this._getEventNamespace()}`,s=>{if(!t)return;const i=e.getAbsolutePosition(),r=i.x-t.x,a=i.y-t.y;this.nodes().forEach(o=>{if(o===e||o.isDragging())return;const l=o.getAbsolutePosition();o.setAbsolutePosition({x:l.x+r,y:l.y+a}),o.startDrag(s)}),t=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(e=>{e.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(wd),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(wd,this.__getNodeRect)}__getNodeShape(e,t=this.rotation(),s){const i=e.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),r=e.getAbsoluteScale(s),a=e.getAbsolutePosition(s),o=i.x*r.x-e.offsetX()*r.x,l=i.y*r.y-e.offsetY()*r.y,c=(X.getAngle(e.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),d={x:a.x+o*Math.cos(c)+l*Math.sin(-c),y:a.y+l*Math.cos(c)+o*Math.sin(c),width:i.width*r.x,height:i.height*r.y,rotation:c};return xd(d,-X.getAngle(t),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const t=[];this.nodes().map(c=>{const d=c.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),h=[{x:d.x,y:d.y},{x:d.x+d.width,y:d.y},{x:d.x+d.width,y:d.y+d.height},{x:d.x,y:d.y+d.height}],u=c.getAbsoluteTransform();h.forEach(function(f){const p=u.point(f);t.push(p)})});const s=new ct;s.rotate(-X.getAngle(this.rotation()));let i=1/0,r=1/0,a=-1/0,o=-1/0;t.forEach(function(c){const d=s.point(c);i===void 0&&(i=a=d.x,r=o=d.y),i=Math.min(i,d.x),r=Math.min(r,d.y),a=Math.max(a,d.x),o=Math.max(o,d.y)}),s.invert();const l=s.point({x:i,y:r});return{x:l.x,y:l.y,width:a-i,height:o-r,rotation:X.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),ar.forEach(e=>{this._createAnchor(e)}),this._createAnchor("rotater")}_createAnchor(e){const t=new ni({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:e+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:Ug?10:"auto"}),s=this;t.on("mousedown touchstart",function(i){s._handleMouseDown(i)}),t.on("dragstart",i=>{t.stopDrag(),i.cancelBubble=!0}),t.on("dragend",i=>{i.cancelBubble=!0}),t.on("mouseenter",()=>{const i=X.getAngle(this.rotation()),r=this.rotateAnchorCursor(),a=Vg(e,i,r);t.getStage().content&&(t.getStage().content.style.cursor=a),this._cursorChange=!0}),t.on("mouseout",()=>{t.getStage().content&&(t.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(t)}_createBack(){const e=new B({name:"back",width:0,height:0,sceneFunc(t,s){const i=s.getParent(),r=i.padding();t.beginPath(),t.rect(-r,-r,s.width()+r*2,s.height()+r*2),t.moveTo(s.width()/2,-r),i.rotateEnabled()&&i.rotateLineVisible()&&t.lineTo(s.width()/2,-i.rotateAnchorOffset()*E._sign(s.height())-r),t.fillStrokeShape(s)},hitFunc:(t,s)=>{if(!this.shouldOverdrawWholeArea())return;const i=this.padding();t.beginPath(),t.rect(-i,-i,s.width()+i*2,s.height()+i*2),t.fillStrokeShape(s)}});this.add(e),this._proxyDrag(e),e.on("dragstart",t=>{t.cancelBubble=!0}),e.on("dragmove",t=>{t.cancelBubble=!0}),e.on("dragend",t=>{t.cancelBubble=!0}),this.on("dragmove",t=>{this.update()})}_handleMouseDown(e){if(this._transforming)return;this._movingAnchorName=e.target.name().split(" ")[0];const t=this._getNodeRect(),s=t.width,i=t.height,r=Math.sqrt(Math.pow(s,2)+Math.pow(i,2));this.sin=Math.abs(i/r),this.cos=Math.abs(s/r),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const a=e.target.getAbsolutePosition(),o=e.target.getStage().getPointerPosition();this._anchorDragOffset={x:o.x-a.x,y:o.y-a.y},Ha++,this._fire("transformstart",{evt:e.evt,target:this.getNode()}),this._nodes.forEach(l=>{l._fire("transformstart",{evt:e.evt,target:l})})}_handleMouseMove(e){let t,s,i;const r=this.findOne("."+this._movingAnchorName),a=r.getStage();a.setPointersPositions(e);const o=a.getPointerPosition();let l={x:o.x-this._anchorDragOffset.x,y:o.y-this._anchorDragOffset.y};const c=r.getAbsolutePosition();this.anchorDragBoundFunc()&&(l=this.anchorDragBoundFunc()(c,l,e)),r.setAbsolutePosition(l);const d=r.getAbsolutePosition();if(c.x===d.x&&c.y===d.y)return;if(this._movingAnchorName==="rotater"){const k=this._getNodeRect();t=r.x()-k.width/2,s=-r.y()+k.height/2;let b=Math.atan2(-s,t)+Math.PI/2;k.height<0&&(b-=Math.PI);const C=X.getAngle(this.rotation())+b,A=X.getAngle(this.rotationSnapTolerance()),O=Yg(this.rotationSnaps(),C,A)-k.rotation,I=zg(k,O);this._fitNodesInto(I,e);return}const h=this.shiftBehavior();let u;h==="inverted"?u=this.keepRatio()&&!e.shiftKey:h==="none"?u=this.keepRatio():u=this.keepRatio()||e.shiftKey;let f=this.centeredScaling()||e.altKey;if(this._movingAnchorName==="top-left"){if(u){const k=f?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};i=Math.sqrt(Math.pow(k.x-r.x(),2)+Math.pow(k.y-r.y(),2));const b=this.findOne(".top-left").x()>k.x?-1:1,_=this.findOne(".top-left").y()>k.y?-1:1;t=i*this.cos*b,s=i*this.sin*_,this.findOne(".top-left").x(k.x-t),this.findOne(".top-left").y(k.y-s)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(r.y());else if(this._movingAnchorName==="top-right"){if(u){const k=f?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};i=Math.sqrt(Math.pow(r.x()-k.x,2)+Math.pow(k.y-r.y(),2));const b=this.findOne(".top-right").x()<k.x?-1:1,_=this.findOne(".top-right").y()>k.y?-1:1;t=i*this.cos*b,s=i*this.sin*_,this.findOne(".top-right").x(k.x+t),this.findOne(".top-right").y(k.y-s)}var p=r.position();this.findOne(".top-left").y(p.y),this.findOne(".bottom-right").x(p.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(r.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(r.x());else if(this._movingAnchorName==="bottom-left"){if(u){const k=f?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};i=Math.sqrt(Math.pow(k.x-r.x(),2)+Math.pow(r.y()-k.y,2));const b=k.x<r.x()?-1:1,_=r.y()<k.y?-1:1;t=i*this.cos*b,s=i*this.sin*_,r.x(k.x-t),r.y(k.y+s)}p=r.position(),this.findOne(".top-left").x(p.x),this.findOne(".bottom-right").y(p.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(r.y());else if(this._movingAnchorName==="bottom-right"){if(u){const k=f?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};i=Math.sqrt(Math.pow(r.x()-k.x,2)+Math.pow(r.y()-k.y,2));const b=this.findOne(".bottom-right").x()<k.x?-1:1,_=this.findOne(".bottom-right").y()<k.y?-1:1;t=i*this.cos*b,s=i*this.sin*_,this.findOne(".bottom-right").x(k.x+t),this.findOne(".bottom-right").y(k.y+s)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(f=this.centeredScaling()||e.altKey,f){const k=this.findOne(".top-left"),b=this.findOne(".bottom-right"),_=k.x(),C=k.y(),A=this.getWidth()-b.x(),L=this.getHeight()-b.y();b.move({x:-_,y:-C}),k.move({x:A,y:L})}const m=this.findOne(".top-left").getAbsolutePosition();t=m.x,s=m.y;const v=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),S=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:t,y:s,width:v,height:S,rotation:X.getAngle(this.rotation())},e)}_handleMouseUp(e){this._removeEvents(e)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(e){var t;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const s=this.getNode();Ha--,this._fire("transformend",{evt:e,target:s}),(t=this.getLayer())===null||t===void 0||t.batchDraw(),s&&this._nodes.forEach(i=>{var r;i._fire("transformend",{evt:e,target:i}),(r=i.getLayer())===null||r===void 0||r.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(e,t){const s=this._getNodeRect(),i=1;if(E._inRange(e.width,-this.padding()*2-i,i)){this.update();return}if(E._inRange(e.height,-this.padding()*2-i,i)){this.update();return}const r=new ct;if(r.rotate(X.getAngle(this.rotation())),this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("left")>=0){const u=r.point({x:-this.padding()*2,y:0});e.x+=u.x,e.y+=u.y,e.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=u.x,this._anchorDragOffset.y-=u.y}else if(this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("right")>=0){const u=r.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=u.x,this._anchorDragOffset.y-=u.y,e.width+=this.padding()*2}if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("top")>=0){const u=r.point({x:0,y:-this.padding()*2});e.x+=u.x,e.y+=u.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=u.x,this._anchorDragOffset.y-=u.y,e.height+=this.padding()*2}else if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const u=r.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=u.x,this._anchorDragOffset.y-=u.y,e.height+=this.padding()*2}if(this.boundBoxFunc()){const u=this.boundBoxFunc()(s,e);u?e=u:E.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const a=1e7,o=new ct;o.translate(s.x,s.y),o.rotate(s.rotation),o.scale(s.width/a,s.height/a);const l=new ct,c=e.width/a,d=e.height/a;this.flipEnabled()===!1?(l.translate(e.x,e.y),l.rotate(e.rotation),l.translate(e.width<0?e.width:0,e.height<0?e.height:0),l.scale(Math.abs(c),Math.abs(d))):(l.translate(e.x,e.y),l.rotate(e.rotation),l.scale(c,d));const h=l.multiply(o.invert());this._nodes.forEach(u=>{var f;if(!u.getStage())return;const p=u.getParent().getAbsoluteTransform(),m=u.getTransform().copy();m.translate(u.offsetX(),u.offsetY());const v=new ct;v.multiply(p.copy().invert()).multiply(h).multiply(p).multiply(m);const S=v.decompose();u.setAttrs(S),(f=u.getLayer())===null||f===void 0||f.batchDraw()}),this.rotation(E._getRotation(e.rotation)),this._nodes.forEach(u=>{this._fire("transform",{evt:t,target:u}),u._fire("transform",{evt:t,target:u})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(e,t){this.findOne(e).setAttrs(t)}update(){var e;const t=this._getNodeRect();this.rotation(E._getRotation(t.rotation));const s=t.width,i=t.height,r=this.enabledAnchors(),a=this.resizeEnabled(),o=this.padding(),l=this.anchorSize(),c=this.find("._anchor");c.forEach(h=>{h.setAttrs({width:l,height:l,offsetX:l/2,offsetY:l/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:l/2+o,offsetY:l/2+o,visible:a&&r.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:s/2,y:0,offsetY:l/2+o,visible:a&&r.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:s,y:0,offsetX:l/2-o,offsetY:l/2+o,visible:a&&r.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:i/2,offsetX:l/2+o,visible:a&&r.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:s,y:i/2,offsetX:l/2-o,visible:a&&r.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:i,offsetX:l/2+o,offsetY:l/2-o,visible:a&&r.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:s/2,y:i,offsetY:l/2-o,visible:a&&r.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:s,y:i,offsetX:l/2-o,offsetY:l/2-o,visible:a&&r.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:s/2,y:-this.rotateAnchorOffset()*E._sign(i)-o,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:s,height:i,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),draggable:this.nodes().some(h=>h.draggable()),x:0,y:0});const d=this.anchorStyleFunc();d&&c.forEach(h=>{d(h)}),(e=this.getLayer())===null||e===void 0||e.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const e=this.findOne("."+this._movingAnchorName);e&&e.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),ps.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return z.prototype.toObject.call(this)}clone(e){return z.prototype.clone.call(this,e)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}ye.isTransforming=()=>Ha>0;function Xg(n){return n instanceof Array||E.warn("enabledAnchors value should be an array"),n instanceof Array&&n.forEach(function(e){ar.indexOf(e)===-1&&E.warn("Unknown anchor name: "+e+". Available names are: "+ar.join(", "))}),n||[]}ye.prototype.className="Transformer",Be(ye),y.addGetterSetter(ye,"enabledAnchors",ar,Xg),y.addGetterSetter(ye,"flipEnabled",!0,Et()),y.addGetterSetter(ye,"resizeEnabled",!0),y.addGetterSetter(ye,"anchorSize",10,Y()),y.addGetterSetter(ye,"rotateEnabled",!0),y.addGetterSetter(ye,"rotateLineVisible",!0),y.addGetterSetter(ye,"rotationSnaps",[]),y.addGetterSetter(ye,"rotateAnchorOffset",50,Y()),y.addGetterSetter(ye,"rotateAnchorCursor","crosshair"),y.addGetterSetter(ye,"rotationSnapTolerance",5,Y()),y.addGetterSetter(ye,"borderEnabled",!0),y.addGetterSetter(ye,"anchorStroke","rgb(0, 161, 255)"),y.addGetterSetter(ye,"anchorStrokeWidth",1,Y()),y.addGetterSetter(ye,"anchorFill","white"),y.addGetterSetter(ye,"anchorCornerRadius",0,Y()),y.addGetterSetter(ye,"borderStroke","rgb(0, 161, 255)"),y.addGetterSetter(ye,"borderStrokeWidth",1,Y()),y.addGetterSetter(ye,"borderDash"),y.addGetterSetter(ye,"keepRatio",!0),y.addGetterSetter(ye,"shiftBehavior","default"),y.addGetterSetter(ye,"centeredScaling",!1),y.addGetterSetter(ye,"ignoreStroke",!1),y.addGetterSetter(ye,"padding",0,Y()),y.addGetterSetter(ye,"nodes"),y.addGetterSetter(ye,"node"),y.addGetterSetter(ye,"boundBoxFunc"),y.addGetterSetter(ye,"anchorDragBoundFunc"),y.addGetterSetter(ye,"anchorStyleFunc"),y.addGetterSetter(ye,"shouldOverdrawWholeArea",!1),y.addGetterSetter(ye,"useSingleNodeRotation",!0),y.backCompat(ye,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});class en extends B{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.radius(),0,X.getAngle(this.angle()),this.clockwise()),e.lineTo(0,0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}en.prototype.className="Wedge",en.prototype._centroid=!0,en.prototype._attrsAffectingSize=["radius"],Be(en),y.addGetterSetter(en,"radius",0,Y()),y.addGetterSetter(en,"angle",0,Y()),y.addGetterSetter(en,"clockwise",!1),y.backCompat(en,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});function Sd(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const Kg=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],Zg=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function qg(n,e){const t=n.data,s=n.width,i=n.height;let r,a,o,l,c,d,h,u,f,p,m,v,S,k,b,_,C,A,L,O;const I=e+e+1,W=s-1,K=i-1,g=e+1,w=g*(g+1)/2,R=new Sd,P=Kg[e],M=Zg[e];let D=null,G=R,J=null,ae=null;for(let ne=1;ne<I;ne++)G=G.next=new Sd,ne===g&&(D=G);G.next=R,o=a=0;for(let ne=0;ne<i;ne++){v=S=k=b=l=c=d=h=0,u=g*(_=t[a]),f=g*(C=t[a+1]),p=g*(A=t[a+2]),m=g*(L=t[a+3]),l+=w*_,c+=w*C,d+=w*A,h+=w*L,G=R;for(let ie=0;ie<g;ie++)G.r=_,G.g=C,G.b=A,G.a=L,G=G.next;for(let ie=1;ie<g;ie++)r=a+((W<ie?W:ie)<<2),l+=(G.r=_=t[r])*(O=g-ie),c+=(G.g=C=t[r+1])*O,d+=(G.b=A=t[r+2])*O,h+=(G.a=L=t[r+3])*O,v+=_,S+=C,k+=A,b+=L,G=G.next;J=R,ae=D;for(let ie=0;ie<s;ie++)t[a+3]=L=h*P>>M,L!==0?(L=255/L,t[a]=(l*P>>M)*L,t[a+1]=(c*P>>M)*L,t[a+2]=(d*P>>M)*L):t[a]=t[a+1]=t[a+2]=0,l-=u,c-=f,d-=p,h-=m,u-=J.r,f-=J.g,p-=J.b,m-=J.a,r=o+((r=ie+e+1)<W?r:W)<<2,v+=J.r=t[r],S+=J.g=t[r+1],k+=J.b=t[r+2],b+=J.a=t[r+3],l+=v,c+=S,d+=k,h+=b,J=J.next,u+=_=ae.r,f+=C=ae.g,p+=A=ae.b,m+=L=ae.a,v-=_,S-=C,k-=A,b-=L,ae=ae.next,a+=4;o+=s}for(let ne=0;ne<s;ne++){S=k=b=v=c=d=h=l=0,a=ne<<2,u=g*(_=t[a]),f=g*(C=t[a+1]),p=g*(A=t[a+2]),m=g*(L=t[a+3]),l+=w*_,c+=w*C,d+=w*A,h+=w*L,G=R;for(let Re=0;Re<g;Re++)G.r=_,G.g=C,G.b=A,G.a=L,G=G.next;let ie=s;for(let Re=1;Re<=e;Re++)a=ie+ne<<2,l+=(G.r=_=t[a])*(O=g-Re),c+=(G.g=C=t[a+1])*O,d+=(G.b=A=t[a+2])*O,h+=(G.a=L=t[a+3])*O,v+=_,S+=C,k+=A,b+=L,G=G.next,Re<K&&(ie+=s);a=ne,J=R,ae=D;for(let Re=0;Re<i;Re++)r=a<<2,t[r+3]=L=h*P>>M,L>0?(L=255/L,t[r]=(l*P>>M)*L,t[r+1]=(c*P>>M)*L,t[r+2]=(d*P>>M)*L):t[r]=t[r+1]=t[r+2]=0,l-=u,c-=f,d-=p,h-=m,u-=J.r,f-=J.g,p-=J.b,m-=J.a,r=ne+((r=Re+g)<K?r:K)*s<<2,l+=v+=J.r=t[r],c+=S+=J.g=t[r+1],d+=k+=J.b=t[r+2],h+=b+=J.a=t[r+3],J=J.next,u+=_=ae.r,f+=C=ae.g,p+=A=ae.b,m+=L=ae.a,v-=_,S-=C,k-=A,b-=L,ae=ae.next,a+=s}}const Jg=function(e){const t=Math.round(this.blurRadius());t>0&&qg(e,t)};y.addGetterSetter(z,"blurRadius",0,Y(),y.afterSetFilter);const Qg=function(n){const e=this.brightness()*255,t=n.data,s=t.length;for(let i=0;i<s;i+=4)t[i]+=e,t[i+1]+=e,t[i+2]+=e};y.addGetterSetter(z,"brightness",0,Y(),y.afterSetFilter);const e1=function(n){const e=this.brightness(),t=n.data,s=t.length;for(let i=0;i<s;i+=4)t[i]=Math.min(255,t[i]*e),t[i+1]=Math.min(255,t[i+1]*e),t[i+2]=Math.min(255,t[i+2]*e)},t1=function(n){const e=Math.pow((this.contrast()+100)/100,2),t=n.data,s=t.length;let i=150,r=150,a=150;for(let o=0;o<s;o+=4)i=t[o],r=t[o+1],a=t[o+2],i/=255,i-=.5,i*=e,i+=.5,i*=255,r/=255,r-=.5,r*=e,r+=.5,r*=255,a/=255,a-=.5,a*=e,a+=.5,a*=255,i=i<0?0:i>255?255:i,r=r<0?0:r>255?255:r,a=a<0?0:a>255?255:a,t[o]=i,t[o+1]=r,t[o+2]=a};y.addGetterSetter(z,"contrast",0,Y(),y.afterSetFilter);const n1=function(n){var e,t,s,i,r,a,o,l,c;const d=n.data,h=n.width,u=n.height,f=Math.min(1,Math.max(0,(t=(e=this.embossStrength)===null||e===void 0?void 0:e.call(this))!==null&&t!==void 0?t:.5)),p=Math.min(1,Math.max(0,(i=(s=this.embossWhiteLevel)===null||s===void 0?void 0:s.call(this))!==null&&i!==void 0?i:.5)),v=(o={"top-left":315,top:270,"top-right":225,right:180,"bottom-right":135,bottom:90,"bottom-left":45,left:0}[(a=(r=this.embossDirection)===null||r===void 0?void 0:r.call(this))!==null&&a!==void 0?a:"top-left"])!==null&&o!==void 0?o:315,S=!!((c=(l=this.embossBlend)===null||l===void 0?void 0:l.call(this))!==null&&c!==void 0&&c),k=f*10,b=p*255,_=v*Math.PI/180,C=Math.cos(_),A=Math.sin(_),L=128/1020*k,O=new Uint8ClampedArray(d),I=new Float32Array(h*u);for(let R=0,P=0;P<d.length;P+=4,R++)I[R]=.2126*O[P]+.7152*O[P+1]+.0722*O[P+2];const W=[-1,0,1,-2,0,2,-1,0,1],K=[-1,-2,-1,0,0,0,1,2,1],g=[-h-1,-h,-h+1,-1,0,1,h-1,h,h+1],w=R=>R<0?0:R>255?255:R;for(let R=1;R<u-1;R++)for(let P=1;P<h-1;P++){const M=R*h+P;let D=0,G=0;D+=I[M+g[0]]*W[0],G+=I[M+g[0]]*K[0],D+=I[M+g[1]]*W[1],G+=I[M+g[1]]*K[1],D+=I[M+g[2]]*W[2],G+=I[M+g[2]]*K[2],D+=I[M+g[3]]*W[3],G+=I[M+g[3]]*K[3],D+=I[M+g[5]]*W[5],G+=I[M+g[5]]*K[5],D+=I[M+g[6]]*W[6],G+=I[M+g[6]]*K[6],D+=I[M+g[7]]*W[7],G+=I[M+g[7]]*K[7],D+=I[M+g[8]]*W[8],G+=I[M+g[8]]*K[8];const J=C*D+A*G,ae=w(b+J*L),ne=M*4;if(S){const ie=ae-b;d[ne]=w(O[ne]+ie),d[ne+1]=w(O[ne+1]+ie),d[ne+2]=w(O[ne+2]+ie),d[ne+3]=O[ne+3]}else d[ne]=d[ne+1]=d[ne+2]=ae,d[ne+3]=O[ne+3]}for(let R=0;R<h;R++){let P=R*4,M=((u-1)*h+R)*4;d[P]=O[P],d[P+1]=O[P+1],d[P+2]=O[P+2],d[P+3]=O[P+3],d[M]=O[M],d[M+1]=O[M+1],d[M+2]=O[M+2],d[M+3]=O[M+3]}for(let R=1;R<u-1;R++){let P=R*h*4,M=(R*h+(h-1))*4;d[P]=O[P],d[P+1]=O[P+1],d[P+2]=O[P+2],d[P+3]=O[P+3],d[M]=O[M],d[M+1]=O[M+1],d[M+2]=O[M+2],d[M+3]=O[M+3]}return n};y.addGetterSetter(z,"embossStrength",.5,Y(),y.afterSetFilter),y.addGetterSetter(z,"embossWhiteLevel",.5,Y(),y.afterSetFilter),y.addGetterSetter(z,"embossDirection","top-left",void 0,y.afterSetFilter),y.addGetterSetter(z,"embossBlend",!1,void 0,y.afterSetFilter);function $a(n,e,t,s,i){const r=t-e,a=i-s;if(r===0)return s+a/2;if(a===0)return s;let o=(n-e)/r;return o=a*o+s,o}const s1=function(n){const e=n.data,t=e.length;let s=e[0],i=s,r,a=e[1],o=a,l,c=e[2],d=c,h;const u=this.enhance();if(u===0)return;for(let b=0;b<t;b+=4)r=e[b+0],r<s?s=r:r>i&&(i=r),l=e[b+1],l<a?a=l:l>o&&(o=l),h=e[b+2],h<c?c=h:h>d&&(d=h);i===s&&(i=255,s=0),o===a&&(o=255,a=0),d===c&&(d=255,c=0);let f,p,m,v,S,k;if(u>0)f=i+u*(255-i),p=s-u*(s-0),m=o+u*(255-o),v=a-u*(a-0),S=d+u*(255-d),k=c-u*(c-0);else{const b=(i+s)*.5;f=i+u*(i-b),p=s+u*(s-b);const _=(o+a)*.5;m=o+u*(o-_),v=a+u*(a-_);const C=(d+c)*.5;S=d+u*(d-C),k=c+u*(c-C)}for(let b=0;b<t;b+=4)e[b+0]=$a(e[b+0],s,i,p,f),e[b+1]=$a(e[b+1],a,o,v,m),e[b+2]=$a(e[b+2],c,d,k,S)};y.addGetterSetter(z,"enhance",0,Y(),y.afterSetFilter);const i1=function(n){const e=n.data,t=e.length;for(let s=0;s<t;s+=4){const i=.34*e[s]+.5*e[s+1]+.16*e[s+2];e[s]=i,e[s+1]=i,e[s+2]=i}};y.addGetterSetter(z,"hue",0,Y(),y.afterSetFilter),y.addGetterSetter(z,"saturation",0,Y(),y.afterSetFilter),y.addGetterSetter(z,"luminance",0,Y(),y.afterSetFilter);const r1=function(n){const e=n.data,t=e.length,s=1,i=Math.pow(2,this.saturation()),r=Math.abs(this.hue()+360)%360,a=this.luminance()*127,o=s*i*Math.cos(r*Math.PI/180),l=s*i*Math.sin(r*Math.PI/180),c=.299*s+.701*o+.167*l,d=.587*s-.587*o+.33*l,h=.114*s-.114*o-.497*l,u=.299*s-.299*o-.328*l,f=.587*s+.413*o+.035*l,p=.114*s-.114*o+.293*l,m=.299*s-.3*o+1.25*l,v=.587*s-.586*o-1.05*l,S=.114*s+.886*o-.2*l;let k,b,_,C;for(let A=0;A<t;A+=4)k=e[A+0],b=e[A+1],_=e[A+2],C=e[A+3],e[A+0]=c*k+d*b+h*_+a,e[A+1]=u*k+f*b+p*_+a,e[A+2]=m*k+v*b+S*_+a,e[A+3]=C},a1=function(n){const e=n.data,t=e.length,s=Math.pow(2,this.value()),i=Math.pow(2,this.saturation()),r=Math.abs(this.hue()+360)%360,a=s*i*Math.cos(r*Math.PI/180),o=s*i*Math.sin(r*Math.PI/180),l=.299*s+.701*a+.167*o,c=.587*s-.587*a+.33*o,d=.114*s-.114*a-.497*o,h=.299*s-.299*a-.328*o,u=.587*s+.413*a+.035*o,f=.114*s-.114*a+.293*o,p=.299*s-.3*a+1.25*o,m=.587*s-.586*a-1.05*o,v=.114*s+.886*a-.2*o;for(let S=0;S<t;S+=4){const k=e[S+0],b=e[S+1],_=e[S+2],C=e[S+3];e[S+0]=l*k+c*b+d*_,e[S+1]=h*k+u*b+f*_,e[S+2]=p*k+m*b+v*_,e[S+3]=C}};y.addGetterSetter(z,"hue",0,Y(),y.afterSetFilter),y.addGetterSetter(z,"saturation",0,Y(),y.afterSetFilter),y.addGetterSetter(z,"value",0,Y(),y.afterSetFilter);const o1=function(n){const e=n.data,t=e.length;for(let s=0;s<t;s+=4)e[s]=255-e[s],e[s+1]=255-e[s+1],e[s+2]=255-e[s+2]},l1=function(n,e,t){const s=n.data,i=e.data,r=n.width,a=n.height,o=t.polarCenterX||r/2,l=t.polarCenterY||a/2;let c=Math.sqrt(o*o+l*l),d=r-o,h=a-l;const u=Math.sqrt(d*d+h*h);c=u>c?u:c;const f=a,p=r,m=360/p*Math.PI/180;for(let v=0;v<p;v+=1){const S=Math.sin(v*m),k=Math.cos(v*m);for(let b=0;b<f;b+=1){d=Math.floor(o+c*b/f*k),h=Math.floor(l+c*b/f*S);let _=(h*r+d)*4;const C=s[_+0],A=s[_+1],L=s[_+2],O=s[_+3];_=(v+b*r)*4,i[_+0]=C,i[_+1]=A,i[_+2]=L,i[_+3]=O}}},c1=function(n,e,t){const s=n.data,i=e.data,r=n.width,a=n.height,o=t.polarCenterX||r/2,l=t.polarCenterY||a/2;let c=Math.sqrt(o*o+l*l),d=r-o,h=a-l;const u=Math.sqrt(d*d+h*h);c=u>c?u:c;const f=a,p=r,m=0;let v,S;for(d=0;d<r;d+=1)for(h=0;h<a;h+=1){const k=d-o,b=h-l,_=Math.sqrt(k*k+b*b)*f/c;let C=(Math.atan2(b,k)*180/Math.PI+360+m)%360;C=C*p/360,v=Math.floor(C),S=Math.floor(_);let A=(S*r+v)*4;const L=s[A+0],O=s[A+1],I=s[A+2],W=s[A+3];A=(h*r+d)*4,i[A+0]=L,i[A+1]=O,i[A+2]=I,i[A+3]=W}},d1=function(n){const e=n.width,t=n.height;let s,i,r,a,o,l,c,d,h,u,f=Math.round(this.kaleidoscopePower());const p=Math.round(this.kaleidoscopeAngle()),m=Math.floor(e*(p%360)/360);if(f<1)return;const v=E.createCanvasElement();v.width=e,v.height=t;const S=v.getContext("2d").getImageData(0,0,e,t);E.releaseCanvas(v),l1(n,S,{polarCenterX:e/2,polarCenterY:t/2});let k=e/Math.pow(2,f);for(;k<=8;)k=k*2,f-=1;k=Math.ceil(k);let b=k,_=0,C=b,A=1;for(m+k>e&&(_=b,C=0,A=-1),i=0;i<t;i+=1)for(s=_;s!==C;s+=A)r=Math.round(s+m)%e,h=(e*i+r)*4,o=S.data[h+0],l=S.data[h+1],c=S.data[h+2],d=S.data[h+3],u=(e*i+s)*4,S.data[u+0]=o,S.data[u+1]=l,S.data[u+2]=c,S.data[u+3]=d;for(i=0;i<t;i+=1)for(b=Math.floor(k),a=0;a<f;a+=1){for(s=0;s<b+1;s+=1)h=(e*i+s)*4,o=S.data[h+0],l=S.data[h+1],c=S.data[h+2],d=S.data[h+3],u=(e*i+b*2-s-1)*4,S.data[u+0]=o,S.data[u+1]=l,S.data[u+2]=c,S.data[u+3]=d;b*=2}c1(S,n,{})};y.addGetterSetter(z,"kaleidoscopePower",2,Y(),y.afterSetFilter),y.addGetterSetter(z,"kaleidoscopeAngle",0,Y(),y.afterSetFilter);function or(n,e,t){let s=(t*n.width+e)*4;const i=[];return i.push(n.data[s++],n.data[s++],n.data[s++],n.data[s++]),i}function ii(n,e){return Math.sqrt(Math.pow(n[0]-e[0],2)+Math.pow(n[1]-e[1],2)+Math.pow(n[2]-e[2],2))}function h1(n){const e=[0,0,0];for(let t=0;t<n.length;t++)e[0]+=n[t][0],e[1]+=n[t][1],e[2]+=n[t][2];return e[0]/=n.length,e[1]/=n.length,e[2]/=n.length,e}function u1(n,e){const t=or(n,0,0),s=or(n,n.width-1,0),i=or(n,0,n.height-1),r=or(n,n.width-1,n.height-1),a=e||10;if(ii(t,s)<a&&ii(s,r)<a&&ii(r,i)<a&&ii(i,t)<a){const o=h1([s,t,r,i]),l=[];for(let c=0;c<n.width*n.height;c++){const d=ii(o,[n.data[c*4],n.data[c*4+1],n.data[c*4+2]]);l[c]=d<a?0:255}return l}}function f1(n,e){for(let t=0;t<n.width*n.height;t++)n.data[4*t+3]=e[t]}function p1(n,e,t){const s=[1,1,1,1,0,1,1,1,1],i=Math.round(Math.sqrt(s.length)),r=Math.floor(i/2),a=[];for(let o=0;o<t;o++)for(let l=0;l<e;l++){const c=o*e+l;let d=0;for(let h=0;h<i;h++)for(let u=0;u<i;u++){const f=o+h-r,p=l+u-r;if(f>=0&&f<t&&p>=0&&p<e){const m=f*e+p,v=s[h*i+u];d+=n[m]*v}}a[c]=d===2040?255:0}return a}function g1(n,e,t){const s=[1,1,1,1,1,1,1,1,1],i=Math.round(Math.sqrt(s.length)),r=Math.floor(i/2),a=[];for(let o=0;o<t;o++)for(let l=0;l<e;l++){const c=o*e+l;let d=0;for(let h=0;h<i;h++)for(let u=0;u<i;u++){const f=o+h-r,p=l+u-r;if(f>=0&&f<t&&p>=0&&p<e){const m=f*e+p,v=s[h*i+u];d+=n[m]*v}}a[c]=d>=1020?255:0}return a}function m1(n,e,t){const s=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],i=Math.round(Math.sqrt(s.length)),r=Math.floor(i/2),a=[];for(let o=0;o<t;o++)for(let l=0;l<e;l++){const c=o*e+l;let d=0;for(let h=0;h<i;h++)for(let u=0;u<i;u++){const f=o+h-r,p=l+u-r;if(f>=0&&f<t&&p>=0&&p<e){const m=f*e+p,v=s[h*i+u];d+=n[m]*v}}a[c]=d}return a}const _1=function(n){const e=this.threshold();let t=u1(n,e);return t&&(t=p1(t,n.width,n.height),t=g1(t,n.width,n.height),t=m1(t,n.width,n.height),f1(n,t)),n};y.addGetterSetter(z,"threshold",0,Y(),y.afterSetFilter);const v1=function(n){const e=this.noise()*255,t=n.data,s=t.length,i=e/2;for(let r=0;r<s;r+=4)t[r+0]+=i-2*i*Math.random(),t[r+1]+=i-2*i*Math.random(),t[r+2]+=i-2*i*Math.random()};y.addGetterSetter(z,"noise",.2,Y(),y.afterSetFilter);const y1=function(n){let e=Math.ceil(this.pixelSize()),t=n.width,s=n.height,i=Math.ceil(t/e),r=Math.ceil(s/e),a=n.data;if(e<=0){E.error("pixelSize value can not be <= 0");return}for(let o=0;o<i;o+=1)for(let l=0;l<r;l+=1){let c=0,d=0,h=0,u=0;const f=o*e,p=f+e,m=l*e,v=m+e;let S=0;for(let k=f;k<p;k+=1)if(!(k>=t))for(let b=m;b<v;b+=1){if(b>=s)continue;const _=(t*b+k)*4;c+=a[_+0],d+=a[_+1],h+=a[_+2],u+=a[_+3],S+=1}c=c/S,d=d/S,h=h/S,u=u/S;for(let k=f;k<p;k+=1)if(!(k>=t))for(let b=m;b<v;b+=1){if(b>=s)continue;const _=(t*b+k)*4;a[_+0]=c,a[_+1]=d,a[_+2]=h,a[_+3]=u}}};y.addGetterSetter(z,"pixelSize",8,Y(),y.afterSetFilter);const b1=function(n){const e=Math.round(this.levels()*254)+1,t=n.data,s=t.length,i=255/e;for(let r=0;r<s;r+=1)t[r]=Math.floor(t[r]/i)*i};y.addGetterSetter(z,"levels",.5,Y(),y.afterSetFilter);const w1=function(n){const e=n.data,t=e.length,s=this.red(),i=this.green(),r=this.blue();for(let a=0;a<t;a+=4){const o=(.34*e[a]+.5*e[a+1]+.16*e[a+2])/255;e[a]=o*s,e[a+1]=o*i,e[a+2]=o*r,e[a+3]=e[a+3]}};y.addGetterSetter(z,"red",0,function(n){return this._filterUpToDate=!1,n>255?255:n<0?0:Math.round(n)}),y.addGetterSetter(z,"green",0,function(n){return this._filterUpToDate=!1,n>255?255:n<0?0:Math.round(n)}),y.addGetterSetter(z,"blue",0,Tc,y.afterSetFilter);const x1=function(n){const e=n.data,t=e.length,s=this.red(),i=this.green(),r=this.blue(),a=this.alpha();for(let o=0;o<t;o+=4){const l=1-a;e[o]=s*a+e[o]*l,e[o+1]=i*a+e[o+1]*l,e[o+2]=r*a+e[o+2]*l}};y.addGetterSetter(z,"red",0,function(n){return this._filterUpToDate=!1,n>255?255:n<0?0:Math.round(n)}),y.addGetterSetter(z,"green",0,function(n){return this._filterUpToDate=!1,n>255?255:n<0?0:Math.round(n)}),y.addGetterSetter(z,"blue",0,Tc,y.afterSetFilter),y.addGetterSetter(z,"alpha",1,function(n){return this._filterUpToDate=!1,n>1?1:n<0?0:n});const S1=function(n){const e=n.data,t=e.length;for(let s=0;s<t;s+=4){const i=e[s+0],r=e[s+1],a=e[s+2];e[s+0]=Math.min(255,i*.393+r*.769+a*.189),e[s+1]=Math.min(255,i*.349+r*.686+a*.168),e[s+2]=Math.min(255,i*.272+r*.534+a*.131)}},k1=function(n){const t=n.data;for(let s=0;s<t.length;s+=4){const i=t[s],r=t[s+1],a=t[s+2];.2126*i+.7152*r+.0722*a>=128&&(t[s]=255-i,t[s+1]=255-r,t[s+2]=255-a)}return n},C1=function(n){const e=this.threshold()*255,t=n.data,s=t.length;for(let i=0;i<s;i+=1)t[i]=t[i]<e?0:255};y.addGetterSetter(z,"threshold",.5,Y(),y.afterSetFilter);const Ye=nd.Util._assign(nd,{Arc:Jt,Arrow:zn,Circle:gs,Ellipse:wn,Image:ht,Label:Ga,Tag:Yn,Line:Qt,Path:Oe,Rect:ni,RegularPolygon:xn,Ring:Xn,Sprite:Gt,Star:Sn,Text:De,TextPath:je,Transformer:ye,Wedge:en,Filters:{Blur:Jg,Brightness:e1,Brighten:Qg,Contrast:t1,Emboss:n1,Enhance:s1,Grayscale:i1,HSL:r1,HSV:a1,Invert:o1,Kaleidoscope:d1,Mask:_1,Noise:v1,Pixelate:y1,Posterize:b1,RGB:w1,RGBA:x1,Sepia:S1,Solarize:k1,Threshold:C1}}),T1={class:"number-lane"},E1=lt(st({__name:"NumberLane",props:{tracks:{type:Array},frontTrackId:{type:null},windowStart:{type:Number},windowEnd:{type:Number},selectedElementId:{type:null},selectedTrackId:{type:null},renderVersion:{type:Number}},emits:["action"],setup(n,{expose:e,emit:t}){Dt(g=>({b2ac8aa8:_e(Wi)+"px",v5ac76444:_e(ga)}));const s=n,i=t,r=me(null);let a=null,o=null,l=null;const c=new Map;let d=null,h=null,u=null;const f=me(0),p=Wi,m=Pe(()=>{if(s.frontTrackId)return s.tracks.find(g=>g.id===s.frontTrackId)});function v(g){return _n(g,s.windowStart,s.windowEnd,f.value)}function S(g){return ma(g,s.windowStart,s.windowEnd,f.value)}function k(g,w,R){const M=p-40,D=(g-w)/(R-w);return 20+M*(1-D)}function b(g,w,R){const M=p-40,D=1-(g-20)/M;return w+D*(R-w)}function _(){if(!(!o||!a||(o.destroyChildren(),c.clear(),d=null,f.value<=0))){for(const w of s.tracks)w.id!==s.frontTrackId&&C(w,!1);m.value&&(C(m.value,!0),A(m.value)),o.batchDraw()}}function C(g,w){const R=g.elementData;if(R.length===0)return;const P=[],M=O(g,s.windowStart);P.push(0,k(M,g.low,g.high));for(const J of R)if(!(J.time<s.windowStart)){if(J.time>s.windowEnd)break;P.push(v(J.time),k(J.value,g.low,g.high))}const D=O(g,s.windowEnd);P.push(f.value,k(D,g.low,g.high));const G=new Ye.Line({points:P,stroke:hc,strokeWidth:w?Qf:Jf,opacity:w?fa:pa,lineCap:"round",lineJoin:"round"});if(o.add(G),w&&(d=G),w){const J=k(g.low,g.low,g.high),ae=k(g.high,g.low,g.high),ne=new Ye.Line({points:[0,J,f.value,J],stroke:gc,strokeWidth:1,dash:[4,4]});o.add(ne);const ie=new Ye.Line({points:[0,ae,f.value,ae],stroke:gc,strokeWidth:1,dash:[4,4]});o.add(ie)}}function A(g){const w=g.elementData;for(let R=0;R<w.length;R++){const P=w[R];if(P.time<s.windowStart||P.time>s.windowEnd)continue;const M=v(P.time),D=k(P.value,g.low,g.high),G=P.id===s.selectedElementId&&g.id===s.selectedTrackId,J=new Ye.Circle({x:M,y:D,radius:qf,fill:uc,stroke:G?ha:void 0,strokeWidth:G?ua:0,draggable:!0});J.setAttr("elementId",P.id),J.setAttr("elementIndex",R),J.on("click",ae=>{ae.evt.shiftKey?i("action",{type:"NUMBER/DELETE",trackId:g.id,elementId:P.id}):i("action",{type:"ELEMENT/SELECT",fieldType:"number",trackId:g.id,elementId:P.id})}),J.on("dragstart",()=>{h=R,u=g,i("action",{type:"ELEMENT/SELECT",fieldType:"number",trackId:g.id,elementId:P.id}),i("action",{type:"NUMBER/DRAG_START",trackId:g.id,elementId:P.id})}),J.on("dragmove",()=>{if(h===null||!u)return;const ae=J.position();let ne=S(ae.x),ie=b(ae.y,u.low,u.high);ne=Ve(ne,s.windowStart,s.windowEnd);const Re=u.elementData,Qn=h>0?Re[h-1].time:0,In=h<Re.length-1?Re[h+1].time:1/0;ne=Ve(ne,Qn,In),ie=Ve(ie,u.low,u.high);const Bt=v(ne),an=k(ie,u.low,u.high);J.position({x:Bt,y:an}),L(u,h,Bt,an),i("action",{type:"NUMBER/DRAG_PREVIEW",trackId:u.id,elementId:P.id,time:ne,value:ie})}),J.on("dragend",()=>{if(h===null||!u)return;const ae=J.position();let ne=S(ae.x),ie=b(ae.y,u.low,u.high);ne=Ve(ne,s.windowStart,s.windowEnd);const Re=u.elementData,Qn=h>0?Re[h-1].time:0,In=h<Re.length-1?Re[h+1].time:1/0;ne=Ve(ne,Qn,In),ie=Ve(ie,u.low,u.high),i("action",{type:"NUMBER/DRAG_END",trackId:u.id,elementId:P.id,time:ne,value:ie}),h=null,u=null}),o.add(J),c.set(P.id,J)}}function L(g,w,R,P){if(!d||!o)return;const M=g.elementData,D=[],G=I(g,s.windowStart,w,R,P);D.push(0,k(G,g.low,g.high));for(let ae=0;ae<M.length;ae++){const ne=M[ae];if(ae===w){const ie=S(R);ie>=s.windowStart&&ie<=s.windowEnd&&D.push(R,P)}else{if(ne.time<s.windowStart)continue;if(ne.time>s.windowEnd)break;D.push(v(ne.time),k(ne.value,g.low,g.high))}}const J=I(g,s.windowEnd,w,R,P);D.push(f.value,k(J,g.low,g.high)),d.points(D),o.batchDraw()}function O(g,w){const R=g.elementData;if(R.length===0)return g.low;let P=-1,M=0;for(let ie=0;ie<R.length;ie++){if(R[ie].time<=w)P=ie;else{M=ie;break}M=ie+1}if(P<0)return R[0].value;if(M>=R.length)return R[P].value;const D=R[P].time,G=R[M].time,J=R[P].value,ae=R[M].value,ne=(w-D)/(G-D);return J+(ae-J)*ne}function I(g,w,R,P,M){const D=g.elementData;if(D.length===0)return g.low;const G=S(P),J=b(M,g.low,g.high),ae=[];for(let Xe=0;Xe<D.length;Xe++)Xe===R?ae.push({time:G,value:J}):ae.push({time:D[Xe].time,value:D[Xe].value});ae.sort((Xe,_r)=>Xe.time-_r.time);let ne=-1,ie=0;for(let Xe=0;Xe<ae.length;Xe++){if(ae[Xe].time<=w)ne=Xe;else{ie=Xe;break}ie=Xe+1}if(ne<0)return ae[0].value;if(ie>=ae.length)return ae[ne].value;const Re=ae[ne].time,Qn=ae[ie].time,In=ae[ne].value,Bt=ae[ie].value,an=(w-Re)/(Qn-Re);return In+(Bt-In)*an}function W(g){if(g.target!==a&&g.target!==o||!m.value)return;const w=a.getPointerPosition();if(!w)return;const R=Ve(S(w.x),s.windowStart,s.windowEnd),P=Ve(b(w.y,m.value.low,m.value.high),m.value.low,m.value.high);i("action",{type:"NUMBER/ADD",trackId:m.value.id,time:R,value:P})}function K(){if(!s.selectedElementId||!s.selectedTrackId)return null;const g=c.get(s.selectedElementId);return g?{x:g.x(),y:g.y()}:null}return Pt(()=>{r.value&&(a=new Ye.Stage({container:r.value,width:r.value.clientWidth,height:p}),o=new Ye.Layer,a.add(o),a.on("click",W),l=new ResizeObserver(g=>{for(const w of g)f.value=w.contentRect.width,a&&(a.width(f.value),_())}),l.observe(r.value),f.value=r.value.clientWidth,_())}),Xt(()=>{l?.disconnect(),a?.destroy()}),Qe(()=>[s.renderVersion,s.windowStart,s.windowEnd,s.frontTrackId,s.tracks.length],()=>_(),{deep:!1}),Qe(()=>[s.selectedElementId,s.selectedTrackId],()=>_()),e({getSelectedElementPosition:K}),(g,w)=>(le(),ge("div",T1,[U("div",{ref_key:"containerRef",ref:r,class:"lane-canvas"},null,512)]))}}),[["styles",[".number-lane[data-v-dc1e8b7a]{height:var(--b2ac8aa8);background:var(--v5ac76444);border-bottom:1px solid #2a2d30;display:flex}.lane-canvas[data-v-dc1e8b7a]{flex:1;position:relative}"]],["__scopeId","data-v-dc1e8b7a"]]),A1={class:"enum-lane"},R1=lt(st({__name:"EnumLane",props:{tracks:{type:Array},frontTrackId:{type:null},windowStart:{type:Number},windowEnd:{type:Number},selectedElementId:{type:null},selectedTrackId:{type:null},renderVersion:{type:Number}},emits:["action"],setup(n,{expose:e,emit:t}){Dt(b=>({af3d0172:_e(da)+"px",v1c7f03d1:_e(ga)}));const s=n,i=t,r=me(null);let a=null,o=null,l=null;const c=new Map,d=me(0),h=da,u=Pe(()=>{if(s.frontTrackId)return s.tracks.find(b=>b.id===s.frontTrackId)});function f(b){return _n(b,s.windowStart,s.windowEnd,d.value)}function p(b){return ma(b,s.windowStart,s.windowEnd,d.value)}function m(){if(!(!o||!a||(o.destroyChildren(),c.clear(),d.value<=0))){for(const _ of s.tracks)_.id!==s.frontTrackId&&v(_,!1);u.value&&v(u.value,!0),o.batchDraw()}}function v(b,_){const C=b.elementData,A=h*.7,L=(h-A)/2;for(let O=0;O<C.length;O++){const I=C[O];if(I.time<s.windowStart||I.time>s.windowEnd)continue;const W=f(I.time),K=I.id===s.selectedElementId&&b.id===s.selectedTrackId,g=$s(I.value),w=new Ye.Group({x:W,y:0,draggable:_}),R=new Ye.Rect({x:-Ui/2,y:L,width:Ui,height:A,fill:g,opacity:_?fa:pa,cornerRadius:3,stroke:K?ha:void 0,strokeWidth:K?ua:0});w.add(R);const P=new Ye.Line({points:[0,0,0,h],stroke:"rgba(255,255,255,0.5)",strokeWidth:mc,opacity:_?.7:.3});w.add(P);const M=new Ye.Text({x:0,y:h/2,text:I.value,fontSize:10,fill:"#fff",rotation:-90,offsetX:0,offsetY:0});M.offsetX(M.width()/2),M.offsetY(-3),w.add(M),_&&(w.setAttr("elementId",I.id),w.on("click",D=>{D.evt.shiftKey?i("action",{type:"ENUM/DELETE",trackId:b.id,elementId:I.id}):i("action",{type:"ELEMENT/SELECT",fieldType:"enum",trackId:b.id,elementId:I.id})}),w.on("dragstart",()=>{i("action",{type:"ELEMENT/SELECT",fieldType:"enum",trackId:b.id,elementId:I.id})}),w.on("dragmove",()=>{w.y(0);let D=p(w.x());D=Ve(D,s.windowStart,s.windowEnd),w.x(f(D)),i("action",{type:"ENUM/DRAG_PREVIEW",trackId:b.id,elementId:I.id,time:D})}),w.on("dragend",()=>{let D=p(w.x());D=Ve(D,s.windowStart,s.windowEnd),i("action",{type:"ENUM/DRAG_END",trackId:b.id,elementId:I.id,time:D})}),c.set(I.id,w)),o.add(w)}}function S(b){if(b.target!==a&&b.target!==o||!u.value)return;const _=a.getPointerPosition();if(!_)return;const C=Ve(p(_.x),s.windowStart,s.windowEnd);i("action",{type:"ENUM/ADD",trackId:u.value.id,time:C})}function k(){if(!s.selectedElementId||!s.selectedTrackId)return null;const b=c.get(s.selectedElementId);return b?{x:b.x(),y:h/2}:null}return Pt(()=>{r.value&&(a=new Ye.Stage({container:r.value,width:r.value.clientWidth,height:h}),o=new Ye.Layer,a.add(o),a.on("click",S),l=new ResizeObserver(b=>{for(const _ of b)d.value=_.contentRect.width,a&&(a.width(d.value),m())}),l.observe(r.value),d.value=r.value.clientWidth,m())}),Xt(()=>{l?.disconnect(),a?.destroy()}),Qe(()=>[s.renderVersion,s.windowStart,s.windowEnd,s.frontTrackId,s.tracks.length],()=>m(),{deep:!1}),Qe(()=>[s.selectedElementId,s.selectedTrackId],()=>m()),e({getSelectedElementPosition:k}),(b,_)=>(le(),ge("div",A1,[U("div",{ref_key:"containerRef",ref:r,class:"lane-canvas"},null,512)]))}}),[["styles",[".enum-lane[data-v-55bde8dc]{height:var(--af3d0172);background:var(--v1c7f03d1);border-bottom:1px solid #2a2d30;display:flex}.lane-canvas[data-v-55bde8dc]{flex:1;position:relative}"]],["__scopeId","data-v-55bde8dc"]]),I1={class:"func-lane"},P1=lt(st({__name:"FuncLane",props:{tracks:{type:Array},frontTrackId:{type:null},windowStart:{type:Number},windowEnd:{type:Number},selectedElementId:{type:null},selectedTrackId:{type:null},renderVersion:{type:Number}},emits:["action"],setup(n,{expose:e,emit:t}){Dt(b=>({v2e7e7ace:_e(pc)+"px",ad621932:_e(ga)}));const s=n,i=t,r=me(null);let a=null,o=null,l=null;const c=new Map,d=me(0),h=pc,u=Pe(()=>{if(s.frontTrackId)return s.tracks.find(b=>b.id===s.frontTrackId)});function f(b){return _n(b,s.windowStart,s.windowEnd,d.value)}function p(b){return ma(b,s.windowStart,s.windowEnd,d.value)}function m(){if(!(!o||!a||(o.destroyChildren(),c.clear(),d.value<=0))){for(const _ of s.tracks)_.id!==s.frontTrackId&&v(_,!1);u.value&&v(u.value,!0),o.batchDraw()}}function v(b,_){const C=b.elementData,A=h*.7,L=(h-A)/2;for(let O=0;O<C.length;O++){const I=C[O];if(I.time<s.windowStart||I.time>s.windowEnd)continue;const W=f(I.time),K=I.id===s.selectedElementId&&b.id===s.selectedTrackId,g=$s(I.value.funcName),w=new Ye.Group({x:W,y:0,draggable:_}),R=new Ye.Rect({x:-Ui/2,y:L,width:Ui,height:A,fill:g,opacity:_?fa:pa,cornerRadius:3,stroke:K?ha:void 0,strokeWidth:K?ua:0});w.add(R);const P=new Ye.Line({points:[0,0,0,h],stroke:"rgba(255,255,255,0.5)",strokeWidth:mc,opacity:_?.7:.3});w.add(P);const M=new Ye.Text({x:0,y:h/2,text:I.value.funcName||"func",fontSize:10,fill:"#fff",rotation:-90,offsetX:0,offsetY:0});M.offsetX(M.width()/2),M.offsetY(-3),w.add(M),_&&(w.setAttr("elementId",I.id),w.on("click",D=>{D.evt.shiftKey?i("action",{type:"FUNC/DELETE",trackId:b.id,elementId:I.id}):i("action",{type:"ELEMENT/SELECT",fieldType:"func",trackId:b.id,elementId:I.id})}),w.on("dragstart",()=>{i("action",{type:"ELEMENT/SELECT",fieldType:"func",trackId:b.id,elementId:I.id})}),w.on("dragmove",()=>{w.y(0);let D=p(w.x());D=Ve(D,s.windowStart,s.windowEnd),w.x(f(D)),i("action",{type:"FUNC/DRAG_PREVIEW",trackId:b.id,elementId:I.id,time:D})}),w.on("dragend",()=>{let D=p(w.x());D=Ve(D,s.windowStart,s.windowEnd),i("action",{type:"FUNC/DRAG_END",trackId:b.id,elementId:I.id,time:D})}),c.set(I.id,w)),o.add(w)}}function S(b){if(b.target!==a&&b.target!==o||!u.value)return;const _=a.getPointerPosition();if(!_)return;const C=Ve(p(_.x),s.windowStart,s.windowEnd);i("action",{type:"FUNC/ADD",trackId:u.value.id,time:C})}function k(){if(!s.selectedElementId||!s.selectedTrackId)return null;const b=c.get(s.selectedElementId);return b?{x:b.x(),y:h/2}:null}return Pt(()=>{r.value&&(a=new Ye.Stage({container:r.value,width:r.value.clientWidth,height:h}),o=new Ye.Layer,a.add(o),a.on("click",S),l=new ResizeObserver(b=>{for(const _ of b)d.value=_.contentRect.width,a&&(a.width(d.value),m())}),l.observe(r.value),d.value=r.value.clientWidth,m())}),Xt(()=>{l?.disconnect(),a?.destroy()}),Qe(()=>[s.renderVersion,s.windowStart,s.windowEnd,s.frontTrackId,s.tracks.length],()=>m(),{deep:!1}),Qe(()=>[s.selectedElementId,s.selectedTrackId],()=>m()),e({getSelectedElementPosition:k}),(b,_)=>(le(),ge("div",I1,[U("div",{ref_key:"containerRef",ref:r,class:"lane-canvas"},null,512)]))}}),[["styles",[".func-lane[data-v-6a433a2d]{height:var(--v2e7e7ace);background:var(--ad621932);border-bottom:1px solid #2a2d30;display:flex}.lane-canvas[data-v-6a433a2d]{flex:1;position:relative}"]],["__scopeId","data-v-6a433a2d"]]),M1={class:"modal"},O1={class:"modal-header"},N1={class:"header-content"},L1={class:"track-badge"},D1={class:"modal-body"},G1={class:"field-row"},F1=["value"],B1={key:0,class:"field-row"},H1=["value"],$1={key:1,class:"field-row"},W1=["value"],U1=["value"],V1={class:"field-row"},j1=["value"],z1={class:"args-section"},Y1={class:"args-header"},X1={key:0,class:"args-list"},K1=["value","onChange"],Z1=["value","onInput","placeholder"],q1=["onClick"],J1={key:1,class:"no-args"},Q1={class:"modal-footer"},e2=["disabled"],t2=lt(st({__name:"PrecisionEditor",props:{open:{type:Boolean},fieldType:{type:String},trackName:{type:String},saved:{type:Object},draft:{type:Object},dirty:{type:Boolean},enumOptions:{type:Array}},emits:["action"],setup(n,{emit:e}){Dt(b=>({v09604e7e:_e(r0)+"px"}));const t=n,s=e,i=me({...t.draft});Qe(()=>t.draft,b=>{i.value={...b}},{deep:!0});function r(b){Object.assign(i.value,b),s("action",{type:"PRECISION/CHANGE_DRAFT",draft:b})}function a(){s("action",{type:"PRECISION/SAVE"})}function o(){s("action",{type:"PRECISION/REVERT"})}function l(){s("action",{type:"PRECISION/CLOSE"})}function c(b){const _=parseFloat(b.target.value);!isNaN(_)&&_>=0&&r({time:_})}function d(b){const _=parseFloat(b.target.value);isNaN(_)||r({value:_})}function h(b){const _=b.target.value;r({enumValue:_})}function u(b){const _=b.target.value;r({funcName:_})}const f=Pe(()=>i.value.funcArgs||[]);function p(){const b=[...f.value,{type:"text",value:""}];r({funcArgs:b})}function m(b){const _=f.value.filter((C,A)=>A!==b);r({funcArgs:_})}function v(b,_){const C=[...f.value];C[b]={...C[b],type:_},r({funcArgs:C})}function S(b,_){const C=[...f.value];C[b]={...C[b],value:_},r({funcArgs:C})}function k(b){b.target===b.currentTarget&&l()}return(b,_)=>(le(),fn(Fh,{to:"body"},[n.open?(le(),ge("div",{key:0,class:"modal-backdrop",onClick:k},[U("div",M1,[U("div",O1,[U("div",N1,[_[0]||(_[0]=U("span",{class:"header-title"},"Edit Element",-1)),U("span",L1,St(n.trackName),1)]),U("button",{class:"close-btn",onClick:l},[..._[1]||(_[1]=[U("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[U("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])])]),U("div",D1,[U("div",G1,[_[2]||(_[2]=U("label",null,"Time",-1)),U("input",{type:"number",value:i.value.time,step:"0.1",min:"0",onChange:c,class:"input"},null,40,F1)]),n.fieldType==="number"?(le(),ge("div",B1,[_[3]||(_[3]=U("label",null,"Value",-1)),U("input",{type:"number",value:i.value.value,step:"0.01",onChange:d,class:"input"},null,40,H1)])):Ue("",!0),n.fieldType==="enum"?(le(),ge("div",$1,[_[4]||(_[4]=U("label",null,"Value",-1)),U("select",{value:i.value.enumValue,onChange:h,class:"input select"},[(le(!0),ge(He,null,hn(n.enumOptions,C=>(le(),ge("option",{key:C,value:C},St(C),9,U1))),128))],40,W1)])):Ue("",!0),n.fieldType==="func"?(le(),ge(He,{key:2},[U("div",V1,[_[5]||(_[5]=U("label",null,"Function",-1)),U("input",{type:"text",value:i.value.funcName,onInput:u,class:"input",placeholder:"functionName"},null,40,j1)]),U("div",z1,[U("div",Y1,[_[6]||(_[6]=U("span",{class:"args-label"},"Arguments",-1)),f.value.length<5?(le(),ge("button",{key:0,class:"add-arg-btn",onClick:p}," + Add ")):Ue("",!0)]),f.value.length>0?(le(),ge("div",X1,[(le(!0),ge(He,null,hn(f.value,(C,A)=>(le(),ge("div",{key:A,class:"arg-row"},[U("select",{value:C.type,onChange:L=>v(A,L.target.value),class:"arg-type"},[..._[7]||(_[7]=[U("option",{value:"text"},"Text",-1),U("option",{value:"number"},"Num",-1)])],40,K1),U("input",{type:"text",value:C.value,onInput:L=>S(A,L.target.value),class:"arg-value",placeholder:C.type==="number"?"0":"value"},null,40,Z1),U("button",{class:"remove-arg-btn",onClick:L=>m(A)},"",8,q1)]))),128))])):(le(),ge("div",J1,"No arguments"))])],64)):Ue("",!0)]),U("div",Q1,[U("button",{class:"btn btn-secondary",onClick:o,disabled:!n.dirty}," Revert ",8,e2),U("button",{class:"btn btn-primary",onClick:a}," Save ")])])])):Ue("",!0)]))}}),[["styles",[".modal-backdrop[data-v-74aa06f1]{position:fixed;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000}.modal[data-v-74aa06f1]{width:var(--v09604e7e);background:#1a1c20;border-radius:8px;box-shadow:0 8px 32px #0006;border:1px solid #2a2d30}.modal-header[data-v-74aa06f1]{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;border-bottom:1px solid #2a2d30}.header-content[data-v-74aa06f1]{display:flex;align-items:center;gap:10px}.header-title[data-v-74aa06f1]{font-size:13px;font-weight:500;color:#e0e0e0}.track-badge[data-v-74aa06f1]{font-size:11px;color:#888;background:#252830;padding:2px 8px;border-radius:3px}.close-btn[data-v-74aa06f1]{width:26px;height:26px;padding:0;display:flex;align-items:center;justify-content:center;background:transparent;border:none;color:#666;cursor:pointer;border-radius:4px;transition:all .15s ease}.close-btn[data-v-74aa06f1]:hover{background:#2a2d30;color:#c8c8c8}.modal-body[data-v-74aa06f1]{padding:12px 16px}.field-row[data-v-74aa06f1]{display:flex;align-items:center;gap:12px;margin-bottom:10px}.field-row label[data-v-74aa06f1]{flex-shrink:0;width:60px;font-size:11px;color:#888;text-transform:uppercase;letter-spacing:.5px}.input[data-v-74aa06f1]{flex:1;padding:6px 10px;background:#141618;border:1px solid #2a2d30;border-radius:4px;color:#c8c8c8;font-size:13px;transition:border-color .15s ease}.input[data-v-74aa06f1]:focus{outline:none;border-color:#3a7ca5}.input.select[data-v-74aa06f1]{cursor:pointer}.args-section[data-v-74aa06f1]{margin-top:12px;padding-top:12px;border-top:1px solid #2a2d30}.args-header[data-v-74aa06f1]{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}.args-label[data-v-74aa06f1]{font-size:11px;color:#888;text-transform:uppercase;letter-spacing:.5px}.add-arg-btn[data-v-74aa06f1]{padding:4px 10px;background:transparent;border:1px solid #2a2d30;border-radius:3px;color:#888;font-size:11px;cursor:pointer;transition:all .15s ease}.add-arg-btn[data-v-74aa06f1]:hover{background:#252830;color:#c8c8c8;border-color:#3a3d42}.args-list[data-v-74aa06f1]{display:flex;flex-direction:column;gap:6px}.arg-row[data-v-74aa06f1]{display:flex;gap:6px;align-items:center}.arg-type[data-v-74aa06f1]{width:70px;padding:5px 6px;background:#141618;border:1px solid #2a2d30;border-radius:3px;color:#c8c8c8;font-size:11px;cursor:pointer}.arg-value[data-v-74aa06f1]{flex:1;padding:5px 8px;background:#141618;border:1px solid #2a2d30;border-radius:3px;color:#c8c8c8;font-size:12px}.arg-value[data-v-74aa06f1]:focus,.arg-type[data-v-74aa06f1]:focus{outline:none;border-color:#3a7ca5}.remove-arg-btn[data-v-74aa06f1]{width:22px;height:22px;padding:0;background:transparent;border:none;color:#555;font-size:14px;cursor:pointer;border-radius:3px;transition:all .15s ease}.remove-arg-btn[data-v-74aa06f1]:hover{background:#dc2626;color:#fff}.no-args[data-v-74aa06f1]{font-size:11px;color:#555;text-align:center;padding:8px}.modal-footer[data-v-74aa06f1]{display:flex;justify-content:flex-end;gap:8px;padding:10px 16px;border-top:1px solid #2a2d30}.btn[data-v-74aa06f1]{padding:6px 14px;border-radius:4px;font-size:12px;font-weight:500;cursor:pointer;border:none;transition:all .15s ease}.btn-secondary[data-v-74aa06f1]{background:#252830;color:#b0b0b0}.btn-secondary[data-v-74aa06f1]:hover:not(:disabled){background:#2d3038;color:#e0e0e0}.btn-secondary[data-v-74aa06f1]:disabled{opacity:.4;cursor:not-allowed}.btn-primary[data-v-74aa06f1]{background:#3a7ca5;color:#fff}.btn-primary[data-v-74aa06f1]:hover{background:#4a8cb5}"]],["__scopeId","data-v-74aa06f1"]]),n2={class:"edit-mode-view"},s2={class:"sidebar-column"},i2={class:"sidebar-header"},r2={class:"lanes-area"},a2={key:3,class:"empty-lanes"},o2=lt(st({__name:"EditModeView",props:{core:{type:Object},windowStart:{type:Number},windowEnd:{type:Number},currentTime:{type:Number},initialEnabledTrackIds:{type:Set}},setup(n){Dt(g=>({v026fd8e2:_e(fc)+"px"}));const e=n,{warning:t}=bc(),s=me(new Set),i=me({}),r=me({}),a=me(null),o=me(0),l=me(null),c=me(null),d=me(null),h=me(null),u=me(0),f=me(null),p=Pe(()=>e.core.getOrderedTracks()),m=Pe(()=>{const g=s.value;return p.value.filter(w=>w.def.fieldType==="number"&&g.has(w.id))}),v=Pe(()=>{const g=s.value;return p.value.filter(w=>w.def.fieldType==="enum"&&g.has(w.id))}),S=Pe(()=>{const g=s.value;return p.value.filter(w=>w.def.fieldType==="func"&&g.has(w.id))}),k=Pe(()=>a.value&&e.core.getTrackById(a.value.trackId)?.def.name||""),b=Pe(()=>!a.value||a.value.fieldType!=="enum"?[]:e.core.getEnumOptions(a.value.trackId));function _(g,w,R){r.value={number:g==="number"?{trackId:w,elementId:R}:void 0,enum:g==="enum"?{trackId:w,elementId:R}:void 0,func:g==="func"?{trackId:w,elementId:R}:void 0}}Pt(()=>{if(e.initialEnabledTrackIds&&e.initialEnabledTrackIds.size>0)s.value=new Set(e.initialEnabledTrackIds);else for(const g of p.value)s.value.add(g.id);for(const g of p.value)s.value.has(g.id)&&!i.value[g.def.fieldType]&&(i.value[g.def.fieldType]=g.id)}),Qe(h,g=>{if(!g)return;new ResizeObserver(R=>{for(const P of R)u.value=P.contentRect.width}).observe(g)},{immediate:!0}),Qe(()=>[e.windowStart,e.windowEnd],()=>A()),Qe(()=>[r.value.number,r.value.enum,r.value.func],()=>C(),{deep:!0});function C(){if(r.value.number&&l.value){const g=l.value.getSelectedElementPosition();if(g){f.value={x:g.x,y:g.y,type:"number"};return}}if(r.value.enum&&c.value){const g=c.value.getSelectedElementPosition();if(g){const w=m.value.length>0?Wi:0;f.value={x:g.x,y:g.y+w,type:"enum"};return}}if(r.value.func&&d.value){const g=d.value.getSelectedElementPosition();if(g){const w=(m.value.length>0?Wi:0)+(v.value.length>0?da:0);f.value={x:g.x,y:g.y+w,type:"func"};return}}f.value=null}function A(){o.value++,setTimeout(C,50)}function L(g){switch(g.type){case"TRACK/TOGGLE_EDIT_ENABLED":g.enabled?s.value.add(g.trackId):s.value.delete(g.trackId),A();break;case"TRACK/SET_FRONT":{i.value[g.fieldType]=g.trackId,A();break}case"TRACK/DELETE":{e.core.pushSnapshot(),e.core.deleteTrack(g.trackId),s.value.delete(g.trackId);for(const w of["number","enum","func"])i.value[w]===g.trackId&&(i.value[w]=void 0);for(const w of["number","enum","func"])r.value[w]?.trackId===g.trackId&&(r.value[w]=void 0);A();break}case"TRACK/SET_BOUNDS":{e.core.pushSnapshot(),e.core.setTrackBounds(g.trackId,g.low,g.high),A();break}case"EDIT/UNDO":e.core.undo()&&A();break;case"EDIT/REDO":e.core.redo()&&A();break;case"ELEMENT/SELECT":_(g.fieldType,g.trackId,g.elementId),setTimeout(C,10);break;case"ELEMENT/DESELECT":r.value[g.fieldType]=void 0;break;case"PRECISION/OPEN":{const w=e.core.getTrackById(g.trackId),R=e.core.getElement(g.trackId,g.elementId);if(!w||!R)break;const P=O(w,R);a.value={open:!0,fieldType:g.fieldType,trackId:g.trackId,elementId:g.elementId,saved:{...P},draft:P,dirty:!1};break}case"PRECISION/CHANGE_DRAFT":a.value&&(Object.assign(a.value.draft,g.draft),a.value.dirty=!0);break;case"PRECISION/SAVE":a.value&&I();break;case"PRECISION/REVERT":a.value&&(a.value.draft={...a.value.saved},a.value.dirty=!1);break;case"PRECISION/CLOSE":a.value=null;break;case"NUMBER/ADD":{e.core.pushSnapshot();const w=e.core.addNumberElement(g.trackId,g.time,g.value);w&&_("number",g.trackId,w),A();break}case"NUMBER/DELETE":{e.core.pushSnapshot(),e.core.deleteElement(g.trackId,g.elementId),r.value.number?.elementId===g.elementId&&(r.value.number=void 0),A();break}case"NUMBER/DRAG_START":break;case"NUMBER/DRAG_PREVIEW":e.core.setDragPreview({fieldType:"number",trackId:g.trackId,elementId:g.elementId,time:g.time,value:g.value}),e.core.evaluateAtCurrentTime(),setTimeout(C,0);break;case"NUMBER/DRAG_END":{e.core.setDragPreview(null),e.core.pushSnapshot(),e.core.updateNumberElement(g.trackId,g.elementId,g.time,g.value),A();break}case"ENUM/ADD":{e.core.pushSnapshot();const w=e.core.addEnumElement(g.trackId,g.time);w&&_("enum",g.trackId,w),A();break}case"ENUM/DELETE":{e.core.pushSnapshot(),e.core.deleteElement(g.trackId,g.elementId),r.value.enum?.elementId===g.elementId&&(r.value.enum=void 0),A();break}case"ENUM/DRAG_PREVIEW":e.core.setDragPreview({fieldType:"enum",trackId:g.trackId,elementId:g.elementId,time:g.time}),e.core.evaluateAtCurrentTime(),setTimeout(C,0);break;case"ENUM/DRAG_END":{e.core.setDragPreview(null),e.core.pushSnapshot(),e.core.updateEnumElement(g.trackId,g.elementId,g.time).collision&&t("Can't have elements at the same time"),A();break}case"FUNC/ADD":{e.core.pushSnapshot();const w=e.core.addFuncElement(g.trackId,g.time);w&&_("func",g.trackId,w),A();break}case"FUNC/DELETE":{e.core.pushSnapshot(),e.core.deleteElement(g.trackId,g.elementId),r.value.func?.elementId===g.elementId&&(r.value.func=void 0),A();break}case"FUNC/DRAG_PREVIEW":setTimeout(C,0);break;case"FUNC/DRAG_END":{e.core.pushSnapshot(),e.core.updateFuncElement(g.trackId,g.elementId,g.time).collision&&t("Can't have elements at the same time"),A();break}}}function O(g,w){const R={time:w.time};if(g.def.fieldType==="number")R.value=w.value;else if(g.def.fieldType==="enum")R.enumValue=w.value;else if(g.def.fieldType==="func"){const P=w.value;R.funcName=P.funcName,R.funcArgs=P.args.map(M=>({type:typeof M=="number"?"number":"text",value:String(M)}))}return R}function I(){if(!a.value)return;const{fieldType:g,trackId:w,elementId:R,draft:P}=a.value;if(e.core.pushSnapshot(),g==="number")e.core.updateNumberElement(w,R,P.time,P.value??0);else if(g==="enum")e.core.updateEnumElement(w,R,P.time,P.enumValue).collision&&t("Can't have elements at the same time - time was adjusted");else if(g==="func"){const M=(P.funcArgs||[]).map(G=>{if(G.type==="number"){const J=Number(G.value);return isFinite(J)?J:0}return G.value});e.core.updateFuncElement(w,R,P.time,P.funcName,M).collision&&t("Can't have elements at the same time - time was adjusted")}a.value.saved={...P},a.value.dirty=!1,A()}function W(){if(!f.value)return;const g=f.value.type,w=r.value[g];w&&L({type:"PRECISION/OPEN",fieldType:g,trackId:w.trackId,elementId:w.elementId})}const K=Pe(()=>{if(!f.value)return{};const{x:g,y:w}=f.value,R=Math.min(Math.max(g+16,30),u.value-50),P=Math.max(w-12,4);return{left:`${R}px`,top:`${P}px`}});return(g,w)=>(le(),ge("div",n2,[U("div",s2,[U("div",i2,[U("button",{class:"header-btn",onClick:w[0]||(w[0]=R=>L({type:"EDIT/UNDO"})),title:"Undo"},[...w[2]||(w[2]=[U("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[U("path",{d:"M3 7v6h6"}),U("path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"})],-1)])]),U("button",{class:"header-btn",onClick:w[1]||(w[1]=R=>L({type:"EDIT/REDO"})),title:"Redo"},[...w[3]||(w[3]=[U("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[U("path",{d:"M21 7v6h-6"}),U("path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3L21 13"})],-1)])])]),We(sp,{tracks:p.value,"edit-enabled-track-ids":s.value,"front-track-id-by-type":i.value,onAction:L},null,8,["tracks","edit-enabled-track-ids","front-track-id-by-type"])]),U("div",r2,[U("div",{class:"lanes-container",ref_key:"lanesContainerRef",ref:h},[m.value.length>0?(le(),fn(E1,{key:0,ref_key:"numberLaneRef",ref:l,tracks:m.value,"front-track-id":i.value.number,"window-start":n.windowStart,"window-end":n.windowEnd,"selected-element-id":r.value.number?.elementId,"selected-track-id":r.value.number?.trackId,"render-version":o.value,onAction:L},null,8,["tracks","front-track-id","window-start","window-end","selected-element-id","selected-track-id","render-version"])):Ue("",!0),v.value.length>0?(le(),fn(R1,{key:1,ref_key:"enumLaneRef",ref:c,tracks:v.value,"front-track-id":i.value.enum,"window-start":n.windowStart,"window-end":n.windowEnd,"selected-element-id":r.value.enum?.elementId,"selected-track-id":r.value.enum?.trackId,"render-version":o.value,onAction:L},null,8,["tracks","front-track-id","window-start","window-end","selected-element-id","selected-track-id","render-version"])):Ue("",!0),S.value.length>0?(le(),fn(P1,{key:2,ref_key:"funcLaneRef",ref:d,tracks:S.value,"front-track-id":i.value.func,"window-start":n.windowStart,"window-end":n.windowEnd,"selected-element-id":r.value.func?.elementId,"selected-track-id":r.value.func?.trackId,"render-version":o.value,onAction:L},null,8,["tracks","front-track-id","window-start","window-end","selected-element-id","selected-track-id","render-version"])):Ue("",!0),m.value.length===0&&v.value.length===0&&S.value.length===0?(le(),ge("div",a2," Select tracks in view mode to edit ")):Ue("",!0),We(yc,{"current-time":n.currentTime,"window-start":n.windowStart,"window-end":n.windowEnd,"canvas-width":u.value,"left-offset":0},null,8,["current-time","window-start","window-end","canvas-width"]),f.value?(le(),ge("button",{key:4,class:"precision-btn",style:Pn(K.value),onClick:W,title:"Edit element"},[...w[4]||(w[4]=[U("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2.5"},[U("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),U("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])],4)):Ue("",!0)],512)]),a.value?(le(),fn(t2,{key:0,open:a.value.open,"field-type":a.value.fieldType,"track-name":k.value,saved:a.value.saved,draft:a.value.draft,dirty:a.value.dirty,"enum-options":b.value,onAction:L},null,8,["open","field-type","track-name","saved","draft","dirty","enum-options"])):Ue("",!0)]))}}),[["styles",[".edit-mode-view[data-v-0ca84430]{display:flex;flex:1;background:#121416;overflow:hidden}.sidebar-column[data-v-0ca84430]{width:var(--v026fd8e2);min-width:var(--v026fd8e2);display:flex;flex-direction:column;background:#141618;border-right:1px solid #2a2d30}.sidebar-header[data-v-0ca84430]{height:24px;min-height:24px;display:flex;align-items:center;justify-content:center;gap:8px;padding:0 8px;border-bottom:1px solid #2a2d30;background:#141618}.header-btn[data-v-0ca84430]{width:28px;height:28px;padding:0;display:flex;align-items:center;justify-content:center;background:#1e2024;border:1px solid #2a2d30;border-radius:4px;color:#888;cursor:pointer;transition:all .15s ease}.header-btn[data-v-0ca84430]:hover{background:#282c32;color:#c8c8c8}.lanes-area[data-v-0ca84430]{flex:1;display:flex;flex-direction:column;overflow:hidden}.lanes-container[data-v-0ca84430]{flex:1;position:relative;overflow-y:auto}.empty-lanes[data-v-0ca84430]{display:flex;align-items:center;justify-content:center;height:200px;color:#555;font-size:13px}.precision-btn[data-v-0ca84430]{position:absolute;width:26px;height:26px;padding:0;display:flex;align-items:center;justify-content:center;background:#3a7ca5;border:none;border-radius:4px;color:#fff;cursor:pointer;z-index:100;transition:background .15s ease,transform .1s ease;box-shadow:0 2px 8px #0000004d}.precision-btn[data-v-0ca84430]:hover{background:#4a8cb5;transform:scale(1.05)}"]],["__scopeId","data-v-0ca84430"]]),l2={class:"toast-container"},c2=["onClick"],d2=lt(st({__name:"ToastContainer",setup(n){const{toasts:e,removeToast:t}=bc();function s(i){return`toast toast-${i}`}return(i,r)=>(le(),ge("div",l2,[We(ff,{name:"toast"},{default:$o(()=>[(le(!0),ge(He,null,hn(_e(e),a=>(le(),ge("div",{key:a.id,class:Mn(s(a.type)),onClick:o=>_e(t)(a.id)},St(a.message),11,c2))),128))]),_:1})]))}}),[["styles",[".toast-container[data-v-c3213c7c]{position:fixed;bottom:20px;right:20px;z-index:9999;display:flex;flex-direction:column;gap:8px;pointer-events:none}.toast[data-v-c3213c7c]{padding:12px 20px;border-radius:6px;font-size:13px;font-family:system-ui,sans-serif;color:#fff;cursor:pointer;pointer-events:auto;box-shadow:0 4px 12px #0000004d;max-width:300px}.toast-info[data-v-c3213c7c]{background:#3b82f6}.toast-warning[data-v-c3213c7c]{background:#f59e0b;color:#000}.toast-error[data-v-c3213c7c]{background:#ef4444}.toast-success[data-v-c3213c7c]{background:#22c55e}.toast-enter-active[data-v-c3213c7c],.toast-leave-active[data-v-c3213c7c]{transition:all .3s ease}.toast-enter-from[data-v-c3213c7c],.toast-leave-to[data-v-c3213c7c]{opacity:0;transform:translate(100px)}"]],["__scopeId","data-v-c3213c7c"]]);var Se;(function(n){n.assertEqual=i=>{};function e(i){}n.assertIs=e;function t(i){throw new Error}n.assertNever=t,n.arrayToEnum=i=>{const r={};for(const a of i)r[a]=a;return r},n.getValidEnumValues=i=>{const r=n.objectKeys(i).filter(o=>typeof i[i[o]]!="number"),a={};for(const o of r)a[o]=i[o];return n.objectValues(a)},n.objectValues=i=>n.objectKeys(i).map(function(r){return i[r]}),n.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{const r=[];for(const a in i)Object.prototype.hasOwnProperty.call(i,a)&&r.push(a);return r},n.find=(i,r)=>{for(const a of i)if(r(a))return a},n.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&Number.isFinite(i)&&Math.floor(i)===i;function s(i,r=" | "){return i.map(a=>typeof a=="string"?`'${a}'`:a).join(r)}n.joinValues=s,n.jsonStringifyReplacer=(i,r)=>typeof r=="bigint"?r.toString():r})(Se||(Se={}));var kd;(function(n){n.mergeShapes=(e,t)=>({...e,...t})})(kd||(kd={}));const se=Se.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Cn=n=>{switch(typeof n){case"undefined":return se.undefined;case"string":return se.string;case"number":return Number.isNaN(n)?se.nan:se.number;case"boolean":return se.boolean;case"function":return se.function;case"bigint":return se.bigint;case"symbol":return se.symbol;case"object":return Array.isArray(n)?se.array:n===null?se.null:n.then&&typeof n.then=="function"&&n.catch&&typeof n.catch=="function"?se.promise:typeof Map<"u"&&n instanceof Map?se.map:typeof Set<"u"&&n instanceof Set?se.set:typeof Date<"u"&&n instanceof Date?se.date:se.object;default:return se.unknown}},j=Se.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class tn extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(r){return r.message},s={_errors:[]},i=r=>{for(const a of r.issues)if(a.code==="invalid_union")a.unionErrors.map(i);else if(a.code==="invalid_return_type")i(a.returnTypeError);else if(a.code==="invalid_arguments")i(a.argumentsError);else if(a.path.length===0)s._errors.push(t(a));else{let o=s,l=0;for(;l<a.path.length;){const c=a.path[l];l===a.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(t(a))):o[c]=o[c]||{_errors:[]},o=o[c],l++}}};return i(this),s}static assert(e){if(!(e instanceof tn))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Se.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},s=[];for(const i of this.issues)if(i.path.length>0){const r=i.path[0];t[r]=t[r]||[],t[r].push(e(i))}else s.push(e(i));return{formErrors:s,fieldErrors:t}}get formErrors(){return this.flatten()}}tn.create=n=>new tn(n);const Wa=(n,e)=>{let t;switch(n.code){case j.invalid_type:n.received===se.undefined?t="Required":t=`Expected ${n.expected}, received ${n.received}`;break;case j.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(n.expected,Se.jsonStringifyReplacer)}`;break;case j.unrecognized_keys:t=`Unrecognized key(s) in object: ${Se.joinValues(n.keys,", ")}`;break;case j.invalid_union:t="Invalid input";break;case j.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${Se.joinValues(n.options)}`;break;case j.invalid_enum_value:t=`Invalid enum value. Expected ${Se.joinValues(n.options)}, received '${n.received}'`;break;case j.invalid_arguments:t="Invalid function arguments";break;case j.invalid_return_type:t="Invalid function return type";break;case j.invalid_date:t="Invalid date";break;case j.invalid_string:typeof n.validation=="object"?"includes"in n.validation?(t=`Invalid input: must include "${n.validation.includes}"`,typeof n.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${n.validation.position}`)):"startsWith"in n.validation?t=`Invalid input: must start with "${n.validation.startsWith}"`:"endsWith"in n.validation?t=`Invalid input: must end with "${n.validation.endsWith}"`:Se.assertNever(n.validation):n.validation!=="regex"?t=`Invalid ${n.validation}`:t="Invalid";break;case j.too_small:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at least":"more than"} ${n.minimum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at least":"over"} ${n.minimum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="bigint"?t=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(n.minimum))}`:t="Invalid input";break;case j.too_big:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at most":"less than"} ${n.maximum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at most":"under"} ${n.maximum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="bigint"?t=`BigInt must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly":n.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(n.maximum))}`:t="Invalid input";break;case j.custom:t="Invalid input";break;case j.invalid_intersection_types:t="Intersection results could not be merged";break;case j.not_multiple_of:t=`Number must be a multiple of ${n.multipleOf}`;break;case j.not_finite:t="Number must be finite";break;default:t=e.defaultError,Se.assertNever(n)}return{message:t}};let h2=Wa;function u2(){return h2}const f2=n=>{const{data:e,path:t,errorMaps:s,issueData:i}=n,r=[...t,...i.path||[]],a={...i,path:r};if(i.message!==void 0)return{...i,path:r,message:i.message};let o="";const l=s.filter(c=>!!c).slice().reverse();for(const c of l)o=c(a,{data:e,defaultError:o}).message;return{...i,path:r,message:o}};function ee(n,e){const t=u2(),s=f2({issueData:e,data:n.data,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,t,t===Wa?void 0:Wa].filter(i=>!!i)});n.common.issues.push(s)}class ut{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const s=[];for(const i of t){if(i.status==="aborted")return he;i.status==="dirty"&&e.dirty(),s.push(i.value)}return{status:e.value,value:s}}static async mergeObjectAsync(e,t){const s=[];for(const i of t){const r=await i.key,a=await i.value;s.push({key:r,value:a})}return ut.mergeObjectSync(e,s)}static mergeObjectSync(e,t){const s={};for(const i of t){const{key:r,value:a}=i;if(r.status==="aborted"||a.status==="aborted")return he;r.status==="dirty"&&e.dirty(),a.status==="dirty"&&e.dirty(),r.value!=="__proto__"&&(typeof a.value<"u"||i.alwaysSet)&&(s[r.value]=a.value)}return{status:e.value,value:s}}}const he=Object.freeze({status:"aborted"}),ri=n=>({status:"dirty",value:n}),yt=n=>({status:"valid",value:n}),Cd=n=>n.status==="aborted",Td=n=>n.status==="dirty",_s=n=>n.status==="valid",lr=n=>typeof Promise<"u"&&n instanceof Promise;var re;(function(n){n.errToObj=e=>typeof e=="string"?{message:e}:e||{},n.toString=e=>typeof e=="string"?e:e?.message})(re||(re={}));class Tn{constructor(e,t,s,i){this._cachedPath=[],this.parent=e,this.data=t,this._path=s,this._key=i}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Ed=(n,e)=>{if(_s(e))return{success:!0,data:e.value};if(!n.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new tn(n.common.issues);return this._error=t,this._error}}};function ve(n){if(!n)return{};const{errorMap:e,invalid_type_error:t,required_error:s,description:i}=n;if(e&&(t||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(a,o)=>{const{message:l}=n;return a.code==="invalid_enum_value"?{message:l??o.defaultError}:typeof o.data>"u"?{message:l??s??o.defaultError}:a.code!=="invalid_type"?{message:o.defaultError}:{message:l??t??o.defaultError}},description:i}}class be{get description(){return this._def.description}_getType(e){return Cn(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:Cn(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new ut,ctx:{common:e.parent.common,data:e.data,parsedType:Cn(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(lr(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const s=this.safeParse(e,t);if(s.success)return s.data;throw s.error}safeParse(e,t){const s={common:{issues:[],async:t?.async??!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Cn(e)},i=this._parseSync({data:e,path:s.path,parent:s});return Ed(s,i)}"~validate"(e){const t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Cn(e)};if(!this["~standard"].async)try{const s=this._parseSync({data:e,path:[],parent:t});return _s(s)?{value:s.value}:{issues:t.common.issues}}catch(s){s?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(s=>_s(s)?{value:s.value}:{issues:t.common.issues})}async parseAsync(e,t){const s=await this.safeParseAsync(e,t);if(s.success)return s.data;throw s.error}async safeParseAsync(e,t){const s={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Cn(e)},i=this._parse({data:e,path:s.path,parent:s}),r=await(lr(i)?i:Promise.resolve(i));return Ed(s,r)}refine(e,t){const s=i=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(i):t;return this._refinement((i,r)=>{const a=e(i),o=()=>r.addIssue({code:j.custom,...s(i)});return typeof Promise<"u"&&a instanceof Promise?a.then(l=>l?!0:(o(),!1)):a?!0:(o(),!1)})}refinement(e,t){return this._refinement((s,i)=>e(s)?!0:(i.addIssue(typeof t=="function"?t(s,i):t),!1))}_refinement(e){return new qn({schema:this,typeName:ue.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return sn.create(this,this._def)}nullable(){return Jn.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Ft.create(this)}promise(){return fr.create(this,this._def)}or(e){return dr.create([this,e],this._def)}and(e){return hr.create(this,e,this._def)}transform(e){return new qn({...ve(this._def),schema:this,typeName:ue.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new pr({...ve(this._def),innerType:this,defaultValue:t,typeName:ue.ZodDefault})}brand(){return new Dd({typeName:ue.ZodBranded,type:this,...ve(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new gr({...ve(this._def),innerType:this,catchValue:t,typeName:ue.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return Ja.create(this,e)}readonly(){return mr.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const p2=/^c[^\s-]{8,}$/i,g2=/^[0-9a-z]+$/,m2=/^[0-9A-HJKMNP-TV-Z]{26}$/i,_2=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,v2=/^[a-z0-9_-]{21}$/i,y2=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,b2=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,w2=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,x2="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Ua;const S2=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,k2=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,C2=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,T2=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,E2=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,A2=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Ad="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",R2=new RegExp(`^${Ad}$`);function Rd(n){let e="[0-5]\\d";n.precision?e=`${e}\\.\\d{${n.precision}}`:n.precision==null&&(e=`${e}(\\.\\d+)?`);const t=n.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${t}`}function I2(n){return new RegExp(`^${Rd(n)}$`)}function P2(n){let e=`${Ad}T${Rd(n)}`;const t=[];return t.push(n.local?"Z?":"Z"),n.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function M2(n,e){return!!((e==="v4"||!e)&&S2.test(n)||(e==="v6"||!e)&&C2.test(n))}function O2(n,e){if(!y2.test(n))return!1;try{const[t]=n.split(".");if(!t)return!1;const s=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),i=JSON.parse(atob(s));return!(typeof i!="object"||i===null||"typ"in i&&i?.typ!=="JWT"||!i.alg||e&&i.alg!==e)}catch{return!1}}function N2(n,e){return!!((e==="v4"||!e)&&k2.test(n)||(e==="v6"||!e)&&T2.test(n))}class En extends be{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==se.string){const r=this._getOrReturnCtx(e);return ee(r,{code:j.invalid_type,expected:se.string,received:r.parsedType}),he}const s=new ut;let i;for(const r of this._def.checks)if(r.kind==="min")e.data.length<r.value&&(i=this._getOrReturnCtx(e,i),ee(i,{code:j.too_small,minimum:r.value,type:"string",inclusive:!0,exact:!1,message:r.message}),s.dirty());else if(r.kind==="max")e.data.length>r.value&&(i=this._getOrReturnCtx(e,i),ee(i,{code:j.too_big,maximum:r.value,type:"string",inclusive:!0,exact:!1,message:r.message}),s.dirty());else if(r.kind==="length"){const a=e.data.length>r.value,o=e.data.length<r.value;(a||o)&&(i=this._getOrReturnCtx(e,i),a?ee(i,{code:j.too_big,maximum:r.value,type:"string",inclusive:!0,exact:!0,message:r.message}):o&&ee(i,{code:j.too_small,minimum:r.value,type:"string",inclusive:!0,exact:!0,message:r.message}),s.dirty())}else if(r.kind==="email")w2.test(e.data)||(i=this._getOrReturnCtx(e,i),ee(i,{validation:"email",code:j.invalid_string,message:r.message}),s.dirty());else if(r.kind==="emoji")Ua||(Ua=new RegExp(x2,"u")),Ua.test(e.data)||(i=this._getOrReturnCtx(e,i),ee(i,{validation:"emoji",code:j.invalid_string,message:r.message}),s.dirty());else if(r.kind==="uuid")_2.test(e.data)||(i=this._getOrReturnCtx(e,i),ee(i,{validation:"uuid",code:j.invalid_string,message:r.message}),s.dirty());else if(r.kind==="nanoid")v2.test(e.data)||(i=this._getOrReturnCtx(e,i),ee(i,{validation:"nanoid",code:j.invalid_string,message:r.message}),s.dirty());else if(r.kind==="cuid")p2.test(e.data)||(i=this._getOrReturnCtx(e,i),ee(i,{validation:"cuid",code:j.invalid_string,message:r.message}),s.dirty());else if(r.kind==="cuid2")g2.test(e.data)||(i=this._getOrReturnCtx(e,i),ee(i,{validation:"cuid2",code:j.invalid_string,message:r.message}),s.dirty());else if(r.kind==="ulid")m2.test(e.data)||(i=this._getOrReturnCtx(e,i),ee(i,{validation:"ulid",code:j.invalid_string,message:r.message}),s.dirty());else if(r.kind==="url")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),ee(i,{validation:"url",code:j.invalid_string,message:r.message}),s.dirty()}else r.kind==="regex"?(r.regex.lastIndex=0,r.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),ee(i,{validation:"regex",code:j.invalid_string,message:r.message}),s.dirty())):r.kind==="trim"?e.data=e.data.trim():r.kind==="includes"?e.data.includes(r.value,r.position)||(i=this._getOrReturnCtx(e,i),ee(i,{code:j.invalid_string,validation:{includes:r.value,position:r.position},message:r.message}),s.dirty()):r.kind==="toLowerCase"?e.data=e.data.toLowerCase():r.kind==="toUpperCase"?e.data=e.data.toUpperCase():r.kind==="startsWith"?e.data.startsWith(r.value)||(i=this._getOrReturnCtx(e,i),ee(i,{code:j.invalid_string,validation:{startsWith:r.value},message:r.message}),s.dirty()):r.kind==="endsWith"?e.data.endsWith(r.value)||(i=this._getOrReturnCtx(e,i),ee(i,{code:j.invalid_string,validation:{endsWith:r.value},message:r.message}),s.dirty()):r.kind==="datetime"?P2(r).test(e.data)||(i=this._getOrReturnCtx(e,i),ee(i,{code:j.invalid_string,validation:"datetime",message:r.message}),s.dirty()):r.kind==="date"?R2.test(e.data)||(i=this._getOrReturnCtx(e,i),ee(i,{code:j.invalid_string,validation:"date",message:r.message}),s.dirty()):r.kind==="time"?I2(r).test(e.data)||(i=this._getOrReturnCtx(e,i),ee(i,{code:j.invalid_string,validation:"time",message:r.message}),s.dirty()):r.kind==="duration"?b2.test(e.data)||(i=this._getOrReturnCtx(e,i),ee(i,{validation:"duration",code:j.invalid_string,message:r.message}),s.dirty()):r.kind==="ip"?M2(e.data,r.version)||(i=this._getOrReturnCtx(e,i),ee(i,{validation:"ip",code:j.invalid_string,message:r.message}),s.dirty()):r.kind==="jwt"?O2(e.data,r.alg)||(i=this._getOrReturnCtx(e,i),ee(i,{validation:"jwt",code:j.invalid_string,message:r.message}),s.dirty()):r.kind==="cidr"?N2(e.data,r.version)||(i=this._getOrReturnCtx(e,i),ee(i,{validation:"cidr",code:j.invalid_string,message:r.message}),s.dirty()):r.kind==="base64"?E2.test(e.data)||(i=this._getOrReturnCtx(e,i),ee(i,{validation:"base64",code:j.invalid_string,message:r.message}),s.dirty()):r.kind==="base64url"?A2.test(e.data)||(i=this._getOrReturnCtx(e,i),ee(i,{validation:"base64url",code:j.invalid_string,message:r.message}),s.dirty()):Se.assertNever(r);return{status:s.value,value:e.data}}_regex(e,t,s){return this.refinement(i=>e.test(i),{validation:t,code:j.invalid_string,...re.errToObj(s)})}_addCheck(e){return new En({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...re.errToObj(e)})}url(e){return this._addCheck({kind:"url",...re.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...re.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...re.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...re.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...re.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...re.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...re.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...re.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...re.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...re.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...re.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...re.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...re.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...re.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...re.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...re.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...re.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...re.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...re.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...re.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...re.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...re.errToObj(t)})}nonempty(e){return this.min(1,re.errToObj(e))}trim(){return new En({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new En({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new En({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}En.create=n=>new En({checks:[],typeName:ue.ZodString,coerce:n?.coerce??!1,...ve(n)});function L2(n,e){const t=(n.toString().split(".")[1]||"").length,s=(e.toString().split(".")[1]||"").length,i=t>s?t:s,r=Number.parseInt(n.toFixed(i).replace(".","")),a=Number.parseInt(e.toFixed(i).replace(".",""));return r%a/10**i}class vs extends be{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==se.number){const r=this._getOrReturnCtx(e);return ee(r,{code:j.invalid_type,expected:se.number,received:r.parsedType}),he}let s;const i=new ut;for(const r of this._def.checks)r.kind==="int"?Se.isInteger(e.data)||(s=this._getOrReturnCtx(e,s),ee(s,{code:j.invalid_type,expected:"integer",received:"float",message:r.message}),i.dirty()):r.kind==="min"?(r.inclusive?e.data<r.value:e.data<=r.value)&&(s=this._getOrReturnCtx(e,s),ee(s,{code:j.too_small,minimum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),i.dirty()):r.kind==="max"?(r.inclusive?e.data>r.value:e.data>=r.value)&&(s=this._getOrReturnCtx(e,s),ee(s,{code:j.too_big,maximum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),i.dirty()):r.kind==="multipleOf"?L2(e.data,r.value)!==0&&(s=this._getOrReturnCtx(e,s),ee(s,{code:j.not_multiple_of,multipleOf:r.value,message:r.message}),i.dirty()):r.kind==="finite"?Number.isFinite(e.data)||(s=this._getOrReturnCtx(e,s),ee(s,{code:j.not_finite,message:r.message}),i.dirty()):Se.assertNever(r);return{status:i.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,re.toString(t))}gt(e,t){return this.setLimit("min",e,!1,re.toString(t))}lte(e,t){return this.setLimit("max",e,!0,re.toString(t))}lt(e,t){return this.setLimit("max",e,!1,re.toString(t))}setLimit(e,t,s,i){return new vs({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:s,message:re.toString(i)}]})}_addCheck(e){return new vs({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:re.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:re.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:re.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:re.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:re.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:re.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:re.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:re.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:re.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Se.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(t===null||s.value>t)&&(t=s.value):s.kind==="max"&&(e===null||s.value<e)&&(e=s.value)}return Number.isFinite(t)&&Number.isFinite(e)}}vs.create=n=>new vs({checks:[],typeName:ue.ZodNumber,coerce:n?.coerce||!1,...ve(n)});class ai extends be{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==se.bigint)return this._getInvalidInput(e);let s;const i=new ut;for(const r of this._def.checks)r.kind==="min"?(r.inclusive?e.data<r.value:e.data<=r.value)&&(s=this._getOrReturnCtx(e,s),ee(s,{code:j.too_small,type:"bigint",minimum:r.value,inclusive:r.inclusive,message:r.message}),i.dirty()):r.kind==="max"?(r.inclusive?e.data>r.value:e.data>=r.value)&&(s=this._getOrReturnCtx(e,s),ee(s,{code:j.too_big,type:"bigint",maximum:r.value,inclusive:r.inclusive,message:r.message}),i.dirty()):r.kind==="multipleOf"?e.data%r.value!==BigInt(0)&&(s=this._getOrReturnCtx(e,s),ee(s,{code:j.not_multiple_of,multipleOf:r.value,message:r.message}),i.dirty()):Se.assertNever(r);return{status:i.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return ee(t,{code:j.invalid_type,expected:se.bigint,received:t.parsedType}),he}gte(e,t){return this.setLimit("min",e,!0,re.toString(t))}gt(e,t){return this.setLimit("min",e,!1,re.toString(t))}lte(e,t){return this.setLimit("max",e,!0,re.toString(t))}lt(e,t){return this.setLimit("max",e,!1,re.toString(t))}setLimit(e,t,s,i){return new ai({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:s,message:re.toString(i)}]})}_addCheck(e){return new ai({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:re.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:re.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:re.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:re.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:re.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}ai.create=n=>new ai({checks:[],typeName:ue.ZodBigInt,coerce:n?.coerce??!1,...ve(n)});class Va extends be{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==se.boolean){const s=this._getOrReturnCtx(e);return ee(s,{code:j.invalid_type,expected:se.boolean,received:s.parsedType}),he}return yt(e.data)}}Va.create=n=>new Va({typeName:ue.ZodBoolean,coerce:n?.coerce||!1,...ve(n)});class cr extends be{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==se.date){const r=this._getOrReturnCtx(e);return ee(r,{code:j.invalid_type,expected:se.date,received:r.parsedType}),he}if(Number.isNaN(e.data.getTime())){const r=this._getOrReturnCtx(e);return ee(r,{code:j.invalid_date}),he}const s=new ut;let i;for(const r of this._def.checks)r.kind==="min"?e.data.getTime()<r.value&&(i=this._getOrReturnCtx(e,i),ee(i,{code:j.too_small,message:r.message,inclusive:!0,exact:!1,minimum:r.value,type:"date"}),s.dirty()):r.kind==="max"?e.data.getTime()>r.value&&(i=this._getOrReturnCtx(e,i),ee(i,{code:j.too_big,message:r.message,inclusive:!0,exact:!1,maximum:r.value,type:"date"}),s.dirty()):Se.assertNever(r);return{status:s.value,value:new Date(e.data.getTime())}}_addCheck(e){return new cr({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:re.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:re.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}cr.create=n=>new cr({checks:[],coerce:n?.coerce||!1,typeName:ue.ZodDate,...ve(n)});class Id extends be{_parse(e){if(this._getType(e)!==se.symbol){const s=this._getOrReturnCtx(e);return ee(s,{code:j.invalid_type,expected:se.symbol,received:s.parsedType}),he}return yt(e.data)}}Id.create=n=>new Id({typeName:ue.ZodSymbol,...ve(n)});class ja extends be{_parse(e){if(this._getType(e)!==se.undefined){const s=this._getOrReturnCtx(e);return ee(s,{code:j.invalid_type,expected:se.undefined,received:s.parsedType}),he}return yt(e.data)}}ja.create=n=>new ja({typeName:ue.ZodUndefined,...ve(n)});class za extends be{_parse(e){if(this._getType(e)!==se.null){const s=this._getOrReturnCtx(e);return ee(s,{code:j.invalid_type,expected:se.null,received:s.parsedType}),he}return yt(e.data)}}za.create=n=>new za({typeName:ue.ZodNull,...ve(n)});class Pd extends be{constructor(){super(...arguments),this._any=!0}_parse(e){return yt(e.data)}}Pd.create=n=>new Pd({typeName:ue.ZodAny,...ve(n)});class Ya extends be{constructor(){super(...arguments),this._unknown=!0}_parse(e){return yt(e.data)}}Ya.create=n=>new Ya({typeName:ue.ZodUnknown,...ve(n)});class An extends be{_parse(e){const t=this._getOrReturnCtx(e);return ee(t,{code:j.invalid_type,expected:se.never,received:t.parsedType}),he}}An.create=n=>new An({typeName:ue.ZodNever,...ve(n)});class Md extends be{_parse(e){if(this._getType(e)!==se.undefined){const s=this._getOrReturnCtx(e);return ee(s,{code:j.invalid_type,expected:se.void,received:s.parsedType}),he}return yt(e.data)}}Md.create=n=>new Md({typeName:ue.ZodVoid,...ve(n)});class Ft extends be{_parse(e){const{ctx:t,status:s}=this._processInputParams(e),i=this._def;if(t.parsedType!==se.array)return ee(t,{code:j.invalid_type,expected:se.array,received:t.parsedType}),he;if(i.exactLength!==null){const a=t.data.length>i.exactLength.value,o=t.data.length<i.exactLength.value;(a||o)&&(ee(t,{code:a?j.too_big:j.too_small,minimum:o?i.exactLength.value:void 0,maximum:a?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),s.dirty())}if(i.minLength!==null&&t.data.length<i.minLength.value&&(ee(t,{code:j.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),s.dirty()),i.maxLength!==null&&t.data.length>i.maxLength.value&&(ee(t,{code:j.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),s.dirty()),t.common.async)return Promise.all([...t.data].map((a,o)=>i.type._parseAsync(new Tn(t,a,t.path,o)))).then(a=>ut.mergeArray(s,a));const r=[...t.data].map((a,o)=>i.type._parseSync(new Tn(t,a,t.path,o)));return ut.mergeArray(s,r)}get element(){return this._def.type}min(e,t){return new Ft({...this._def,minLength:{value:e,message:re.toString(t)}})}max(e,t){return new Ft({...this._def,maxLength:{value:e,message:re.toString(t)}})}length(e,t){return new Ft({...this._def,exactLength:{value:e,message:re.toString(t)}})}nonempty(e){return this.min(1,e)}}Ft.create=(n,e)=>new Ft({type:n,minLength:null,maxLength:null,exactLength:null,typeName:ue.ZodArray,...ve(e)});function ys(n){if(n instanceof $e){const e={};for(const t in n.shape){const s=n.shape[t];e[t]=sn.create(ys(s))}return new $e({...n._def,shape:()=>e})}else return n instanceof Ft?new Ft({...n._def,type:ys(n.element)}):n instanceof sn?sn.create(ys(n.unwrap())):n instanceof Jn?Jn.create(ys(n.unwrap())):n instanceof Kn?Kn.create(n.items.map(e=>ys(e))):n}class $e extends be{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=Se.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==se.object){const c=this._getOrReturnCtx(e);return ee(c,{code:j.invalid_type,expected:se.object,received:c.parsedType}),he}const{status:s,ctx:i}=this._processInputParams(e),{shape:r,keys:a}=this._getCached(),o=[];if(!(this._def.catchall instanceof An&&this._def.unknownKeys==="strip"))for(const c in i.data)a.includes(c)||o.push(c);const l=[];for(const c of a){const d=r[c],h=i.data[c];l.push({key:{status:"valid",value:c},value:d._parse(new Tn(i,h,i.path,c)),alwaysSet:c in i.data})}if(this._def.catchall instanceof An){const c=this._def.unknownKeys;if(c==="passthrough")for(const d of o)l.push({key:{status:"valid",value:d},value:{status:"valid",value:i.data[d]}});else if(c==="strict")o.length>0&&(ee(i,{code:j.unrecognized_keys,keys:o}),s.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const d of o){const h=i.data[d];l.push({key:{status:"valid",value:d},value:c._parse(new Tn(i,h,i.path,d)),alwaysSet:d in i.data})}}return i.common.async?Promise.resolve().then(async()=>{const c=[];for(const d of l){const h=await d.key,u=await d.value;c.push({key:h,value:u,alwaysSet:d.alwaysSet})}return c}).then(c=>ut.mergeObjectSync(s,c)):ut.mergeObjectSync(s,l)}get shape(){return this._def.shape()}strict(e){return re.errToObj,new $e({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,s)=>{const i=this._def.errorMap?.(t,s).message??s.defaultError;return t.code==="unrecognized_keys"?{message:re.errToObj(e).message??i}:{message:i}}}:{}})}strip(){return new $e({...this._def,unknownKeys:"strip"})}passthrough(){return new $e({...this._def,unknownKeys:"passthrough"})}extend(e){return new $e({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new $e({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:ue.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new $e({...this._def,catchall:e})}pick(e){const t={};for(const s of Se.objectKeys(e))e[s]&&this.shape[s]&&(t[s]=this.shape[s]);return new $e({...this._def,shape:()=>t})}omit(e){const t={};for(const s of Se.objectKeys(this.shape))e[s]||(t[s]=this.shape[s]);return new $e({...this._def,shape:()=>t})}deepPartial(){return ys(this)}partial(e){const t={};for(const s of Se.objectKeys(this.shape)){const i=this.shape[s];e&&!e[s]?t[s]=i:t[s]=i.optional()}return new $e({...this._def,shape:()=>t})}required(e){const t={};for(const s of Se.objectKeys(this.shape))if(e&&!e[s])t[s]=this.shape[s];else{let r=this.shape[s];for(;r instanceof sn;)r=r._def.innerType;t[s]=r}return new $e({...this._def,shape:()=>t})}keyof(){return Nd(Se.objectKeys(this.shape))}}$e.create=(n,e)=>new $e({shape:()=>n,unknownKeys:"strip",catchall:An.create(),typeName:ue.ZodObject,...ve(e)}),$e.strictCreate=(n,e)=>new $e({shape:()=>n,unknownKeys:"strict",catchall:An.create(),typeName:ue.ZodObject,...ve(e)}),$e.lazycreate=(n,e)=>new $e({shape:n,unknownKeys:"strip",catchall:An.create(),typeName:ue.ZodObject,...ve(e)});class dr extends be{_parse(e){const{ctx:t}=this._processInputParams(e),s=this._def.options;function i(r){for(const o of r)if(o.result.status==="valid")return o.result;for(const o of r)if(o.result.status==="dirty")return t.common.issues.push(...o.ctx.common.issues),o.result;const a=r.map(o=>new tn(o.ctx.common.issues));return ee(t,{code:j.invalid_union,unionErrors:a}),he}if(t.common.async)return Promise.all(s.map(async r=>{const a={...t,common:{...t.common,issues:[]},parent:null};return{result:await r._parseAsync({data:t.data,path:t.path,parent:a}),ctx:a}})).then(i);{let r;const a=[];for(const l of s){const c={...t,common:{...t.common,issues:[]},parent:null},d=l._parseSync({data:t.data,path:t.path,parent:c});if(d.status==="valid")return d;d.status==="dirty"&&!r&&(r={result:d,ctx:c}),c.common.issues.length&&a.push(c.common.issues)}if(r)return t.common.issues.push(...r.ctx.common.issues),r.result;const o=a.map(l=>new tn(l));return ee(t,{code:j.invalid_union,unionErrors:o}),he}}get options(){return this._def.options}}dr.create=(n,e)=>new dr({options:n,typeName:ue.ZodUnion,...ve(e)});const nn=n=>n instanceof Za?nn(n.schema):n instanceof qn?nn(n.innerType()):n instanceof ur?[n.value]:n instanceof Zn?n.options:n instanceof qa?Se.objectValues(n.enum):n instanceof pr?nn(n._def.innerType):n instanceof ja?[void 0]:n instanceof za?[null]:n instanceof sn?[void 0,...nn(n.unwrap())]:n instanceof Jn?[null,...nn(n.unwrap())]:n instanceof Dd||n instanceof mr?nn(n.unwrap()):n instanceof gr?nn(n._def.innerType):[];class Xa extends be{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==se.object)return ee(t,{code:j.invalid_type,expected:se.object,received:t.parsedType}),he;const s=this.discriminator,i=t.data[s],r=this.optionsMap.get(i);return r?t.common.async?r._parseAsync({data:t.data,path:t.path,parent:t}):r._parseSync({data:t.data,path:t.path,parent:t}):(ee(t,{code:j.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[s]}),he)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,s){const i=new Map;for(const r of t){const a=nn(r.shape[e]);if(!a.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const o of a){if(i.has(o))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(o)}`);i.set(o,r)}}return new Xa({typeName:ue.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:i,...ve(s)})}}function Ka(n,e){const t=Cn(n),s=Cn(e);if(n===e)return{valid:!0,data:n};if(t===se.object&&s===se.object){const i=Se.objectKeys(e),r=Se.objectKeys(n).filter(o=>i.indexOf(o)!==-1),a={...n,...e};for(const o of r){const l=Ka(n[o],e[o]);if(!l.valid)return{valid:!1};a[o]=l.data}return{valid:!0,data:a}}else if(t===se.array&&s===se.array){if(n.length!==e.length)return{valid:!1};const i=[];for(let r=0;r<n.length;r++){const a=n[r],o=e[r],l=Ka(a,o);if(!l.valid)return{valid:!1};i.push(l.data)}return{valid:!0,data:i}}else return t===se.date&&s===se.date&&+n==+e?{valid:!0,data:n}:{valid:!1}}class hr extends be{_parse(e){const{status:t,ctx:s}=this._processInputParams(e),i=(r,a)=>{if(Cd(r)||Cd(a))return he;const o=Ka(r.value,a.value);return o.valid?((Td(r)||Td(a))&&t.dirty(),{status:t.value,value:o.data}):(ee(s,{code:j.invalid_intersection_types}),he)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([r,a])=>i(r,a)):i(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}}hr.create=(n,e,t)=>new hr({left:n,right:e,typeName:ue.ZodIntersection,...ve(t)});class Kn extends be{_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==se.array)return ee(s,{code:j.invalid_type,expected:se.array,received:s.parsedType}),he;if(s.data.length<this._def.items.length)return ee(s,{code:j.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),he;!this._def.rest&&s.data.length>this._def.items.length&&(ee(s,{code:j.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const r=[...s.data].map((a,o)=>{const l=this._def.items[o]||this._def.rest;return l?l._parse(new Tn(s,a,s.path,o)):null}).filter(a=>!!a);return s.common.async?Promise.all(r).then(a=>ut.mergeArray(t,a)):ut.mergeArray(t,r)}get items(){return this._def.items}rest(e){return new Kn({...this._def,rest:e})}}Kn.create=(n,e)=>{if(!Array.isArray(n))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Kn({items:n,typeName:ue.ZodTuple,rest:null,...ve(e)})};class Od extends be{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==se.map)return ee(s,{code:j.invalid_type,expected:se.map,received:s.parsedType}),he;const i=this._def.keyType,r=this._def.valueType,a=[...s.data.entries()].map(([o,l],c)=>({key:i._parse(new Tn(s,o,s.path,[c,"key"])),value:r._parse(new Tn(s,l,s.path,[c,"value"]))}));if(s.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const l of a){const c=await l.key,d=await l.value;if(c.status==="aborted"||d.status==="aborted")return he;(c.status==="dirty"||d.status==="dirty")&&t.dirty(),o.set(c.value,d.value)}return{status:t.value,value:o}})}else{const o=new Map;for(const l of a){const c=l.key,d=l.value;if(c.status==="aborted"||d.status==="aborted")return he;(c.status==="dirty"||d.status==="dirty")&&t.dirty(),o.set(c.value,d.value)}return{status:t.value,value:o}}}}Od.create=(n,e,t)=>new Od({valueType:e,keyType:n,typeName:ue.ZodMap,...ve(t)});class oi extends be{_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==se.set)return ee(s,{code:j.invalid_type,expected:se.set,received:s.parsedType}),he;const i=this._def;i.minSize!==null&&s.data.size<i.minSize.value&&(ee(s,{code:j.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),t.dirty()),i.maxSize!==null&&s.data.size>i.maxSize.value&&(ee(s,{code:j.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),t.dirty());const r=this._def.valueType;function a(l){const c=new Set;for(const d of l){if(d.status==="aborted")return he;d.status==="dirty"&&t.dirty(),c.add(d.value)}return{status:t.value,value:c}}const o=[...s.data.values()].map((l,c)=>r._parse(new Tn(s,l,s.path,c)));return s.common.async?Promise.all(o).then(l=>a(l)):a(o)}min(e,t){return new oi({...this._def,minSize:{value:e,message:re.toString(t)}})}max(e,t){return new oi({...this._def,maxSize:{value:e,message:re.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}oi.create=(n,e)=>new oi({valueType:n,minSize:null,maxSize:null,typeName:ue.ZodSet,...ve(e)});class Za extends be{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}Za.create=(n,e)=>new Za({getter:n,typeName:ue.ZodLazy,...ve(e)});class ur extends be{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return ee(t,{received:t.data,code:j.invalid_literal,expected:this._def.value}),he}return{status:"valid",value:e.data}}get value(){return this._def.value}}ur.create=(n,e)=>new ur({value:n,typeName:ue.ZodLiteral,...ve(e)});function Nd(n,e){return new Zn({values:n,typeName:ue.ZodEnum,...ve(e)})}class Zn extends be{_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),s=this._def.values;return ee(t,{expected:Se.joinValues(s),received:t.parsedType,code:j.invalid_type}),he}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const t=this._getOrReturnCtx(e),s=this._def.values;return ee(t,{received:t.data,code:j.invalid_enum_value,options:s}),he}return yt(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return Zn.create(e,{...this._def,...t})}exclude(e,t=this._def){return Zn.create(this.options.filter(s=>!e.includes(s)),{...this._def,...t})}}Zn.create=Nd;class qa extends be{_parse(e){const t=Se.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(e);if(s.parsedType!==se.string&&s.parsedType!==se.number){const i=Se.objectValues(t);return ee(s,{expected:Se.joinValues(i),received:s.parsedType,code:j.invalid_type}),he}if(this._cache||(this._cache=new Set(Se.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const i=Se.objectValues(t);return ee(s,{received:s.data,code:j.invalid_enum_value,options:i}),he}return yt(e.data)}get enum(){return this._def.values}}qa.create=(n,e)=>new qa({values:n,typeName:ue.ZodNativeEnum,...ve(e)});class fr extends be{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==se.promise&&t.common.async===!1)return ee(t,{code:j.invalid_type,expected:se.promise,received:t.parsedType}),he;const s=t.parsedType===se.promise?t.data:Promise.resolve(t.data);return yt(s.then(i=>this._def.type.parseAsync(i,{path:t.path,errorMap:t.common.contextualErrorMap})))}}fr.create=(n,e)=>new fr({type:n,typeName:ue.ZodPromise,...ve(e)});class qn extends be{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ue.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:s}=this._processInputParams(e),i=this._def.effect||null,r={addIssue:a=>{ee(s,a),a.fatal?t.abort():t.dirty()},get path(){return s.path}};if(r.addIssue=r.addIssue.bind(r),i.type==="preprocess"){const a=i.transform(s.data,r);if(s.common.async)return Promise.resolve(a).then(async o=>{if(t.value==="aborted")return he;const l=await this._def.schema._parseAsync({data:o,path:s.path,parent:s});return l.status==="aborted"?he:l.status==="dirty"||t.value==="dirty"?ri(l.value):l});{if(t.value==="aborted")return he;const o=this._def.schema._parseSync({data:a,path:s.path,parent:s});return o.status==="aborted"?he:o.status==="dirty"||t.value==="dirty"?ri(o.value):o}}if(i.type==="refinement"){const a=o=>{const l=i.refinement(o,r);if(s.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(s.common.async===!1){const o=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return o.status==="aborted"?he:(o.status==="dirty"&&t.dirty(),a(o.value),{status:t.value,value:o.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(o=>o.status==="aborted"?he:(o.status==="dirty"&&t.dirty(),a(o.value).then(()=>({status:t.value,value:o.value}))))}if(i.type==="transform")if(s.common.async===!1){const a=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!_s(a))return he;const o=i.transform(a.value,r);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:o}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(a=>_s(a)?Promise.resolve(i.transform(a.value,r)).then(o=>({status:t.value,value:o})):he);Se.assertNever(i)}}qn.create=(n,e,t)=>new qn({schema:n,typeName:ue.ZodEffects,effect:e,...ve(t)}),qn.createWithPreprocess=(n,e,t)=>new qn({schema:e,effect:{type:"preprocess",transform:n},typeName:ue.ZodEffects,...ve(t)});class sn extends be{_parse(e){return this._getType(e)===se.undefined?yt(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}sn.create=(n,e)=>new sn({innerType:n,typeName:ue.ZodOptional,...ve(e)});class Jn extends be{_parse(e){return this._getType(e)===se.null?yt(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Jn.create=(n,e)=>new Jn({innerType:n,typeName:ue.ZodNullable,...ve(e)});class pr extends be{_parse(e){const{ctx:t}=this._processInputParams(e);let s=t.data;return t.parsedType===se.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}pr.create=(n,e)=>new pr({innerType:n,typeName:ue.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...ve(e)});class gr extends be{_parse(e){const{ctx:t}=this._processInputParams(e),s={...t,common:{...t.common,issues:[]}},i=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return lr(i)?i.then(r=>({status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new tn(s.common.issues)},input:s.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new tn(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}}gr.create=(n,e)=>new gr({innerType:n,typeName:ue.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...ve(e)});class Ld extends be{_parse(e){if(this._getType(e)!==se.nan){const s=this._getOrReturnCtx(e);return ee(s,{code:j.invalid_type,expected:se.nan,received:s.parsedType}),he}return{status:"valid",value:e.data}}}Ld.create=n=>new Ld({typeName:ue.ZodNaN,...ve(n)});class Dd extends be{_parse(e){const{ctx:t}=this._processInputParams(e),s=t.data;return this._def.type._parse({data:s,path:t.path,parent:t})}unwrap(){return this._def.type}}class Ja extends be{_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.common.async)return(async()=>{const r=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return r.status==="aborted"?he:r.status==="dirty"?(t.dirty(),ri(r.value)):this._def.out._parseAsync({data:r.value,path:s.path,parent:s})})();{const i=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return i.status==="aborted"?he:i.status==="dirty"?(t.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:s.path,parent:s})}}static create(e,t){return new Ja({in:e,out:t,typeName:ue.ZodPipeline})}}class mr extends be{_parse(e){const t=this._def.innerType._parse(e),s=i=>(_s(i)&&(i.value=Object.freeze(i.value)),i);return lr(t)?t.then(i=>s(i)):s(t)}unwrap(){return this._def.innerType}}mr.create=(n,e)=>new mr({innerType:n,typeName:ue.ZodReadonly,...ve(e)});var ue;(function(n){n.ZodString="ZodString",n.ZodNumber="ZodNumber",n.ZodNaN="ZodNaN",n.ZodBigInt="ZodBigInt",n.ZodBoolean="ZodBoolean",n.ZodDate="ZodDate",n.ZodSymbol="ZodSymbol",n.ZodUndefined="ZodUndefined",n.ZodNull="ZodNull",n.ZodAny="ZodAny",n.ZodUnknown="ZodUnknown",n.ZodNever="ZodNever",n.ZodVoid="ZodVoid",n.ZodArray="ZodArray",n.ZodObject="ZodObject",n.ZodUnion="ZodUnion",n.ZodDiscriminatedUnion="ZodDiscriminatedUnion",n.ZodIntersection="ZodIntersection",n.ZodTuple="ZodTuple",n.ZodRecord="ZodRecord",n.ZodMap="ZodMap",n.ZodSet="ZodSet",n.ZodFunction="ZodFunction",n.ZodLazy="ZodLazy",n.ZodLiteral="ZodLiteral",n.ZodEnum="ZodEnum",n.ZodEffects="ZodEffects",n.ZodNativeEnum="ZodNativeEnum",n.ZodOptional="ZodOptional",n.ZodNullable="ZodNullable",n.ZodDefault="ZodDefault",n.ZodCatch="ZodCatch",n.ZodPromise="ZodPromise",n.ZodBranded="ZodBranded",n.ZodPipeline="ZodPipeline",n.ZodReadonly="ZodReadonly"})(ue||(ue={}));const bt=En.create,ze=vs.create,D2=Va.create,G2=Ya.create;An.create;const Rn=Ft.create,it=$e.create,F2=dr.create,Gd=Xa.create;hr.create,Kn.create;const rn=ur.create,Qa=Zn.create;fr.create,sn.create,Jn.create;const B2=it({funcName:bt(),args:Rn(G2())}),H2=it({id:bt(),time:ze(),value:ze()}),$2=it({id:bt(),time:ze(),value:bt()}),W2=it({id:bt(),time:ze(),value:B2}),eo=it({id:bt(),name:bt(),fieldType:Qa(["number","enum","func"]),elementData:Rn(F2([H2,$2,W2])),low:ze(),high:ze()}),U2=it({type:rn("setTracks"),tracks:Rn(eo),trackOrder:Rn(bt())}),V2=it({type:rn("scrubToTime"),time:ze().nonnegative()}),j2=it({type:rn("setLivePlayhead"),position:ze().nonnegative()}),z2=it({type:rn("setConfig"),width:ze().positive().optional(),height:ze().positive().optional(),interactive:D2().optional(),duration:ze().positive().optional()}),Y2=it({type:rn("getState"),requestId:bt().optional()}),X2=Gd("type",[U2,V2,j2,z2,Y2]),K2=it({type:rn("tracksUpdate"),tracks:Rn(eo),trackOrder:Rn(bt()),source:Qa(["tracks","time","window","other"]).optional()}),Z2=it({type:rn("stateUpdate"),currentTime:ze(),duration:ze(),windowStart:ze(),windowEnd:ze(),source:Qa(["tracks","time","window","other"]).optional()}),q2=it({type:rn("stateResponse"),currentTime:ze(),duration:ze(),windowStart:ze(),windowEnd:ze(),tracks:Rn(eo),trackOrder:Rn(bt()),requestId:bt().optional()}),J2=it({type:rn("connectionReady")}),Q2=Gd("type",[K2,Z2,q2,J2]);class em{ws=null;reconnectAttempts=0;maxReconnectAttempts=5;reconnectDelay=1e3;reconnectTimer=null;address;handlers={};constructor(e){this.address=e}setHandlers(e){this.handlers=e}connect(){if(this.ws?.readyState!==WebSocket.OPEN)try{this.ws=new WebSocket(this.address),this.ws.onopen=()=>{this.reconnectAttempts=0,this.send({type:"connectionReady"})},this.ws.onmessage=e=>{this.handleMessage(e.data)},this.ws.onclose=()=>{this.scheduleReconnect()},this.ws.onerror=()=>{}}catch{this.scheduleReconnect()}}scheduleReconnect(){this.reconnectAttempts>=this.maxReconnectAttempts||(this.reconnectTimer&&clearTimeout(this.reconnectTimer),this.reconnectTimer=setTimeout(()=>{this.reconnectAttempts++,this.connect()},this.reconnectDelay*Math.pow(2,this.reconnectAttempts)))}handleMessage(e){let t;try{t=JSON.parse(e)}catch{console.warn("[AnimationEditorWS] Invalid JSON received:",e);return}const s=X2.safeParse(t);if(!s.success){console.warn("[AnimationEditorWS] Invalid message format:",s.error.format());return}const i=s.data;switch(i.type){case"setTracks":this.handlers.onSetTracks?.(i.tracks,i.trackOrder);break;case"scrubToTime":this.handlers.onScrubToTime?.(i.time);break;case"setLivePlayhead":this.handlers.onSetLivePlayhead?.(i.position);break;case"setConfig":this.handlers.onSetConfig?.({width:i.width,height:i.height,interactive:i.interactive,duration:i.duration});break;case"getState":this.handlers.onGetState?.(i.requestId);break}}send(e){if(this.ws?.readyState!==WebSocket.OPEN)return;const t=Q2.safeParse(e);if(!t.success){console.warn("[AnimationEditorWS] Invalid outgoing message:",t.error.format());return}this.ws.send(JSON.stringify(e))}sendTracksUpdate(e,t,s){this.send({type:"tracksUpdate",tracks:e,trackOrder:t,source:s})}sendStateUpdate(e,t,s,i,r){this.send({type:"stateUpdate",currentTime:e,duration:t,windowStart:s,windowEnd:i,source:r})}sendStateResponse(e,t,s,i,r,a,o){this.send({type:"stateResponse",currentTime:e,duration:t,windowStart:s,windowEnd:i,tracks:r,trackOrder:a,requestId:o})}disconnect(){this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),this.ws&&(this.ws.onclose=null,this.ws.close(),this.ws=null)}get isConnected(){return this.ws?.readyState===WebSocket.OPEN}}function Fd(n,e){const t=[];for(const s of e){const i=n.get(s);i&&t.push({id:i.id,name:i.def.name,fieldType:i.def.fieldType,elementData:i.elementData.map(r=>{if(i.def.fieldType==="number"){const a=r;return{id:a.id,time:a.time,value:a.value}}else if(i.def.fieldType==="enum"){const a=r;return{id:a.id,time:a.time,value:a.value}}else{const a=r;return{id:a.id,time:a.time,value:a.value}}}),low:i.low,high:i.high})}return{tracks:t,trackOrder:e}}const tm={class:"animation-editor"},nm={class:"mode-header"},sm={class:"mode-label"},im={class:"search-row"},rm={class:"name-column-header"},am=lt(st({__name:"AnimationEditorView",props:{duration:{type:Number},wsAddress:{type:String},interactive:{type:Boolean,default:!0}},setup(n,{expose:e}){Dt(w=>({v0c5ebf26:_e($n)+"px"}));const t=n,s=bi({interactive:void 0,duration:void 0});Pe(()=>s.interactive??t.interactive);const i=xh(null),r=new f0(t.duration),a=new p0;r.setInvalidateCallback(()=>a.invalidate());const o=me("view"),l=me(0),c=me([]),d=me(new Set),h=me(0),u=me(r.duration),f=me(0),p=me("");let m=null;const v=me(null),S=me(0);un("core",r),un("scheduler",a),un("windowStart",h),un("windowEnd",u),un("searchFilter",p),un("selectedTrackIdsForEdit",d);function k(w){d.value.has(w)?d.value.delete(w):d.value.add(w),d.value=new Set(d.value)}un("toggleTrackSelection",k);const b=Pe(()=>{const w=p.value.toLowerCase().trim();return w?c.value.filter(R=>{const P=r.getTrackById(R);return P&&P.def.name.toLowerCase().includes(w)}):c.value}),_=Pe(()=>o.value==="view"?$n:fc);function C(w,R){for(const P of[...r.orderedTrackIds])r.deleteTrack(P);for(const P of R){const M=w.find(G=>G.id===P);if(!M)continue;const D={name:M.name,fieldType:M.fieldType,data:M.elementData.map(G=>{if(M.fieldType==="number"){const J=G;return{time:J.time,element:J.value}}else if(M.fieldType==="enum"){const J=G;return{time:J.time,element:J.value}}else{const J=G;return{time:J.time,element:J.value}}}),low:M.low,high:M.high};r.addTrack(D)}c.value=[...r.orderedTrackIds],u.value=r.duration,a.invalidate()}function A(w){if(!i.value?.isConnected)return;const{tracks:R,trackOrder:P}=Fd(r.tracksById,r.orderedTrackIds);i.value.sendTracksUpdate(R,P,w)}Pt(()=>{const w=()=>{v.value&&(S.value=v.value.clientWidth-$n)};w(),m=new ResizeObserver(w),v.value&&m.observe(v.value),a.invalidate(),t.wsAddress&&(i.value=new em(t.wsAddress),i.value.setHandlers({onSetTracks:(R,P)=>{C(R,P)},onScrubToTime:R=>{W(R)},onSetLivePlayhead:R=>{f.value=R,a.invalidate()},onSetConfig:R=>{R.interactive!==void 0&&(s.interactive=R.interactive),R.duration!==void 0&&(s.duration=R.duration)},onGetState:R=>{const{tracks:P,trackOrder:M}=Fd(r.tracksById,r.orderedTrackIds);i.value?.sendStateResponse(l.value,r.duration,h.value,u.value,P,M,R)}}),i.value.connect())}),Xt(()=>{i.value?.disconnect(),m?.disconnect(),m=null});function L(){o.value=o.value==="view"?"edit":"view",o.value==="view"&&(c.value=[...r.orderedTrackIds],a.invalidate())}function O(){a.invalidate()}function I(w,R){const P=r.addTrack(w);return P&&(c.value=[...r.orderedTrackIds],u.value=r.duration,R?.suppressWsUpdate||A("tracks")),P}function W(w){r.scrubToTime(w),l.value=w}function K(w){r.jumpToTime(w),l.value=w}function g(w,R){h.value=w,u.value=R,a.invalidate()}return e({addTrack:I,scrubToTime:W,jumpToTime:K,setWindowRange:g,core:r,mode:o}),(w,R)=>(le(),ge("div",tm,[U("div",nm,[U("button",{class:"mode-toggle",onClick:L},St(o.value==="view"?"Switch to Edit Mode":"Switch to View Mode"),1),U("span",sm,St(o.value==="view"?"View Mode":"Edit Mode"),1)]),We(w0,{duration:_e(r).duration,"window-start":h.value,"onUpdate:windowStart":[R[0]||(R[0]=P=>h.value=P),O],"window-end":u.value,"onUpdate:windowEnd":[R[1]||(R[1]=P=>u.value=P),O],"spacer-width":_.value},null,8,["duration","window-start","window-end","spacer-width"]),o.value==="view"?(le(),ge("div",{key:0,class:"track-list-container",ref_key:"trackListRef",ref:v},[U("div",im,[U("div",rm,[Lh(U("input",{"onUpdate:modelValue":R[2]||(R[2]=P=>p.value=P),type:"text",placeholder:"Search tracks...",class:"search-input"},null,512),[[yf,p.value]])])]),We(P0,{"track-ids":b.value},null,8,["track-ids"]),We(yc,{"current-time":l.value,"window-start":h.value,"window-end":u.value,"canvas-width":S.value,"left-offset":_e($n)},null,8,["current-time","window-start","window-end","canvas-width","left-offset"])],512)):(le(),fn(o2,{key:1,core:_e(r),"window-start":h.value,"window-end":u.value,"current-time":l.value,"initial-enabled-track-ids":d.value},null,8,["core","window-start","window-end","current-time","initial-enabled-track-ids"])),We(d2)]))}}),[["styles",[".animation-editor[data-v-cccf3cde]{display:flex;flex-direction:column;background:#121416;color:#c8c8c8;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,system-ui,sans-serif;height:100%;overflow:hidden}.mode-header[data-v-cccf3cde]{display:flex;align-items:center;gap:16px;padding:8px 16px;background:#0e1012;border-bottom:1px solid #2a2d30}.mode-toggle[data-v-cccf3cde]{padding:6px 14px;background:#3a7ca5;border:none;border-radius:4px;color:#fff;font-size:12px;font-weight:500;cursor:pointer;transition:background .15s ease}.mode-toggle[data-v-cccf3cde]:hover{background:#4a8cb5}.mode-label[data-v-cccf3cde]{font-size:11px;color:#666;text-transform:uppercase;letter-spacing:1px;font-weight:500}.search-row[data-v-cccf3cde]{display:flex;position:sticky;top:0;z-index:5;background:#141618}.name-column-header[data-v-cccf3cde]{width:var(--v0c5ebf26);min-width:var(--v0c5ebf26);padding:6px 8px;box-sizing:border-box;background:#141618;border-bottom:1px solid #2a2d30}.search-input[data-v-cccf3cde]{width:100%;padding:6px 10px;background:#1a1c20;border:1px solid #2a2d30;border-radius:4px;color:#c8c8c8;font-size:12px;transition:border-color .15s ease}.search-input[data-v-cccf3cde]:focus{outline:none;border-color:#3a7ca5}.search-input[data-v-cccf3cde]::placeholder{color:#555}.track-list-container[data-v-cccf3cde]{flex:1;position:relative;overflow-y:auto;overflow-x:hidden}"]],["__scopeId","data-v-cccf3cde"]]),Bd="animation-editor-component",Hd=hf(am);return customElements.get(Bd)||customElements.define(Bd,Hd),vr.AnimationEditorElement=Hd,Object.defineProperty(vr,Symbol.toStringTag,{value:"Module"}),vr})({});
